(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     10555,        330]
NotebookOptionsPosition[      8919,        266]
NotebookOutlinePosition[      9484,        290]
CellTagsIndexPosition[      9400,        285]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["export.nb", "Section",
 CellChangeTimes->{{3.62600628385137*^9, 3.626006284835745*^9}, {
  3.6260709487170696`*^9, 3.6260709533480415`*^9}, {3.6300570761850166`*^9, 
  3.6300570771047897`*^9}}],

Cell[CellGroupData[{

Cell["For the Developer", "Subsubsection",
 CellChangeTimes->{{3.5819225877880845`*^9, 3.581922592443351*^9}}],

Cell["\<\
AutoGeneratedPackage is an option for notebooks that specifies whether a \
package is automatically created when a notebook that contains initialization \
cells or groups is saved.\
\>", "Text",
 CellChangeTimes->{{3.5808982533077106`*^9, 3.580898259632072*^9}}],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816697178146343`*^9, 3.581669717815634*^9}}],

Cell[BoxData[
 RowBox[{"ClearSystemCache", "[", "]"}]], "Input",
 CellChangeTimes->{{3.581669726757145*^9, 3.5816697379287844`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "General export functions : The goal is to eventually substitute ",
 StyleBox["Mathematica\[CloseCurlyQuote]s Export function",
  FontSlant->"Italic"]
}], "Subsection",
 CellChangeTimes->{{3.626595458713975*^9, 3.626595540197707*^9}, {
  3.630058466024449*^9, 3.630058477711949*^9}, {3.63923518058504*^9, 
  3.63923518308504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "10", "x", " ", "times", " ", "faster", " ", "than", " ", "Export"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "writeYourTSV", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"writeYourTSV", "[", 
     RowBox[{"file_String", ",", 
      RowBox[{"list_List", "?", "MatrixQ"}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"OpenWrite", "[", 
          RowBox[{"file", ",", 
           RowBox[{"PageWidth", "\[Rule]", "Infinity"}]}], "]"}]}], ",", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Write", "[", 
           RowBox[{"str", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"(*", 
                    RowBox[{"FortranForm", "["}], "*)"}], 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], 
                    RowBox[{"(*", "]", "*)"}], ",", 
                    RowBox[{"OutputForm", "[", "\"\<\\t\>\"", "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"len", "-", "1"}]}], "}"}]}], "]"}], "]"}], ")"}],
               "~", "Join", "~", 
              RowBox[{"{", 
               RowBox[{"(*", 
                RowBox[{"FortranForm", "["}], "*)"}], 
               RowBox[{"#", "[", 
                RowBox[{"[", "len", "]"}], "]"}], 
               RowBox[{"(*", "]", "*)"}], "}"}]}]}]}], "]"}], "&"}], ",", 
         "list"}], "]"}], ";", 
       RowBox[{"Close", "[", "str", "]"}], ";"}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "150211", " ", "removed", " ", "FortranForm", " ", "because", " ", "it", 
     " ", "induced", " ", 
     RowBox[{"e", "'"}], "s"}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
    "150219", " ", "re", " ", "enabled", " ", "the", " ", "fortran", " ", 
     RowBox[{"form", " ", "--"}], " ", "Importing", " ", "seems", " ", "to", 
     " ", "work", " ", "just", " ", "fine"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "150211", " ", "removed", " ", "FortranForm", " ", "because", " ", "it", 
     " ", "induced", " ", 
     RowBox[{"e", "'"}], 
     RowBox[{"s", "  ", "--"}], " ", "appeared", " ", "on", " ", "the", " ", 
     "remove", " ", "project"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626776422151128*^9, 3.626776443593723*^9}, {
   3.6267766237415223`*^9, 3.6267766339234467`*^9}, {3.6326452120503063`*^9, 
   3.6326452249721813`*^9}, {3.632645478981947*^9, 3.632645516450697*^9}, {
   3.633365051951558*^9, 3.6333650590411134`*^9}, {3.633365239602645*^9, 
   3.633365278016708*^9}, 3.639231794225665*^9, {3.63923186105379*^9, 
   3.63923188952254*^9}, {3.639278936331465*^9, 3.639278954076582*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "FortranForm"}]], "Input",
 CellChangeTimes->{{3.63923184296004*^9, 3.639231845444415*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\\!\\(\\*RowBox[{\\\"FortranForm\\\", \\\"[\\\", \
StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\"]\\\"}]\\) prints as a Fortran \
language version of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\). \"\>", 
   "MSG"], "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/FortranForm"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.639231847788165*^9},
 CellTags->"Info3639242647-3002920"]
}, Open  ]],

Cell[CellGroupData[{

Cell["test", "Subsubsection",
 CellChangeTimes->{{3.6333646197249327`*^9, 3.6333646225628233`*^9}, {
  3.6572989845423527`*^9, 3.657298985022784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "]"}], ",", 
     RowBox[{"{", "2000000", "}"}], ",", 
     RowBox[{"{", "10", "}"}]}], "]"}]}], ";", 
  RowBox[{"ByteCount", "[", "t", "]"}]}]], "Input",
 CellChangeTimes->{{3.630062613137579*^9, 3.630062675840704*^9}, 
   3.633364648996245*^9, 3.6333652147314014`*^9, 3.6333674584907904`*^9, {
   3.6333675259946704`*^9, 3.6333675263862715`*^9}}],

Cell[BoxData["160000104"], "Output",
 CellChangeTimes->{3.6333675290249434`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<c:/tmp/writeYourTSV2_fast.mx\>\"", ",", "t", ",", "\"\<MX\>\""}], 
   "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.6333668256677895`*^9, 3.633366843998844*^9}, {
  3.633366892325992*^9, 3.6333669029268074`*^9}, {3.633367015409546*^9, 
  3.6333670173014274`*^9}, {3.6333672432467794`*^9, 3.6333673214574366`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.84375`5.946813699118706", ",", "\<\"c:/tmp/writeYourTSV2_fast.mx\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.633366904074053*^9, 3.6333670189911714`*^9, {3.633367248285842*^9, 
   3.633367270421584*^9}, {3.6333673121215496`*^9, 3.633367322284051*^9}, 
   3.6333674221934834`*^9, 3.6333675373862715`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", 
    RowBox[{"Import", "[", "\"\<c:/tmp/writeYourTSV2_fast.mx\>\"", "]"}]}], 
   ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.633364412419531*^9, 3.633364426133398*^9}, {
   3.633364684863043*^9, 3.6333647123610897`*^9}, {3.6333670424858437`*^9, 
   3.6333670560744896`*^9}, 3.633367333961542*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1865234000000000059`5.291333236573877", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.633367060189724*^9, 3.633367176537822*^9, {3.633367251424514*^9, 
   3.6333672728161154`*^9}, 3.633367335746016*^9, 3.633367431749148*^9, 
   3.6333675392720137`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", "\[Equal]", "t"}]], "Input",
 CellChangeTimes->{{3.6333673374065847`*^9, 3.6333673385541472`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6333673392604876`*^9, 3.6333674367276635`*^9, 
  3.6333675417251387`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MaxMemoryUsed", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6333673918946557`*^9, 3.6333673954249287`*^9}}],

Cell[BoxData["341751388"], "Output",
 CellChangeTimes->{3.63336755134135*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1184, 880},
WindowMargins->{{542, Automatic}, {41, Automatic}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3639242647-3002920"->{
  Cell[5536, 157, 512, 12, 54, "Print",
   CellTags->"Info3639242647-3002920"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3639242647-3002920", 9296, 279}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 199, 3, 83, "Section"],
Cell[CellGroupData[{
Cell[803, 29, 110, 1, 46, "Subsubsection"],
Cell[916, 32, 272, 5, 67, "Text"],
Cell[1191, 39, 179, 4, 38, "Input"],
Cell[1373, 45, 148, 3, 38, "Input"],
Cell[1524, 50, 132, 2, 38, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1693, 57, 347, 7, 93, "Subsection"],
Cell[2043, 66, 3346, 83, 359, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[5414, 153, 119, 2, 38, "Input"],
Cell[5536, 157, 512, 12, 54, "Print",
 CellTags->"Info3639242647-3002920"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6085, 174, 150, 2, 46, "Subsubsection"],
Cell[CellGroupData[{
Cell[6260, 180, 464, 11, 38, "Input"],
Cell[6727, 193, 80, 1, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6844, 199, 402, 8, 38, "Input"],
Cell[7249, 209, 357, 8, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7643, 222, 373, 8, 38, "Input"],
Cell[8019, 232, 308, 7, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8364, 244, 126, 2, 38, "Input"],
Cell[8493, 248, 126, 2, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8656, 255, 131, 2, 38, "Input"],
Cell[8790, 259, 77, 1, 38, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
