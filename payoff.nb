(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     48342,       1217]
NotebookOptionsPosition[     40363,       1052]
NotebookOutlinePosition[     42044,       1096]
CellTagsIndexPosition[     41739,       1086]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["payoff.nb", "Section",
 CellChangeTimes->{{3.62600628385137*^9, 3.626006284835745*^9}, {
  3.6260709487170696`*^9, 3.6260709533480415`*^9}, {3.626096953477417*^9, 
  3.6260969551364455`*^9}}],

Cell[CellGroupData[{

Cell["For the Developer", "Subsubsection",
 CellChangeTimes->{{3.5819225877880845`*^9, 3.581922592443351*^9}}],

Cell["\<\
AutoGeneratedPackage is an option for notebooks that specifies whether a \
package is automatically created when a notebook that contains initialization \
cells or groups is saved.\
\>", "Text",
 CellChangeTimes->{{3.5808982533077106`*^9, 3.580898259632072*^9}}],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816697178146343`*^9, 3.581669717815634*^9}}],

Cell[BoxData[
 RowBox[{"ClearSystemCache", "[", "]"}]], "Input",
 CellChangeTimes->{{3.581669726757145*^9, 3.5816697379287844`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"directory", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"\"\<mse.m\>\"", ",", 
   RowBox[{"Path", "\[Rule]", "directory"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6392064512024283`*^9, 3.6392064555015736`*^9}, {
  3.6392064862997465`*^9, 3.6392065233606443`*^9}, {3.6392250169707823`*^9, 
  3.6392250177207823`*^9}, {3.6535358489289207`*^9, 3.653535855296494*^9}, {
  3.709482620021003*^9, 3.70948262065952*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"6f7079eb-e682-4709-bad8-0c8ec965b184"],

Cell[BoxData["\<\"/home/tchr/Projects/Mathematica/MSE-Mathematica/\"\>"], \
"Output",
 CellChangeTimes->{
  3.6535358608398933`*^9, 3.686929203726038*^9, 3.686930821364958*^9, 
   3.686931006815919*^9, 3.686936864604438*^9, {3.707557808810499*^9, 
   3.707557811296351*^9}, {3.707661327359004*^9, 3.707661337708104*^9}, 
   3.707665182708693*^9, 3.707666082756846*^9, 3.70766635134763*^9, 
   3.709202016739093*^9, 3.709205445549831*^9, 3.7094452158126497`*^9, 
   3.709445751825338*^9, 3.70945581006676*^9, 3.709469152678699*^9, 
   3.709476927501616*^9, 3.709480111970817*^9, 3.709480148860219*^9, 
   3.7094822539197073`*^9, 3.709482624398921*^9, 3.7095244490014563`*^9, 
   3.70952480292412*^9, 3.7095253825368156`*^9, 3.709530703718384*^9, 
   3.709542599786195*^9, 3.709697323426976*^9, 3.7096994803573112`*^9, 
   3.710165445179934*^9, 3.7110041224933977`*^9, 3.7110210387619066`*^9, {
   3.7110408474209776`*^9, 3.7110408481240177`*^9}, 3.7110446100438614`*^9, 
   3.7112129795239935`*^9, 3.711248736394968*^9, 3.711363650709928*^9, 
   3.711432605925584*^9, 
   3.711432919561407*^9},ExpressionUUID->"d0a515b0-5f6b-4d91-a1fe-\
09cb007c1238"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Echo", "[", "\"\<Loaded payoff.m\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.711434116821677*^9, 3.711434132168717*^9}, {
  3.711434316073223*^9, 3.711434320192101*^9}, {3.711434530547905*^9, 
  3.7114345317911777`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"66592182-477e-4ee9-b13b-940e06f71689"],

Cell[BoxData["\<\"Loaded payoff.m\"\>"], "Echo",
 CellChangeTimes->{
  3.711434537528976*^9},ExpressionUUID->"f8716ad5-7792-45f0-ac22-\
bb2aac3de188"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global Variables", "Subsubsection",
 CellChangeTimes->{{3.657288991936186*^9, 3.6572889972081127`*^9}, 
   3.65728905845613*^9}],

Cell["noAttr, u, d, noM, noU, noD, distanceMatrices", "Text",
 CellChangeTimes->{{3.657289004224656*^9, 3.657289020712091*^9}, {
  3.65728909112864*^9, 3.6572891045682173`*^9}},
 Background->RGBColor[1, 1, 0]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cx", "Subsection",
 CellChangeTimes->{{3.626169503603243*^9, 3.62616950426756*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Cx", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cx", "::", "usage"}], "=", 
   "\"\<Cx[n] creates a list of n variables named x1,x2,...,xn.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cx", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"\"\<x\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Information", "[", 
  RowBox[{"Cx", ",", 
   RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6260970725552883`*^9, 3.6260972022973456`*^9}, {
  3.6261692693125653`*^9, 3.626169274830132*^9}, {3.6263451577501373`*^9, 
  3.6263451994688873`*^9}, {3.711434541147997*^9, 3.7114345647219687`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"5d0b68bf-0c4c-484f-a8ea-7601cc14e879"],

Cell[BoxData[
 StyleBox["\<\"Cx[n] creates a list of n variables named x1,x2,...,xn.\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.71143458012475*^9},
 CellTags->
  "Info53711445379-5830608",ExpressionUUID->"0f58b9eb-f16a-4cfe-9a4e-\
ca5a641bea98"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["payoff", "Subsection",
 CellChangeTimes->{{3.62616950983075*^9, 3.6261695125817266`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "payoff", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"payoff", "::", "usage"}], "=", 
   "\"\<payoff[m,i,j] returns the payoff of i-upstream and j-upstream in the \
m-market. \nIt is used when the streams of u and d agents are imported \
separately (i.e. not in the precomputed format). It is assumed that u , d , \
and noAttr have been already assigned.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"payoff", "[", 
    RowBox[{"m_", ",", "i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Cx", "[", 
         RowBox[{
          StyleBox["noAttr",
           Background->RGBColor[1, 1, 0]], "-", "1"}], "]"}], ",", "1"}], 
       "]"}], 
      RowBox[{
       StyleBox["u",
        Background->RGBColor[1, 1, 0]], "[", 
       RowBox[{"[", 
        RowBox[{"m", ",", "i"}], "]"}], "]"}]}], ")"}], ".", 
    RowBox[{
     StyleBox["d",
      Background->RGBColor[1, 1, 0]], "[", 
     RowBox[{"[", 
      RowBox[{"m", ",", "j"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Information", "[", 
  RowBox[{"payoff", ",", 
   RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6260969688470917`*^9, 3.626096978734878*^9}, {
   3.626097218817205*^9, 3.6260972527523394`*^9}, {3.6260972966312456`*^9, 
   3.6260973035157413`*^9}, {3.626097613365889*^9, 3.6260976281539745`*^9}, 
   3.6261105568706055`*^9, {3.6261692802920585`*^9, 3.6261692900482745`*^9}, {
   3.6261696027442513`*^9, 3.62616962853998*^9}, {3.6263456135001373`*^9, 
   3.6263457717657623`*^9}, {3.6263458174220123`*^9, 
   3.6263458350470123`*^9}, {3.632739732008258*^9, 3.6327397398325505`*^9}, {
   3.697047429993506*^9, 3.6970474433085537`*^9}, {3.711434569181081*^9, 
   3.7114345770630703`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"e47fc6e3-a265-494f-97c8-7d2caee133d8"],

Cell[BoxData[
 StyleBox["\<\"payoff[m,i,j] returns the payoff of i-upstream and j-upstream \
in the m-market. \\nIt is used when the streams of u and d agents are \
imported separately (i.e. not in the precomputed format). It is assumed that \
u , d , and noAttr have been already assigned.\"\>", "MSG"]], "Print", \
"PrintUsage",
 CellChangeTimes->{3.711434582119796*^9},
 CellTags->
  "Info93711445382-5830608",ExpressionUUID->"02be2bed-7823-4474-8654-\
916a044620c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "payoffDM", "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"DM", " ", "from", " ", "Distance", " ", "Matrix"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"payoffDM", "::", "usage"}], "=", 
   "\"\<payoffDM[m,i,j] returns the payoff of i-upstream and j-upstream in \
the m-market.\\r\nIt is used in the case of precomputed data. It is assumed \
that noAttr and distanceMatrices have been already assigned.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"payoffDM", "[", 
    RowBox[{"m_", ",", "i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"Cx", "[", 
       RowBox[{
        StyleBox["noAttr",
         Background->RGBColor[1, 1, 0]], "-", "1"}], "]"}], ",", "1"}], "]"}],
     ".", 
    RowBox[{
     StyleBox["distanceMatrices",
      Background->RGBColor[1, 1, 0]], "[", 
     RowBox[{"[", 
      RowBox[{"m", ",", "i", ",", "j"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Information", "[", 
  RowBox[{"payoffDM", ",", 
   RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612012388803448*^9, 3.612012423100323*^9}, 
   3.626169883844104*^9, 3.626171560119195*^9, {3.6261727802254305`*^9, 
   3.6261727846650887`*^9}, {3.626172896174202*^9, 3.6261729336334953`*^9}, {
   3.6263458504220123`*^9, 3.6263459143438873`*^9}, {3.6327397695123205`*^9, 
   3.6327397767115393`*^9}, {3.711434584856642*^9, 3.711434595300276*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"e1eef433-418b-45b7-869c-0b66f68e5440"],

Cell[BoxData[
 StyleBox["\<\"payoffDM[m,i,j] returns the payoff of i-upstream and \
j-upstream in the m-market. \\nIt is used in the case of precomputed data. It \
is assumed that noAttr and distanceMatrices have been already assigned.\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.7114345960994253`*^9},
 CellTags->
  "Info133711445396-5830608",ExpressionUUID->"f1004424-fc4a-4bce-a375-\
629ffa265013"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CpayoffMatrix[payoff,noM,noU,noD]", "Subsection",
 CellChangeTimes->{
  3.6117411131376095`*^9, 3.611741233674157*^9, {3.611741277829609*^9, 
   3.6117412916970325`*^9}, {3.611912880528715*^9, 3.611912891202575*^9}, {
   3.6119140905750036`*^9, 3.611914092263646*^9}, {3.611918058468073*^9, 
   3.611918059112929*^9}, 3.6119214516902895`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "C", " ", "in", " ", "front", " ", "of", " ", "the", " ", "name", " ", 
    "means", " ", "create"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "CpayoffMatrix", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CpayoffMatrix", "::", "usage"}], "=", 
     "\"\<CpayoffMatrix[payoff(or \
payoffDM),noM_:noM,noU_:noU,noD_:noD,parallel_:False] calculates and assigns \
the payoffMatrix.\\r \npayoff is used when input data consist of separate u \
and d streams.\\r\npayoffDM is used for precomputed data.\\r\n\
CpayoffMatrix[solution_?VectorQ] substitutes the solution to all \
payoffMatrix's entries.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"CpayoffMatrix", "[", 
     RowBox[{"payoff_", ",", 
      RowBox[{"noM_:", 
       StyleBox["noM",
        Background->RGBColor[1, 1, 0]]}], ",", 
      RowBox[{"noU_:", 
       StyleBox["noU",
        Background->RGBColor[1, 1, 0]]}], ",", 
      RowBox[{"noD_:", 
       StyleBox["noD",
        Background->RGBColor[1, 1, 0]]}], ",", 
      RowBox[{"p_:", "False"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"payoffMatrix", "=", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"p", "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"payoff", "[", 
          RowBox[{"m", ",", "i", ",", "j"}], "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "noM"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"noU", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"noD", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"payoff", "[", 
          RowBox[{"m", ",", "i", ",", "j"}], "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "noM"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"noU", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"noD", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CpayoffMatrix", "[", 
      RowBox[{"solution_", "?", "VectorQ"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Length", "@", "solution"}], ")"}], "===", 
        RowBox[{"noAttr", "-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"payoffMatrix", "=", 
        RowBox[{"(", 
         RowBox[{"payoffMatrix", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Cx", "[", 
             RowBox[{"noAttr", "-", "1"}], "]"}], "\[Rule]", "solution"}], 
           "]"}]}], ")"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<There is some problem with your input. Couldn't calculate \
anything meaningful.\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Information", "[", 
    RowBox[{"CpayoffMatrix", ",", 
     RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611654102177257*^9, 3.6116542218406477`*^9}, 
   3.611654420939027*^9, {3.6116544925174885`*^9, 3.6116545056894417`*^9}, {
   3.6116545421489096`*^9, 3.611654664496849*^9}, {3.611741108152258*^9, 
   3.611741109824133*^9}, {3.6117412417288446`*^9, 3.6117412863497148`*^9}, {
   3.6117415360333033`*^9, 3.611741537631454*^9}, 3.6119225913033714`*^9, {
   3.611929413502285*^9, 3.6119294152102914`*^9}, {3.6119295081901774`*^9, 
   3.611929510149438*^9}, {3.6263317925365915`*^9, 3.6263318272553415`*^9}, {
   3.6263459356407623`*^9, 3.6263459774376373`*^9}, {3.6263460270626373`*^9, 
   3.6263461978595123`*^9}, {3.632739828995996*^9, 3.6327398487169237`*^9}, {
   3.657289191249384*^9, 3.6572892111054153`*^9}, {3.687931956798997*^9, 
   3.687931971418502*^9}, {3.6879324344177*^9, 3.6879324632483473`*^9}, {
   3.687932658651929*^9, 3.687932724579956*^9}, {3.687933330442122*^9, 
   3.6879334051140947`*^9}, 3.687933478737028*^9, {3.687933535699217*^9, 
   3.687933545203259*^9}, {3.687933587247164*^9, 3.68793366691227*^9}, {
   3.687933780577362*^9, 3.687933803573482*^9}, {3.6879339236697903`*^9, 
   3.687933949068503*^9}, {3.6879340641234417`*^9, 3.687934294169633*^9}, {
   3.687934500245884*^9, 3.687934512890766*^9}, {3.6879345456693363`*^9, 
   3.687934716553021*^9}, {3.687934752124819*^9, 3.6879347640129547`*^9}, {
   3.687934893456819*^9, 3.687934899864044*^9}, {3.68793495933742*^9, 
   3.687934978122425*^9}, {3.687935586245936*^9, 3.6879356137188*^9}, {
   3.687935651303357*^9, 3.687935655860488*^9}, {3.697047509456362*^9, 
   3.6970475347792053`*^9}, {3.707665162057847*^9, 3.707665167046235*^9}, {
   3.707665221505415*^9, 3.707665240181658*^9}, {3.707665290783296*^9, 
   3.707665293541404*^9}, {3.707665462423126*^9, 3.7076654856855297`*^9}, {
   3.707666269956071*^9, 3.70766632470221*^9}, {3.711434602134906*^9, 
   3.711434646759029*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"66736c1b-531e-466b-9284-0585d5565759"],

Cell[BoxData[
 StyleBox["\<\"CpayoffMatrix[payoff(or \
payoffDM),noM_:noM,noU_:noU,noD_:noD,parallel_:False] calculates and assigns \
the payoffMatrix.
 \\npayoff is used when input data consist of separate u and d streams.
\\npayoffDM is used for precomputed data.
\\nCpayoffMatrix[solution_?VectorQ] substitutes the solution to all \
payoffMatrix's entries.\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.7114346475947657`*^9},
 CellTags->
  "Info313711445447-5830608",ExpressionUUID->"2fcbf05e-de26-4dd8-bdf2-\
c463cc942cdd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["payoffMatrix2Positive", "Subsection",
 CellChangeTimes->{{3.6328515776159687`*^9, 3.632851583139406*^9}, {
   3.632932492961161*^9, 3.6329324982433987`*^9}, 
   3.6330216979763966`*^9},ExpressionUUID->"9672d2d9-2fd4-445d-b3a2-\
006372135923"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "payoffMatrix2Positive", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"payoffMatrix2Positive", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"payoffMatrix2Positive", "::", "usage"}], "=", 
   "\"\<payoffMatrix2Positive[offset,payoffMatrix,epsilon_:0,sameoffset_:\
False] translates the payoffMatrix subtracting an offset and adding an \
epsilon. This function's main purpose is to make all elements positive.\n\
epsilon is the minimum element per market. It's default value is 0.\nIf the \
sameoffset flag is set to False (which is the default value) then each market \
will be handled separately related to its minimum.\nIf the sameoffset flag is \
set to True then the offset equals the minimum element in the entire \
payoffMatrix.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"payoffMatrix2Positive", "[", 
    RowBox[{"offset_", ",", 
     RowBox[{"payoffMatrix_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{"NumericQ", "/@", 
           RowBox[{"Flatten", "@", "#"}]}], ")"}]}], "&"}], ")"}]}], ",", 
     RowBox[{"epsilon_:", "0"}], ",", 
     RowBox[{"sameoffset_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "min", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"sameoffset", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"min", "=", 
          RowBox[{"Min", "@", 
           RowBox[{"Flatten", "@", "payoffMatrix"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"offset", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"min", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "@", "payoffMatrix"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"offset", "=", 
         RowBox[{"Min", "/@", "payoffMatrix"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"payoffMatrix", "-", "offset", "+", "epsilon"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Information", "[", 
  RowBox[{"payoffMatrix2Positive", ",", 
   RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwtylsog3EcxvGX3VDbBcVmZQ4XboYLEhdML3JcTXOIckWSC15qK624kJZE
WTFhhTmkLIeRMuzCYc0wh23RTMTF1JvastaK8D7+Ln59+j790loZZXs0RVEp
3EHV/Et6dxxLq1LtWXDLdlDJcJrLY+XMXwvrSbc0kA5bSJ8cEjfs/38O0s1X
pGtuiA4f2Wef4JJsjd8DrZ+CP2WT+cQ0muzT1aQVcqLYRfbQA+m6F6LxFc4U
jr+qk1nad8r3Q4E7OgDjz6Yi8FvaUqErYGmTYbUaSvSR4bI+ln4coQxw4axn
EUqLu9ZhorbNDB0ayzb0J5WewqG9DicMSqLc0CjOvIfOzP53aPIsBOFArl/n
XmFpfUbnBMxOvhZ4ONVFnXFQ25Qngr1z4SQoyqu6/eF85sW4oPn82Jv4wdL2
S9sDjGisu0LOnIDBCkffmEMRZ0g5FoEXJftLwi+Wrj3SL8ODwfRN+DzJ24HK
O4UXJjTyffAX4tEBjg==
  "],
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"ef3e746e-b615-400f-bc34-4f1dbd7f7448"],

Cell[BoxData["\<\"payoffMatrix2Positive[offset,payoffMatrix,epsilon_:0,\
sameoffset_:False] translates the payoffMatrix subtracting an offset and \
adding an epsilon. This function's main purpose is to make all elements \
positive.\\nepsilon is the minimum element per market. It's default value is \
0.\\nIf the sameoffset flag is set to False (which is the default value) then \
each market will be handled separately related to its minimum.\\nIf the \
sameoffset flag is set to True then the offset equals the minimum element in \
the entire payoffMatrix.\"\>"], "Print", "PrintUsage",
 CellChangeTimes->{3.756048051817561*^9},
 CellTags->
  "Info53756055251-3195600",ExpressionUUID->"6409db2f-7ea3-4a7f-865d-\
35e952680d95"]
}, Open  ]],

Cell[CellGroupData[{

Cell["examples", "Subsubsection",
 CellChangeTimes->{{3.709699586358691*^9, 3.709699587484947*^9}, {
  3.7513318069823227`*^9, 
  3.7513318084926853`*^9}},ExpressionUUID->"50de9149-a1d4-4045-b90d-\
81b79b47ea68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"payoffMatrixTEST", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "payoffMatrixTEST"}]}], "Input",
 CellChangeTimes->{{3.7513295878989277`*^9, 3.751329592318116*^9}, {
  3.75132964901954*^9, 3.751329650142212*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"41ad62ca-f17f-41e9-8c78-1ff0f61e7d52"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"6", "7", 
        RowBox[{"-", "5"}]},
       {
        RowBox[{"-", "6"}], 
        RowBox[{"-", "7"}], "7"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "5"}], "9", "8"},
       {
        RowBox[{"-", "7"}], "6", "7"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "7"}], 
        RowBox[{"-", "2"}], "2"},
       {"1", "3", "8"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.751329593848078*^9, 3.7513296002814198`*^9}, 
   3.751329650582696*^9, {3.75133180994776*^9, 3.751331825227347*^9}, 
   3.756048054856035*^9, 3.75604813119757*^9, {3.7560481742293987`*^9, 
   3.756048178784581*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"386cdbca-764b-44db-99bb-d0c26d0473e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Min", "@", 
  RowBox[{"Flatten", "@", "payoffMatrixTEST"}]}]], "Input",
 CellChangeTimes->{{3.756048132776795*^9, 3.75604816096644*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"19787791-713a-4778-a9b2-3dc46f95ceae"],

Cell[BoxData[
 RowBox[{"-", "7"}]], "Output",
 CellChangeTimes->{{3.7560481619153843`*^9, 3.756048180450108*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"5f15cc7e-e3fb-4658-9e00-97f31b8c94ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST"}], "]"}]], "Input",
 CellChangeTimes->{{3.6330214590545216`*^9, 3.6330214701951466`*^9}, 
   3.6330215005857716`*^9, {3.6393246379852843`*^9, 3.6393246452587223`*^9}, {
   3.6869342290333443`*^9, 3.686934229663679*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"bf614ae6-9547-4f96-86da-af7f64b88466"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "0", ",", "18"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "16", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "0", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"19", ",", "20", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "0", ",", "2"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6330215029138966`*^9, 3.6330216066326466`*^9, 3.6330227604920216`*^9, 
   3.6330228039451466`*^9, 3.6385973524731045`*^9, 3.6385985591490955`*^9, {
   3.639324628892536*^9, 3.6393246576522765`*^9}, 3.653536302795327*^9, 
   3.6535363589727697`*^9, 3.6869308245249157`*^9, 3.686934255571175*^9, 
   3.686934360499251*^9, 3.686934415667163*^9, 3.7095244514190397`*^9, 
   3.709525385095441*^9, 3.709699436007975*^9, 3.709699482962344*^9, {
   3.751329403533133*^9, 3.751329411299202*^9}, 3.751329617874832*^9, 
   3.751329654414112*^9, 3.751331008362564*^9, {3.751331810988864*^9, 
   3.751331827020466*^9}, 3.756048063645198*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"d1222acc-d1ba-4f00-96ce-cce7c9cc55dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["offset"], "Input",
 CellChangeTimes->{{3.6330215606013966`*^9, 3.6330215626326466`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"a619ade4-b383-43ae-a42b-2847cd15aa0d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "10"}], ",", 
   RowBox[{"-", "9"}], ",", 
   RowBox[{"-", "10"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6330215637576466`*^9, 3.6330216080232716`*^9, 3.6330228056482716`*^9, 
   3.6385973557372103`*^9, 3.6385985591490955`*^9, 3.6393246632509093`*^9, 
   3.653536361749962*^9, 3.686930824566407*^9, 3.686934258205463*^9, 
   3.686934361524753*^9, 3.6869344166252823`*^9, 3.709524451443328*^9, 
   3.709525385126391*^9, 3.709699438432047*^9, 3.709699482986532*^9, 
   3.7513294228486547`*^9, 3.751329656056259*^9, 3.751331009259268*^9, {
   3.751331812280179*^9, 3.751331831184947*^9}, 3.75604806774372*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"3c77b30f-bbb9-42ad-88d5-cc704fb4625e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", "0", ",", "True"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6869342416130457`*^9, 3.686934244339658*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"16beb967-17ba-40cc-bf97-6bd932f20c7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"15", ",", "16", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"18", ",", "13", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "12", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"18", ",", "13", ",", "13"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "12", ",", "7"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.686934262254747*^9, 3.6869343625559196`*^9, 3.686934417645965*^9, 
   3.709524451522607*^9, 3.709525385202634*^9, 3.709699449452317*^9, 
   3.709699483047043*^9, 3.7513310340216303`*^9, {3.751331813270547*^9, 
   3.7513318425760813`*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"3fde7d5c-7bc9-44e9-b79b-3d1ea8b0b161"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["offset"], "Input",
 CellChangeTimes->{{3.751331037022551*^9, 3.751331039571335*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"31bd7fc6-a671-455f-9f6a-86891208fc0b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "10"}], ",", 
   RowBox[{"-", "10"}], ",", 
   RowBox[{"-", "10"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.751331040237105*^9, {3.7513318140215178`*^9, 3.751331843800819*^9}},
 CellLabel->"Out[85]=",ExpressionUUID->"acc77fcd-c646-4e6e-9dee-0e6699b35172"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.639324677399347*^9, 3.639324681115167*^9}, {
  3.686934441847653*^9, 3.6869344424439*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"394ee353-d7a7-4bbd-901a-dccdea54faa9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"12", ",", "13", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "10", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "13", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "14", ",", "14"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "1", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "8", ",", "3"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.639324686267511*^9, 3.6535363664024563`*^9, 3.686930824610546*^9, 
   3.686934445892683*^9, 3.709524451569488*^9, 3.7095253853481073`*^9, {
   3.709699453698735*^9, 3.709699483098361*^9}, 3.751331061984893*^9, 
   3.7513318148111973`*^9, 3.7513318450158863`*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"f2fd805b-c441-4e1b-93ce-7aaa62f00055"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", "1", ",", "True"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.686934469314392*^9, 3.686934470556911*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"4d571ecd-b589-47d6-89dd-3ce5f9c8a0ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"16", ",", "17", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "14", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "13", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "14", ",", "14"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"11", ",", "6", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "13", ",", "8"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.686934471265759*^9, 3.709524451593691*^9, 3.709525385403162*^9, {
   3.7096994570423613`*^9, 3.7096994831263237`*^9}, 3.7513310749892263`*^9, 
   3.751331815610162*^9, 3.751331845772778*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"3ef60a02-48f9-4ea3-a12e-d841bc4fa79c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6393247098466125`*^9, 3.6393247516709285`*^9}, {
  3.6869344594286213`*^9, 3.686934459983068*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"37e18e13-c95b-44f4-a7ec-601ae4994a15"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"12", ",", "13", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "10", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "14", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "15", ",", "15"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "3", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "10", ",", "5"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.63932473764787*^9, 3.6393247521236367`*^9}, 
   3.653536369293524*^9, 3.686930824654154*^9, 3.6869344789375257`*^9, 
   3.7095244516154547`*^9, 3.70952538544058*^9, {3.709699459802126*^9, 
   3.709699483151299*^9}, 3.751331091181048*^9, 3.7513318164174633`*^9, 
   3.7513318465706797`*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"16e706f0-a5bc-4228-8114-9549c935d780"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.686934489123218*^9, 3.686934490382043*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"86aa1d70-743a-483e-8a12-ff0983c9b4ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"16", ",", "17", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "14", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "14", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "15", ",", "15"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "8", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "15", ",", "10"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.686934490957397*^9, 3.709524451637064*^9, 3.70952538547008*^9, {
   3.709699461721755*^9, 3.709699483176586*^9}, 3.751331099711782*^9, 
   3.751331817411929*^9, 3.751331847785376*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"29ccea47-654f-4689-a738-98041f44afd4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"payoffMatrixTEST", ",", "offset"}], "]"}]], "Input",
 CellChangeTimes->{{3.6330216186326466`*^9, 3.6330216584607716`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"176c929f-0146-447b-97ea-655c5957f051"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ctotalpayoff[payoff,mates]", "Subsection",
 CellChangeTimes->{
  3.6117411131376095`*^9, 3.611741233674157*^9, {3.611741277829609*^9, 
   3.6117412916970325`*^9}, {3.611912880528715*^9, 3.611912891202575*^9}, {
   3.6119140668733816`*^9, 3.6119141092559533`*^9}, {3.6119175864147515`*^9, 
   3.611917587407542*^9}},
 CellID->925377420],

Cell["\<\
If the payoffobject is the payoff function then the head equals Symbol and \
the corresponding routine is used.
If the payoffobject is the payoffMatrix then the head equals List and the \
corresponding routine is used.\
\>", "Text",
 CellChangeTimes->{{3.6263346577397165`*^9, 3.6263346977709665`*^9}},
 CellID->1964608544],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "C", " ", "in", " ", "front", " ", "of", " ", "the", " ", "name", " ", 
    "means", " ", "create"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "Ctotalpayoff", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ctotalpayoff", "::", "usage"}], "=", 
     "\"\<Ctotalpayoff[payoffobject,mates] calculates the total payoff (i.e. \
the sum of payoffs) across all markets for the specific mates arrangement. \
This function accepts as a first argument the \
\[OpenCurlyDoubleQuote]payffobject\[CloseCurlyDoubleQuote], which can either \
be the name of the payoff function or the payoffMatrix (in case we have \
already calculated all pair payoffs).\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ctotalpayoff", "[", 
      RowBox[{"payoffobject_", ",", "mates_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"totalpayoff", "=", "\[IndentingNewLine]", 
      RowBox[{"Total", "/@", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Head", "@", "payoffobject"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"payoff", " ", "function"}], "*)"}], "Symbol", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"payoffobject", "@@", "#"}], "&"}], ",", "mates", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "payoffMatrix", "*)"}], "List", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "@@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "payoffobject", "}"}], ",", "#"}], "]"}]}], "&"}],
            ",", "mates", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Information", "[", 
    RowBox[{"Ctotalpayoff", ",", 
     RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611654102177257*^9, 3.6116542218406477`*^9}, 
   3.611654420939027*^9, {3.6116544925174885`*^9, 3.6116545056894417`*^9}, {
   3.6116545421489096`*^9, 3.611654664496849*^9}, {3.611741108152258*^9, 
   3.611741109824133*^9}, {3.6117412417288446`*^9, 3.6117412863497148`*^9}, {
   3.6117415360333033`*^9, 3.611741537631454*^9}, {3.61191415635421*^9, 
   3.611914176556762*^9}, 3.6119175802137594`*^9, {3.611917732019161*^9, 
   3.6119177370020638`*^9}, 3.6186504986837187`*^9, {3.6263343084115915`*^9, 
   3.6263343660834665`*^9}, {3.6263343983803415`*^9, 
   3.6263344230365915`*^9}, {3.6263345018022165`*^9, 
   3.6263345378647165`*^9}, {3.6263345822865915`*^9, 
   3.6263346539740915`*^9}, {3.6263368089897165`*^9, 
   3.6263368493334665`*^9}, {3.6327453509548144`*^9, 
   3.6327454266618457`*^9}, {3.6327454824266925`*^9, 3.632745499274597*^9}, {
   3.6880084344367313`*^9, 3.688008439923318*^9}, {3.6970475837469788`*^9, 
   3.697047585930585*^9}, {3.697047648304394*^9, 3.697047649017954*^9}, {
   3.7113477381816683`*^9, 3.711347743219247*^9}, {3.711434621911147*^9, 
   3.711434634637506*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellID->1747771955,ExpressionUUID->"50178ce3-17a6-44b1-9332-ef1785e26fbb"],

Cell[BoxData[
 StyleBox["\<\"Ctotalpayoff[payoffobject,mates] calculates the total payoff \
(i.e. the sum of payoffs) across all markets for the specific mates \
arrangement. This function accepts as a first argument the \
\[OpenCurlyDoubleQuote]payffobject\[CloseCurlyDoubleQuote], which can either \
be the name of the payoff function or the payoffMatrix (in case we have \
already calculated all pair payoffs).\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.711434636613043*^9},
 CellTags->
  "Info263711445436-5830608",ExpressionUUID->"ce2e61e8-dba1-4b06-b184-\
cf08ba5d05bd"]
}, Open  ]],

Cell["\<\
Note: Calculations may be differ by 10^(-9) or smaller but some times they \
are not the same...\
\>", "Text",
 CellChangeTimes->{{3.6199441172064447`*^9, 3.6199441750658197`*^9}},
 CellID->1688422668]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1366, 704},
WindowMargins->{{0, Automatic}, {0, Automatic}},
ShowSelection->True,
Magnification->0.75,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info53711445379-5830608"->{
  Cell[5595, 156, 264, 6, 32, "Print",ExpressionUUID->"0f58b9eb-f16a-4cfe-9a4e-ca5a641bea98",
   CellTags->"Info53711445379-5830608"]},
 "Info93711445382-5830608"->{
  Cell[8058, 223, 470, 9, 59, "Print",ExpressionUUID->"02be2bed-7823-4474-8654-916a044620c5",
   CellTags->"Info93711445382-5830608"]},
 "Info133711445396-5830608"->{
  Cell[10241, 281, 419, 8, 46, "Print",ExpressionUUID->"f1004424-fc4a-4bce-a375-629ffa265013",
   CellTags->"Info133711445396-5830608"]},
 "Info313711445447-5830608"->{
  Cell[16728, 431, 540, 11, 74, "Print",ExpressionUUID->"2fcbf05e-de26-4dd8-bdf2-c463cc942cdd",
   CellTags->"Info313711445447-5830608"]},
 "Info53756055251-3195600"->{
  Cell[20667, 528, 728, 11, 93, "Print",ExpressionUUID->"6409db2f-7ea3-4a7f-865d-35e952680d95",
   CellTags->"Info53756055251-3195600"]},
 "Info263711445436-5830608"->{
  Cell[39517, 1030, 592, 10, 92, "Print",ExpressionUUID->"ce2e61e8-dba1-4b06-b184-cf08ba5d05bd",
   CellTags->"Info263711445436-5830608"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info53711445379-5830608", 40736, 1065},
 {"Info93711445382-5830608", 40902, 1068},
 {"Info133711445396-5830608", 41069, 1071},
 {"Info313711445447-5830608", 41238, 1074},
 {"Info53756055251-3195600", 41407, 1077},
 {"Info263711445436-5830608", 41576, 1080}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 197, 3, 52, "Section",ExpressionUUID->"f1a9f239-01bf-403e-98a9-9896ece82af9"],
Cell[CellGroupData[{
Cell[801, 29, 110, 1, 35, "Subsubsection",ExpressionUUID->"d419221b-66e8-42d6-96ab-261a7326bff7"],
Cell[914, 32, 272, 5, 28, "Text",ExpressionUUID->"24bc6e36-46bc-4ece-aa64-d99078d05446"],
Cell[1189, 39, 179, 4, 24, "Input",ExpressionUUID->"f84f06a0-113b-4e17-acd3-5c6ddf53fd8b"],
Cell[1371, 45, 148, 3, 24, "Input",ExpressionUUID->"090428d4-9e2a-438e-81fa-459a51cf850e"],
Cell[1522, 50, 132, 2, 24, "Input",ExpressionUUID->"d78b7814-7c90-486d-a02d-6c8422c2825e"],
Cell[CellGroupData[{
Cell[1679, 56, 591, 11, 55, "Input",ExpressionUUID->"6f7079eb-e682-4709-bad8-0c8ec965b184"],
Cell[2273, 69, 1150, 18, 27, "Output",ExpressionUUID->"d0a515b0-5f6b-4d91-a1fe-09cb007c1238"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3460, 92, 386, 8, 36, "Input",ExpressionUUID->"66592182-477e-4ee9-b13b-940e06f71689",
 InitializationCell->True],
Cell[3849, 102, 150, 3, 20, "Echo",ExpressionUUID->"f8716ad5-7792-45f0-ac22-bb2aac3de188"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4048, 111, 134, 2, 35, "Subsubsection",ExpressionUUID->"ef140710-60b4-42cf-b4f2-7cce32b2aeb0"],
Cell[4185, 115, 209, 3, 40, "Text",ExpressionUUID->"c4d9d7d9-1f86-4ec3-b2bb-400278960b59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4431, 123, 89, 1, 41, "Subsection",ExpressionUUID->"d3872fc1-87bd-445f-b12c-360ba653edea"],
Cell[CellGroupData[{
Cell[4545, 128, 1047, 26, 91, "Input",ExpressionUUID->"5d0b68bf-0c4c-484f-a8ea-7601cc14e879",
 InitializationCell->True],
Cell[5595, 156, 264, 6, 32, "Print",ExpressionUUID->"0f58b9eb-f16a-4cfe-9a4e-ca5a641bea98",
 CellTags->"Info53711445379-5830608"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5908, 168, 95, 1, 41, "Subsection",ExpressionUUID->"09d0a645-6123-4a37-9318-1bce5d43d298"],
Cell[CellGroupData[{
Cell[6028, 173, 2027, 48, 123, "Input",ExpressionUUID->"e47fc6e3-a265-494f-97c8-7d2caee133d8",
 InitializationCell->True],
Cell[8058, 223, 470, 9, 59, "Print",ExpressionUUID->"02be2bed-7823-4474-8654-916a044620c5",
 CellTags->"Info93711445382-5830608"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8565, 237, 1673, 42, 109, "Input",ExpressionUUID->"e1eef433-418b-45b7-869c-0b66f68e5440",
 InitializationCell->True],
Cell[10241, 281, 419, 8, 46, "Print",ExpressionUUID->"f1004424-fc4a-4bce-a375-629ffa265013",
 CellTags->"Info133711445396-5830608"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10709, 295, 348, 5, 41, "Subsection",ExpressionUUID->"ab2824b7-3569-467d-9d40-61e9aed37566"],
Cell[CellGroupData[{
Cell[11082, 304, 5643, 125, 415, "Input",ExpressionUUID->"66736c1b-531e-466b-9284-0585d5565759",
 InitializationCell->True],
Cell[16728, 431, 540, 11, 74, "Print",ExpressionUUID->"2fcbf05e-de26-4dd8-bdf2-c463cc942cdd",
 CellTags->"Info313711445447-5830608"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17317, 448, 248, 4, 41, "Subsection",ExpressionUUID->"9672d2d9-2fd4-445d-b3a2-006372135923"],
Cell[CellGroupData[{
Cell[17590, 456, 3074, 70, 343, "Input",ExpressionUUID->"ef3e746e-b615-400f-bc34-4f1dbd7f7448",
 InitializationCell->True],
Cell[20667, 528, 728, 11, 93, "Print",ExpressionUUID->"6409db2f-7ea3-4a7f-865d-35e952680d95",
 CellTags->"Info53756055251-3195600"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21432, 544, 212, 4, 35, "Subsubsection",ExpressionUUID->"50de9149-a1d4-4045-b90d-81b79b47ea68"],
Cell[CellGroupData[{
Cell[21669, 552, 756, 19, 43, "Input",ExpressionUUID->"41ad62ca-f17f-41e9-8c78-1ff0f61e7d52"],
Cell[22428, 573, 2371, 65, 41, "Output",ExpressionUUID->"386cdbca-764b-44db-99bb-d0c26d0473e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24836, 643, 239, 4, 24, "Input",ExpressionUUID->"19787791-713a-4778-a9b2-3dc46f95ceae"],
Cell[25078, 649, 192, 3, 27, "Output",ExpressionUUID->"5f15cc7e-e3fb-4658-9e00-97f31b8c94ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25307, 657, 395, 6, 24, "Input",ExpressionUUID->"bf614ae6-9547-4f96-86da-af7f64b88466"],
Cell[25705, 665, 1346, 31, 27, "Output",ExpressionUUID->"d1222acc-d1ba-4f00-96ce-cce7c9cc55dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27088, 701, 180, 2, 24, "Input",ExpressionUUID->"a619ade4-b383-43ae-a42b-2847cd15aa0d"],
Cell[27271, 705, 746, 14, 27, "Output",ExpressionUUID->"3c77b30f-bbb9-42ad-88d5-cc704fb4625e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28054, 724, 290, 5, 24, "Input",ExpressionUUID->"16beb967-17ba-40cc-bf97-6bd932f20c7a"],
Cell[28347, 731, 962, 26, 27, "Output",ExpressionUUID->"3fde7d5c-7bc9-44e9-b79b-3d1ea8b0b161"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29346, 762, 177, 2, 24, "Input",ExpressionUUID->"31bd7fc6-a671-455f-9f6a-86891208fc0b"],
Cell[29526, 766, 315, 8, 27, "Output",ExpressionUUID->"acc77fcd-c646-4e6e-9dee-0e6699b35172"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29878, 779, 319, 5, 24, "Input",ExpressionUUID->"394ee353-d7a7-4bbd-901a-dccdea54faa9"],
Cell[30200, 786, 983, 26, 27, "Output",ExpressionUUID->"f2fd805b-c441-4e1b-93ce-7aaa62f00055"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31220, 817, 288, 5, 24, "Input",ExpressionUUID->"4d571ecd-b589-47d6-89dd-3ce5f9c8a0ba"],
Cell[31511, 824, 914, 25, 27, "Output",ExpressionUUID->"3ef60a02-48f9-4ea3-a12e-d841bc4fa79c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32462, 854, 386, 7, 24, "Input",ExpressionUUID->"37e18e13-c95b-44f4-a7ec-601ae4994a15"],
Cell[32851, 863, 1010, 26, 27, "Output",ExpressionUUID->"16e706f0-a5bc-4228-8114-9549c935d780"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33898, 894, 344, 6, 24, "Input",ExpressionUUID->"86aa1d70-743a-483e-8a12-ff0983c9b4ec"],
Cell[34245, 902, 908, 25, 27, "Output",ExpressionUUID->"29ccea47-654f-4689-a738-98041f44afd4"]
}, Open  ]],
Cell[35168, 930, 253, 4, 24, "Input",ExpressionUUID->"176c929f-0146-447b-97ea-655c5957f051"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35470, 940, 341, 6, 41, "Subsection",ExpressionUUID->"474613c3-62b3-41b8-920e-f555b759a84c",
 CellID->925377420],
Cell[35814, 948, 333, 7, 48, "Text",ExpressionUUID->"fff7dfdb-18c7-4bc5-9736-57e3850f3640",
 CellID->1964608544],
Cell[CellGroupData[{
Cell[36172, 959, 3342, 69, 235, "Input",ExpressionUUID->"50178ce3-17a6-44b1-9332-ef1785e26fbb",
 InitializationCell->True,
 CellID->1747771955],
Cell[39517, 1030, 592, 10, 92, "Print",ExpressionUUID->"ce2e61e8-dba1-4b06-b184-cf08ba5d05bd",
 CellTags->"Info263711445436-5830608"]
}, Open  ]],
Cell[40124, 1043, 211, 5, 41, "Text",ExpressionUUID->"654d9723-0438-4c1f-8884-37e1802cf8a2",
 CellID->1688422668]
}, Open  ]]
}, Open  ]]
}
]
*)

