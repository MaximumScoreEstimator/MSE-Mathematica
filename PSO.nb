(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     44141,       1163]
NotebookOptionsPosition[     42561,       1106]
NotebookOutlinePosition[     42975,       1124]
CellTagsIndexPosition[     42932,       1121]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["PSO.nb", "Section",
 CellChangeTimes->{{3.62600628385137*^9, 3.626006284835745*^9}, {
  3.6260709487170696`*^9, 3.6260709533480415`*^9}, {3.626096953477417*^9, 
  3.6260969551364455`*^9}, {3.6261707215015993`*^9, 3.6261707234205446`*^9}, {
  3.6261736078812375`*^9, 3.6261736107103395`*^9}, {3.626507273633491*^9, 
  3.626507273931065*^9}}],

Cell[CellGroupData[{

Cell["For the Developer", "Subsubsection",
 CellChangeTimes->{{3.5819225877880845`*^9, 3.581922592443351*^9}}],

Cell["\<\
AutoGeneratedPackage is an option for notebooks that specifies whether a \
package is automatically created when a notebook that contains initialization \
cells or groups is saved.\
\>", "Text",
 CellChangeTimes->{{3.5808982533077106`*^9, 3.580898259632072*^9}}],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816697178146343`*^9, 3.581669717815634*^9}}],

Cell[BoxData[
 RowBox[{"ClearSystemCache", "[", "]"}]], "Input",
 CellChangeTimes->{{3.581669726757145*^9, 3.5816697379287844`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["code", "Subsection",
 CellChangeTimes->{{3.626507504311381*^9, 3.626507504905131*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "version", " ", "of", " ", "PSO", " ", "minimises", " ", "a", 
   " ", "given", " ", "objective", " ", "function"}], "*)"}]], "Input",
 CellChangeTimes->{{3.624239076819827*^9, 3.6242390886810217`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"objFun", ":", " ", 
    RowBox[{
    "an", " ", "objective", " ", "function", " ", "which", " ", "takes", " ", 
     "a", " ", "single", " ", "list", " ", "as", " ", "an", " ", "argument", 
     "\[IndentingNewLine]", "nparts"}], ":", " ", 
    RowBox[{
    "the", " ", "number", " ", "of", " ", "particles", "\[IndentingNewLine]", 
     RowBox[{"bndLo", ":", " ", 
      RowBox[{
      "a", " ", "list", " ", "of", " ", "the", " ", "lower", " ", 
       "bounds"}]}]}]}], ",", " ", 
   RowBox[{
   "one", " ", "for", " ", "each", " ", "dimension", "\[IndentingNewLine]", 
    " ", 
    RowBox[{"bndUp", ":", " ", 
     RowBox[{
     "a", " ", "list", " ", "of", " ", "the", " ", "upper", " ", 
      "bounds"}]}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "one", " ", "for", " ", "each", " ", "dimension", "\[IndentingNewLine]", 
     RowBox[{"r", ":", " ", 
      RowBox[{
      "length", " ", "of", " ", "the", " ", "toroidal", " ", "neighbour", " ",
        "scheme", "\[IndentingNewLine]", " ", 
       RowBox[{"e", ".", "g", ".", " ", "r"}]}]}]}], "=", 
    RowBox[{"1", " ", "gives", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"i", "-", 
        RowBox[{"1", " ", "mod", " ", "nparts"}]}], ",", " ", "i", ",", " ", 
       RowBox[{"i", "+", 
        RowBox[{"1", " ", "mod", " ", "nparts"}]}]}], ")"}], " ", "as", " ", 
     "the", " ", "neighbours", " ", "of", " ", "particle", " ", "i"}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.624239756384476*^9, 3.6242399170975194`*^9}, 
   3.6265158476579294`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"positions", ":", " ", 
    RowBox[{"a", " ", "list", " ", "of", " ", "nparts", " ", "lists"}]}], ",",
    " ", 
   RowBox[{
   "each", " ", "representing", " ", "the", " ", "position", " ", "vector", 
    " ", "of", " ", "the", " ", "associated", " ", "particle", 
    "\[IndentingNewLine]", 
    RowBox[{"velocities", ":", " ", 
     RowBox[{"a", " ", "list", " ", "of", " ", "nparts", " ", "lists"}]}]}], 
   ",", " ", 
   RowBox[{
   "each", " ", "representing", " ", "the", " ", "velocity", " ", "vector", 
    " ", "of", " ", "the", " ", "associated", " ", "particle", 
    "\[IndentingNewLine]", 
    RowBox[{"neighbours", ":", " ", 
     RowBox[{
     "a", " ", "function", " ", "which", " ", "takes", " ", "a", " ", "list", 
      " ", "of", " ", "positions", " ", "or", " ", "function", " ", "values", 
      " ", "and", " ", "returns", " ", "a", " ", "list", " ", "of", " ", 
      "lists", " ", "of", " ", "neighbour", " ", "position", " ", "vectors", 
      " ", "or", " ", "function", " ", "values", "\[IndentingNewLine]", 
      RowBox[{"bestPositions", ":", " ", 
       RowBox[{
       "a", " ", "list", " ", "of", " ", "nparts", " ", "lists"}]}]}]}]}], 
   ",", " ", 
   RowBox[{
   "each", " ", "representing", " ", "the", " ", "position", " ", "vector", 
    " ", "of", " ", "the", " ", 
    RowBox[{"(", "previous", ")"}], " ", "best", " ", "position", " ", "for", 
    " ", "the", " ", "associated", " ", "particle", "\[IndentingNewLine]", 
    RowBox[{"bestNeighbourPositions", ":", " ", 
     RowBox[{"a", " ", "list", " ", "of", " ", "nparts", " ", "lists"}]}]}], 
   ",", " ", 
   RowBox[{
   "each", " ", "representing", " ", "the", " ", "position", " ", "vector", 
    " ", "of", " ", "the", " ", 
    RowBox[{"(", "previous", ")"}], " ", "best", " ", "position", " ", "for", 
    " ", "the", " ", "neighbourhood", " ", "of", " ", "the", " ", 
    "associated", " ", "particle"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.624239919617022*^9, 3.624240165813485*^9}, {
  3.6242894255704575`*^9, 3.6242894384970703`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "initialiseParticles", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialiseParticles", "[", 
   RowBox[{
   "objFun_", ",", "nparts_Integer", ",", "bndLo_List", ",", "bndUp_List", 
    ",", 
    RowBox[{"r_Integer:", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ndims", ",", "positions", ",", "velocities", ",", "neighbours", ",", 
      "idx", ",", "bestPositions", ",", "bestNeighbourPositions", ",", 
      "vals"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ndims", "=", 
      RowBox[{"Length", "[", "bndLo", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "ndims", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"positions", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"#", ",", "nparts"}], "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"bndLo", ",", "bndUp"}], "}"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "positions", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"velocities", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"#", ",", "nparts"}], "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"bndLo", ",", "bndUp"}], "}"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "velocities", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"neighbours", "[", "poss_", "]"}], ":=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"RotateLeft", "[", 
           RowBox[{"poss", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "r"}], ",", "r"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"neighbours", "[", "positions", "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bestPositions", "=", "positions"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"for", " ", "maximisation"}], ",", " ", 
       RowBox[{"replace", " ", 
        RowBox[{"Ordering", "[", 
         RowBox[{"#", ",", "1"}], "]"}], " ", "with", " ", 
        RowBox[{"Ordering", "[", 
         RowBox[{"#", ",", "1", ",", "Greater"}], "]"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{"objFun", "/@", "positions"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "vals", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"idx", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Ordering", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
           RowBox[{"Map", "[", 
            RowBox[{"objFun", ",", 
             RowBox[{"neighbours", "[", "positions", "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"Ordering", "[", 
          RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "/@", 
       RowBox[{"neighbours", "[", "vals", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "idx", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"also", ":", "\[IndentingNewLine]", "bestNeighbourPositions"}],
        "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"neighbours", "[", "positions", "]"}], 
          "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], "&"}], "@@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", "nparts", "]"}], ",", "idx"}], "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bestNeighbourPositions", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"neighbours", "[", "positions", "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", 
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nparts"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bestNeighbourPositions", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "positions", ",", "velocities", ",", "neighbours", ",", 
        "bestPositions", ",", "bestNeighbourPositions", ",", "vals"}], "}"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQbbQm5sE6hteO75REH4Hohvb1H0G0mYvGNxB9/uhx
+fVAelEpkwKI9rngYQSiz5f/BNNCz0zDQLTE3r5wED0r91AOiJ7R6VwEotnM
RJtAdMEdhxYQvUZRoANE72sI7ATRh8UnTAXRH5QPzQLrP9Z2A0R7dMXdA9FB
PZ8ENwBpq4PyYiD6iWyxNYiuUGW2AdGbgk7Yg+h9yy84g2jlDFk/EB1xrTcA
RN96o9EJogOMFvSA6LMyDKtAdEzkpnUgWmEpJ/smIJ2Vf1oSRD+fZukGovcf
7vcC0XPcHQNAtIf4GjD9+3hbKoiubF6TDaLd7Oeq7wDSJqzJWiC6rjJyAojm
fr5oMojOi3jcO4UHSN+QmASiAUZzq+I=
  "],
 Background->RGBColor[0.88, 1, 0.88]],

Cell[BoxData[
 RowBox[{
  RowBox[{"psoStep", "[", 
   RowBox[{
   "objFun_", ",", "bndLo_List", ",", "bndUp_List", ",", "positions_List", 
    ",", "velocities_List", ",", "neighbours_", ",", "prevBestPositions_List",
     ",", "prevBestNeighbourPositions_List", ",", "vals_List", ",", 
    RowBox[{"\[Omega]_Real:", 
     FractionBox["0.5", 
      RowBox[{"Log", "[", "2.", "]"}]]}], ",", 
    RowBox[{"c_Real:", 
     RowBox[{"(", 
      RowBox[{"0.5", "+", 
       RowBox[{"Log", "[", "2.", "]"}]}], ")"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nparts", ",", "ndims", ",", "bestPositions", ",", 
      "bestNeighbourPositions", ",", "idx", ",", "\[Phi]1", ",", "\[Phi]2", 
      ",", "newPositions", ",", "newVelocities", ",", "newVals"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nparts", ",", "ndims"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "positions", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"nparts", ",", "ndims"}], "}"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"replace", " ", "<", " ", "with", " ", ">", " ", 
       RowBox[{"for", " ", "maximisation"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bestPositions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"objFun", "[", "#1", "]"}], "<", 
            RowBox[{"objFun", "[", "#2", "]"}]}], ",", "#1", ",", "#2"}], 
          "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"positions", ",", "prevBestPositions"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bestPositions", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"idx", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Ordering", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
           RowBox[{"Map", "[", 
            RowBox[{"objFun", ",", 
             RowBox[{"neighbours", "[", "positions", "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"neighbours", "[", "vals", "]"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "idx", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bestNeighbourPositions", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"neighbours", "[", "positions", "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", 
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nparts"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bestNeighbourPositions", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Phi]1", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "c"}], "}"}], ",", "nparts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\[Phi]1", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Phi]2", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "c"}], "}"}], ",", "nparts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\[Phi]2", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"velocities", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Omega]", " ", 
            RowBox[{
            "velocities", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "+", 
           RowBox[{
            RowBox[{
            "\[CurlyPhi]1", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "bestPositions", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{
              "positions", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{
            "\[CurlyPhi]2", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "bestNeighbourPositions", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{
              "positions", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nparts"}], "}"}]}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newVelocities", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Omega]", " ", "#2"}], "+", 
          RowBox[{"#5", 
           RowBox[{"(", 
            RowBox[{"#3", "-", "#1"}], ")"}]}], "+", 
          RowBox[{"#6", 
           RowBox[{"(", 
            RowBox[{"#4", "-", "#1"}], ")"}]}]}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "positions", ",", "velocities", ",", "bestPositions", ",", 
          "bestNeighbourPositions", ",", "\[Phi]1", ",", "\[Phi]2"}], "}"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "newVelocities", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newPositions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "+", "#2"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"positions", ",", "newVelocities"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "newPositions", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"lower", " ", "confinement"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newPositions", ",", "newVelocities"}], "}"}], "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#2", "<", "#1"}], ",", 
               RowBox[{"{", 
                RowBox[{"#1", ",", 
                 RowBox[{
                  RowBox[{"-", "0.5"}], "*", "#3"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"#2", ",", "#3"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"bndLo", ",", 
              RowBox[{
              "newPositions", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "newVelocities", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nparts"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"upper", " ", "confinement"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newPositions", ",", "newVelocities"}], "}"}], "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#2", ">", "#1"}], ",", 
               RowBox[{"{", 
                RowBox[{"#1", ",", 
                 RowBox[{
                  RowBox[{"-", "0.5"}], "*", "#3"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"#2", ",", "#3"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"bndUp", ",", 
              RowBox[{
              "newPositions", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "newVelocities", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nparts"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "newPositions", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "newVelocities", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newVals", "=", 
      RowBox[{"objFun", "/@", "newPositions"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "newPositions", ",", "newVelocities", ",", "bestPositions", ",", 
        "bestNeighbourPositions", ",", "newVals"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6242386464857903`*^9, 3.6242387661250772`*^9}, {
   3.6242388991333475`*^9, 3.6242389025415106`*^9}, {3.624239661776161*^9, 
   3.624239670895197*^9}, {3.624240558671401*^9, 3.6242406322779975`*^9}, {
   3.624240791609227*^9, 3.6242408730663238`*^9}, {3.62424109609704*^9, 
   3.6242410987239637`*^9}, {3.624241158087556*^9, 3.624241159537735*^9}, {
   3.624241252043536*^9, 3.6242412695081854`*^9}, {3.6242413995624046`*^9, 
   3.624241399798729*^9}, {3.6242414345444345`*^9, 3.624241454482692*^9}, {
   3.624241485885661*^9, 3.6242415844509673`*^9}, {3.6242416275627947`*^9, 
   3.624241866116769*^9}, {3.624241901107586*^9, 3.6242419150898495`*^9}, {
   3.6242425147345057`*^9, 3.6242426512915773`*^9}, 3.624242686575363*^9, {
   3.6242427284791927`*^9, 3.6242427833985047`*^9}, {3.624244297584709*^9, 
   3.6242442986257124`*^9}, {3.6242542488612595`*^9, 3.624254312330264*^9}, {
   3.624254343692216*^9, 3.6242544713401804`*^9}, {3.6242547366340513`*^9, 
   3.6242547368127627`*^9}, {3.624255015637741*^9, 3.6242550617446384`*^9}, {
   3.6242558470023613`*^9, 3.6242558805693617`*^9}, {3.624255922179244*^9, 
   3.624255924160669*^9}, {3.6242559622237153`*^9, 3.624255974709899*^9}, {
   3.6242562150577555`*^9, 3.6242562299911785`*^9}, {3.624256381781453*^9, 
   3.6242564079149466`*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "pso", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pso", "::", "usage"}], "=", 
   "\"\<pso[objFun_,nparts_Integer,bndLo_List,bndUp_List,niter_Integer:100,r_\
Integer:1]\nnparts: the number of particles\nbndLo: a list of the lower \
bounds, one for each dimension\nbndUp: a list of the upper bounds, one for \
each dimension\nniter: Number of iterations\nr: length of the toroidal \
neighbour scheme e.g. r=1 gives (i-1 mod nparts, i, i+1 mod nparts) as the \
neighbours of particle i\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "pso", "]"}], "=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"pso", "[", 
    RowBox[{
    "objFun_", ",", "nparts_Integer", ",", "bndLo_List", ",", "bndUp_List", 
     ",", 
     RowBox[{"niter_Integer:", "100"}], ",", 
     RowBox[{"r_Integer:", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "positions", ",", "velocities", ",", "neighbours", ",", "bestPositions",
        ",", "bestNeighbourPositions", ",", "vals", ",", "iterCnt", ",", 
       "globalBestIdx", ",", "globalBestPosition", ",", "globalBestValue"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "positions", ",", "velocities", ",", "neighbours", ",", 
         "bestPositions", ",", "bestNeighbourPositions", ",", "vals"}], "}"}],
        "=", 
       RowBox[{"initialiseParticles", "[", 
        RowBox[{
        "objFun", ",", "nparts", ",", "bndLo", ",", "bndUp", ",", "r"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"iterCnt", "=", "1"}], ",", 
        RowBox[{"iterCnt", "<", "niter"}], ",", 
        RowBox[{"iterCnt", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "positions", ",", "velocities", ",", "bestPositions", ",", 
           "bestNeighbourPositions", ",", "vals"}], "}"}], "=", 
         RowBox[{"psoStep", "[", 
          RowBox[{
          "objFun", ",", "bndLo", ",", "bndUp", ",", "positions", ",", 
           "velocities", ",", "neighbours", ",", "bestPositions", ",", 
           "bestNeighbourPositions", ",", "vals"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"globalBestIdx", "=", 
       RowBox[{"First", "@", 
        RowBox[{"Ordering", "[", 
         RowBox[{"bestPositions", ",", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"globalBestPosition", "=", 
       RowBox[{
       "bestPositions", "\[LeftDoubleBracket]", "globalBestIdx", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"globalBestValue", "=", 
       RowBox[{"objFun", "[", "globalBestPosition", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"globalBestValue", ",", "globalBestPosition"}], "}"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6242428071257753`*^9, 3.6242431388779144`*^9}, {
   3.6242432091320124`*^9, 3.6242432097872777`*^9}, {3.624254833756983*^9, 
   3.624254842112358*^9}, {3.6242548729362307`*^9, 3.6242549066370244`*^9}, {
   3.624255984059404*^9, 3.6242560135395384`*^9}, {3.6242560906578026`*^9, 
   3.62425610799745*^9}, {3.6242562472263336`*^9, 3.6242562533102508`*^9}, {
   3.6242569756263056`*^9, 3.624256983849844*^9}, {3.62651292327905*^9, 
   3.6265129340878677`*^9}, 3.630474096390218*^9, {3.6304743299326696`*^9, 
   3.6304743430107946`*^9}, {3.6304744294482946`*^9, 
   3.6304744992607946`*^9}, {3.6304751380264196`*^9, 
   3.6304751494014196`*^9}, {3.6304751819795446`*^9, 
   3.6304753585420446`*^9}, {3.6304754072295446`*^9, 
   3.6304754381357946`*^9}, {3.6304784792451696`*^9, 
   3.6304785591982946`*^9}, {3.6304786878545446`*^9, 
   3.6304786891201696`*^9}, {3.630486687212943*^9, 3.630486698916068*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{"PSO", ",", 
   RowBox[{"\"\<nparts\>\"", "\[Rule]", "32"}], ",", 
   RowBox[{"\"\<bndLo\>\"", "\[Rule]", 
    RowBox[{"-", "10"}]}], ",", 
   RowBox[{"\"\<bndUp\>\"", "\[Rule]", "10"}], ",", 
   RowBox[{"\"\<niter\>\"", "\[Rule]", "100"}], ",", 
   RowBox[{"\"\<r\>\"", "\[Rule]", "1"}], ",", 
   RowBox[{"\"\<RandomSeed\>\"", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6304794785420446`*^9, 3.6304797210264196`*^9}, {
  3.6304797809326696`*^9, 3.6304798059951696`*^9}, {3.6304810481357946`*^9, 
  3.6304810513389196`*^9}, {3.6305597116456833`*^9, 3.6305597155324025`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"nparts\"\>", "\[Rule]", "32"}], ",", 
   RowBox[{"\<\"bndLo\"\>", "\[Rule]", 
    RowBox[{"-", "10"}]}], ",", 
   RowBox[{"\<\"bndUp\"\>", "\[Rule]", "10"}], ",", 
   RowBox[{"\<\"niter\"\>", "\[Rule]", "100"}], ",", 
   RowBox[{"\<\"r\"\>", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6304795445107946`*^9, 3.6304795732920446`*^9}, {
   3.6304796079951696`*^9, 3.6304796486045446`*^9}, 3.6304796874014196`*^9, 
   3.6304797220107946`*^9, {3.6304797841826696`*^9, 3.6304798068545446`*^9}, 
   3.6304810528701696`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PSO", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PSO", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<nparts\>\"", "\[Rule]", "32"}], ",", 
     RowBox[{"\"\<bndLo\>\"", "\[Rule]", 
      RowBox[{"-", "10"}]}], ",", 
     RowBox[{"\"\<bndUp\>\"", "\[Rule]", "10"}], ",", 
     RowBox[{"\"\<niter\>\"", "\[Rule]", "100"}], ",", 
     RowBox[{"\"\<r\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<RandomSeed\>\"", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PSO", "[", 
   RowBox[{"objFun_", ",", "x_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "solution", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", 
      RowBox[{"OptionValue", "[", "\"\<RandomSeed\>\"", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"pso", "[", 
       RowBox[{"objFun", ",", "\[IndentingNewLine]", 
        RowBox[{"OptionValue", "[", "\"\<nparts\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<bndLo\>\"", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "x", "]"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<bndUp\>\"", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "x", "]"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OptionValue", "[", "\"\<niter\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OptionValue", "[", "\"\<r\>\"", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SeedRandom", "[", "]"}], ";", "\[IndentingNewLine]", 
     "solution"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6304787011826696`*^9, 3.6304789904326696`*^9}, {
  3.6304791249639196`*^9, 3.6304791270264196`*^9}, {3.6304853898887243`*^9, 
  3.6304854557168493`*^9}, {3.6304858621230993`*^9, 3.6304858647168493`*^9}, {
  3.630488053447318*^9, 3.630488069009818*^9}, {3.63055957875562*^9, 
  3.6305596563309174`*^9}, {3.632646566888197*^9, 3.632646590685072*^9}, {
  3.632646639638197*^9, 3.632646645450697*^9}, {3.632646724310072*^9, 
  3.632646772028822*^9}, {3.632646803685072*^9, 3.632646864794447*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataArray", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</import/\>\"", 
      "<>", "\"\<pso_dataArray3_invariant.tsv\>\""}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dataArray", "=", 
     RowBox[{"{", 
      RowBox[{"dataArray", ",", "dataArray"}], "}"}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6265075321952963`*^9, 3.626507541455045*^9}, 
   3.6265075880422645`*^9, {3.626507627832223*^9, 3.626507684104193*^9}, {
   3.626512157094885*^9, 3.6265121578487916`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["dataArray"], "Input",
 CellChangeTimes->{{3.6265121197036395`*^9, 3.626512122576969*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0.`", ",", "0.`", ",", "0.`", ",", "0.4808799999999991`", ",", 
             "0.`", ",", "4.7803204`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.090909094`", ",", "0.`", ",", "0.`", ",", 
             RowBox[{"-", "2.288517000000013`"}], ",", "11.463544`", ",", 
             "14.002619`"}], "}"}], ",", 
           TemplateBox[{"5119"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )], ",", 
           RowBox[{"{", 
            RowBox[{"0.`", ",", "2.`", ",", "0.`", ",", 
             RowBox[{"-", "4.46342599999997`"}], ",", "0.`", ",", "0.`"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", 
             RowBox[{"-", "3.6471049999999963`"}], ",", "1.19232395`", ",", 
             "2.9457033`"}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{82., {3., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{67., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{67., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 12, 23766713086453211061, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{78., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{78., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 12, 23766713086453211061, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{57., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{57., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 12, 23766713086453211061, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{99., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{99., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[12]]], "Output",
 CellChangeTimes->{{3.626512123176385*^9, 3.626512163012854*^9}, 
   3.6265126310619206`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"-", 
      RowBox[{"objective", "[", 
       RowBox[{"dataArray", ",", 
        RowBox[{"Sequence", "@@", "x"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6265121839112916`*^9, 3.6265122654243116`*^9}, {
  3.6265125658213773`*^9, 3.626512584120474*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"pso", "[", 
      RowBox[{"f1", ",", "32", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", "5", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"10.", ",", 
         RowBox[{"{", "5", "}"}]}], "]"}], ",", "100", ",", "8"}], "]"}]}], 
    ";", 
    RowBox[{
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "sol"}], ")"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.626513226424556*^9, 3.626513304808035*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.9333552999999996658`6.861543369482388", ",", 
   RowBox[{"{", 
    RowBox[{"3922", ",", 
     RowBox[{"{", 
      RowBox[{
      "6.49458672132123`", ",", "3.4910740760240895`", ",", "0.`", ",", "0.`",
        ",", "0.`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.626512640477313*^9, 3.6265129439600306`*^9, {3.626513285592156*^9, 
   3.626513312251846*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"objective", "[", 
  RowBox[{"dataArray", ",", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6265133573259325`*^9, 3.626513374253437*^9}}],

Cell[BoxData["3922"], "Output",
 CellChangeTimes->{3.6265133746310606`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{976, 556},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"10.0 for Microsoft Windows (32-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 346, 5, 86, "Section"],
Cell[CellGroupData[{
Cell[950, 31, 110, 1, 49, "Subsubsection"],
Cell[1063, 34, 272, 5, 63, "Text"],
Cell[1338, 41, 179, 4, 36, "Input"],
Cell[1520, 47, 148, 3, 36, "Input"],
Cell[1671, 52, 132, 2, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1840, 59, 92, 1, 59, "Subsection"],
Cell[1935, 62, 258, 5, 36, "Input"],
Cell[2196, 69, 1606, 39, 198, "Input"],
Cell[3805, 110, 2122, 43, 336, "Input"],
Cell[5930, 155, 5952, 160, 724, "Input",
 InitializationCell->True],
Cell[11885, 317, 11256, 290, 1056, "Input",
 InitializationCell->True],
Cell[23144, 609, 4088, 87, 632, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[27257, 700, 643, 12, 60, "Input"],
Cell[27903, 714, 589, 12, 36, "Output"]
}, Open  ]],
Cell[28507, 729, 2603, 59, 356, "Input",
 InitializationCell->True],
Cell[31113, 790, 661, 18, 83, "Input"],
Cell[CellGroupData[{
Cell[31799, 812, 103, 1, 36, "Input"],
Cell[31905, 815, 8687, 220, 158, "Output"]
}, Open  ]],
Cell[40607, 1038, 410, 11, 36, "Input"],
Cell[CellGroupData[{
Cell[41042, 1053, 690, 21, 83, "Input"],
Cell[41735, 1076, 420, 11, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42192, 1092, 251, 6, 36, "Input"],
Cell[42446, 1100, 75, 1, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
