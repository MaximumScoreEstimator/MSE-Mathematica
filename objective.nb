(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     30413,        789]
NotebookOptionsPosition[     25046,        648]
NotebookOutlinePosition[     25894,        678]
CellTagsIndexPosition[     25766,        672]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["objective.nb", "Section",
 CellChangeTimes->{{3.62600628385137*^9, 3.626006284835745*^9}, {
  3.6260709487170696`*^9, 3.6260709533480415`*^9}, {3.626096953477417*^9, 
  3.6260969551364455`*^9}, {3.6261707215015993`*^9, 3.6261707234205446`*^9}, {
  3.6261736078812375`*^9, 3.6261736107103395`*^9}, {3.6263372687397165`*^9, 
  3.6263372730053415`*^9}, {3.6263379196147165`*^9, 3.6263379214897165`*^9}, {
  3.6263385349740915`*^9, 3.6263385373022165`*^9}}],

Cell[CellGroupData[{

Cell["For the Developer", "Subsubsection",
 CellChangeTimes->{{3.5819225877880845`*^9, 3.581922592443351*^9}}],

Cell["\<\
AutoGeneratedPackage is an option for notebooks that specifies whether a \
package is automatically created when a notebook that contains initialization \
cells or groups is saved.\
\>", "Text",
 CellChangeTimes->{{3.5808982533077106`*^9, 3.580898259632072*^9}}],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816697178146343`*^9, 3.581669717815634*^9}}],

Cell[BoxData[
 RowBox[{"ClearSystemCache", "[", "]"}]], "Input",
 CellChangeTimes->{{3.581669726757145*^9, 3.5816697379287844`*^9}}],

Cell[BoxData[{
 RowBox[{"directory", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"\"\<mse.m\>\"", ",", 
   RowBox[{"Path", "\[Rule]", "directory"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6392064512024283`*^9, 3.6392064555015736`*^9}, {
  3.6392064862997465`*^9, 3.6392065233606443`*^9}, {3.6392250169707823`*^9, 
  3.6392250177207823`*^9}, {3.6535358489289207`*^9, 3.653535855296494*^9}, {
  3.709482620021003*^9, 3.70948262065952*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"bd2b8561-fc57-45e1-acd4-bd3623a84040"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Echo", "[", "\"\<Loaded objective.m\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.711434116821677*^9, 3.711434132168717*^9}, {
  3.711434316073223*^9, 3.711434320192101*^9}, {3.711435083526667*^9, 
  3.7114350860758677`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"24eb380a-f0f4-45f4-bf79-829601c81caa"],

Cell[BoxData["\<\"Loaded objective.m\"\>"], "Echo",
 CellChangeTimes->{
  3.7114350898857393`*^9},ExpressionUUID->"b960a39b-2ef7-4397-af8c-\
8509fe9ffcda"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global Variables", "Subsubsection",
 CellChangeTimes->{{3.657294915162808*^9, 3.6572949286907597`*^9}}],

Cell["coefficient1, objectivecounter, groupIDs", "Text",
 CellChangeTimes->{{3.6572949311068783`*^9, 3.657294990707904*^9}},
 Background->RGBColor[1, 1, 0]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define ",
 StyleBox["objective",
  FontWeight->"Bold"],
 " function"
}], "Subsection",
 CellChangeTimes->{
  3.6117411131376095`*^9, 3.611741233674157*^9, {3.611741277829609*^9, 
   3.6117412916970325`*^9}, {3.611912880528715*^9, 3.611912891202575*^9}, {
   3.6119140905750036`*^9, 3.611914092263646*^9}, {3.611918058468073*^9, 
   3.611918059112929*^9}, 3.6119214516902895`*^9, {3.611922547153042*^9, 
   3.6119225664012885`*^9}, {3.611923019509875*^9, 3.611923047002883*^9}, {
   3.6119461198179855`*^9, 3.611946142230812*^9}},
 Background->RGBColor[0., 1., 0.]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "coefficient1", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coefficient1", "::", "usage"}], "=", 
   "\"\<To normalize the payoff function, we set the first coefficient to \
either 1 or -1 coefficient1=1 (default) or coefficient=-1\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coefficient1", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6348045319661803`*^9, 3.6348046795317984`*^9}, {
   3.6348050704377794`*^9, 3.634805095930673*^9}, {3.634805134993164*^9, 
   3.6348051402080126`*^9}, 3.634807707833432*^9, 3.6348077515375896`*^9, {
   3.69705190032231*^9, 3.697051908355475*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "                             ", 
   RowBox[{"Objective", " ", "function"}], "                                ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "objective", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"objective", "::", "usage"}], "=", 
     "\"\<objective[dataArray,x1,x2,...,xn] defines the objective function to \
maximize the number of satisfied inequalities. An inequality is satisfied \
when the left side is weakly greater than the right side (>=).\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"objective", "[", 
      RowBox[{"dataArray_", ",", 
       RowBox[{"b__", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"(*", 
      RowBox[{
      "Defining", " ", "as", " ", "a", " ", "pure", " ", "function", " ", 
       "may", " ", "speed", " ", "this", " ", "up"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"++", "objectivecounter"}], ";", 
       RowBox[{"Total", "@", 
        RowBox[{"UnitStep", "@", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"http", ":"}], "//", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
              "a"}], "/", "9673"}], "/", "7966"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{"dataArray", ".", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"{", "b", "}"}], ",", 
             RowBox[{"N", "[", "coefficient1", "]"}]}], "]"}]}], ")"}]}]}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Information", "[", 
    RowBox[{"objective", ",", 
     RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6119461534381866`*^9, 3.611946160401201*^9}, {
   3.6119467387989974`*^9, 3.611946740545967*^9}, {3.626508107146835*^9, 
   3.626508133019354*^9}, {3.6265087901887927`*^9, 3.626508793334559*^9}, {
   3.6265091161831255`*^9, 3.6265091164549417`*^9}, {3.626510634193203*^9, 
   3.6265106375535545`*^9}, {3.6265111192301626`*^9, 
   3.6265111255032625`*^9}, {3.6265112180173492`*^9, 
   3.6265112338491173`*^9}, {3.626511337063216*^9, 3.62651134568958*^9}, 
   3.6265114223543863`*^9, {3.6305686709732256`*^9, 3.6305686814888506`*^9}, 
   3.6305687184576006`*^9, {3.6305688868482256`*^9, 3.6305689007076006`*^9}, {
   3.6305693041919756`*^9, 3.6305693389576006`*^9}, {3.630588109735944*^9, 
   3.630588154829694*^9}, {3.630588394314069*^9, 3.630588394485944*^9}, {
   3.6327421916167965`*^9, 3.632742199605443*^9}, {3.6327422484795504`*^9, 
   3.632742270359433*^9}, {3.632742322352026*^9, 3.632742497809472*^9}, {
   3.633706086276355*^9, 3.63370609038573*^9}, 3.63370624216698*^9, {
   3.6348045616026797`*^9, 3.6348045727360115`*^9}, {3.659677952759111*^9, 
   3.6596779566388903`*^9}, 3.6970520374436893`*^9, {3.7114350939707623`*^9, 
   3.711435109810225*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"8525f615-5bbf-429c-89f6-45e28da4b2f9"],

Cell[BoxData[
 StyleBox["\<\"objective[dataArray,x1,x2,...,xn] defines the objective \
function to maximize the number of satisfied inequalities. An inequality is \
satisfied when the left side is weakly greater than the right side (>=).\"\>",
   "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.7114351110993967`*^9},
 CellTags->
  "Info53711445910-1408831",ExpressionUUID->"98207242-da7a-43f5-8e33-\
9ca2c8db662d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["experimentation with more versions", "Subsection",
 CellChangeTimes->{{3.71143516476377*^9, 
  3.711435176616164*^9}},ExpressionUUID->"fb91147d-babc-4ca9-91bc-\
654afb8b5c14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "                             ", 
   RowBox[{"Objective", " ", "function", "  ", "2"}], 
   "                             ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "objective2", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"objective2", "[", 
     RowBox[{"dataArray_", ",", 
      RowBox[{"b__", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", ">", "0"}], ",", "1", ",", "0"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"dataArray", ".", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"{", "b", "}"}], ",", "1"}], "]"}]}], ")"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6119461534381866`*^9, 3.611946160401201*^9}, {
   3.6119467387989974`*^9, 3.611946740545967*^9}, {3.622785699509333*^9, 
   3.6227857009937077`*^9}, 3.622785869884333*^9, {3.622786036448571*^9, 
   3.622786064698571*^9}, {3.622787883417321*^9, 3.622787889323571*^9}, {
   3.622787925729821*^9, 3.622787943604821*^9}, {3.622788225870446*^9, 
   3.622788228761071*^9}, {3.6227940865890017`*^9, 3.6227940902452517`*^9}, {
   3.6265114100474763`*^9, 3.6265114138309183`*^9}}],

Cell[CellGroupData[{

Cell["test 1 (numeric performance)", "Subsubsection",
 CellChangeTimes->{{3.633704005963855*^9, 3.633704007588855*^9}, {
  3.63370523585448*^9, 3.633705242182605*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"tmpdataArray", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}], ",", 
     RowBox[{"{", "1000000", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "]"}]}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Developer`PackedArrayQ", "[", "tmpdataArray", "]"}], ",", 
    RowBox[{"Length", "@", "tmpdataArray"}], ",", 
    RowBox[{"ByteCount", "@", "tmpdataArray"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6305711099576006`*^9, 3.6305711372232256`*^9}, {
  3.6305711688013506`*^9, 3.6305711809576006`*^9}, {3.6305712135669756`*^9, 
  3.6305712297701006`*^9}, {3.6305720088013506`*^9, 3.6305720327857256`*^9}, {
  3.6305731474195147`*^9, 3.6305731585913897`*^9}, {3.630582446030414*^9, 
  3.6305824489603567`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "1000000", ",", "40000104"}], "}"}]], "Output",
 CellChangeTimes->{3.6305711895357256`*^9, 3.6305712313326006`*^9, 
  3.6305717351138506`*^9, 3.6305720348169756`*^9, 3.6305823928768325`*^9, 
  3.6305824519124036`*^9, 3.630582639491252*^9, 3.63370158130641*^9, 
  3.6337017871430087`*^9, 3.63370476444823*^9, 3.63370609876073*^9, 
  3.633706255057605*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Total", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"objective", "[", 
      RowBox[{"tmpdataArray", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "4"}], "]"}]}]}], 
      "]"}], ",", 
     RowBox[{"{", "1000", "}"}]}], "]"}]}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.6305706925533037`*^9, 3.6305707315376787`*^9}, {
   3.6305713176763506`*^9, 3.6305713333794756`*^9}, {3.6305717805201006`*^9, 
   3.6305717998169756`*^9}, {3.6305721292544756`*^9, 
   3.6305721407232256`*^9}, {3.6305731627476397`*^9, 
   3.6305731635913897`*^9}, {3.6305824032471743`*^9, 
   3.6305824039615173`*^9}, {3.6305824598049817`*^9, 3.630582476199513*^9}, {
   3.63370169876346*^9, 3.633701711020855*^9}, 3.633701764436138*^9, {
   3.63370625029198*^9, 3.633706251713855*^9}, 3.63370629944823*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"21.828125`7.359616345409919", ",", "499987592"}], "}"}]], "Output",
 CellChangeTimes->{3.633701810474914*^9, 3.63370623491698*^9, 
  3.633706266026355*^9, 3.633706322026355*^9}]
}, Open  ]],

Cell[BoxData["objectivecounter"], "Input",
 CellChangeTimes->{{3.6337018929607935`*^9, 3.6337018959805427`*^9}}],

Cell["\<\
20 sec for :
1000 multiplications of a 5dim vector with a 1Million X 5 matrix = \
10*1000000*1000 = 10^10 around optimum!\
\>", "Text",
 CellChangeTimes->{{3.633701821919057*^9, 3.633701870260741*^9}, {
  3.6337026368832498`*^9, 3.6337026447787576`*^9}, {3.6337026750691233`*^9, 
  3.6337027283406963`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "tmpdataArray", "]"}]], "Input",
 CellChangeTimes->{{3.6305826215072527`*^9, 3.6305826305898848`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["test 2 (counting operations in abstract dataArray)", "Subsubsection",
 CellChangeTimes->{{3.63370401216698*^9, 3.633704018057605*^9}, {
  3.63370521419823*^9, 3.63370523163573*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"objectivedebug", "[", 
    RowBox[{"dataArray_", ",", "b__"}], "]"}], ":=", 
   RowBox[{"Total", "@", 
    RowBox[{"(", 
     RowBox[{"dataArray", ".", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"{", "b", "}"}], ",", "1."}], "]"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.63370450422948*^9, 3.63370451154198*^9}, {
  3.633704545838855*^9, 3.63370455772948*^9}, {3.63370469479198*^9, 
  3.63370469713573*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmpdataArray", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"\"\<l\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<c\>\"", "<>", 
       RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "1000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6305711099576006`*^9, 3.6305711372232256`*^9}, {
   3.6305711688013506`*^9, 3.6305711809576006`*^9}, {3.6305712135669756`*^9, 
   3.6305712297701006`*^9}, {3.6305720088013506`*^9, 
   3.6305720327857256`*^9}, {3.6305731474195147`*^9, 
   3.6305731585913897`*^9}, {3.630582446030414*^9, 3.6305824489603567`*^9}, {
   3.633704072588855*^9, 3.633704274088855*^9}, {3.633704340026355*^9, 
   3.63370436654198*^9}, {3.633705176401355*^9, 3.63370520182323*^9}, 
   3.63370525441698*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"objectivedebug", "[", 
    RowBox[{"tmpdataArray", ",", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"Cx", "[", "4", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.63370444704198*^9, 3.633704459745105*^9}, {
   3.63370452657323*^9, 3.633704527401355*^9}, 3.633704568620105*^9, {
   3.63370466066698*^9, 3.63370470191698*^9}}],

Cell["http://mathematica.stackexchange.com/a/25762/7966", "Text",
 CellChangeTimes->{3.633705117057605*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "opCount", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"opCount", "[", 
    RowBox[{"h_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Hold", "[", "expr", "]"}], ",", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"h", "[", 
         RowBox[{"args", ":", 
          RowBox[{"_", "~", "Repeated", "~", 
           RowBox[{"{", 
            RowBox[{"2", ",", "Infinity"}], "}"}]}]}], "]"}]}], 
       "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Hold", "[", "args", "]"}]}], "-", "1"}]}], ",", 
      RowBox[{"-", "2"}]}], "]"}], "//", "Total"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"opCount", ",", "HoldRest"}], "]"}], ";"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "When", " ", "we", " ", "have", " ", "numeric", " ", "expressions"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.633704632526355*^9, 3.633704632526355*^9}, {
  3.63370499704198*^9, 3.63370500457323*^9}, {3.633705501963855*^9, 
  3.63370551972948*^9}, {3.63370556513573*^9, 3.633705570401355*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opCount", "[", 
  RowBox[{"Times", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.633705020682605*^9, 3.63370502816698*^9}}],

Cell[BoxData["5000"], "Output",
 CellChangeTimes->{3.633705028588855*^9, 3.633705207557605*^9, 
  3.63370525879198*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opCount", "[", 
  RowBox[{"Plus", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.63370501135448*^9, 3.63370501691698*^9}}],

Cell[BoxData["4999"], "Output",
 CellChangeTimes->{3.633705017307605*^9, 3.63370520826073*^9, 
  3.63370525941698*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"objectivedebug", ",", "tmpdataArray", ",", "t", ",", "opCount"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6305826215072527`*^9, 3.6305826305898848`*^9}, {
  3.633705085495105*^9, 3.63370510094823*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Verbose version", "Subsection",
 CellChangeTimes->{{3.63370399413573*^9, 3.633703997807605*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "                           ", 
   RowBox[{"Verbose", " ", "Objective", " ", "function"}], 
   "                          ", "*)"}], 
  RowBox[{"(*", "         ", 
   RowBox[{
   "to", " ", "calculate", " ", "number", " ", "of", " ", "satisfied", " ", 
    "inequalities", " ", "per", " ", "market"}], "              ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "objectiveV", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"objectiveV", "::", "usage"}], "=", 
     "\"\<objectiveV[dataArray,x1,x2,...,xn] is the verbose version of \
objective routine. It also uses groupIDs produced by CdataArray routine. It \
returns more information about how many inequalities are satisfied for each \
market. It is obviously slower than the plain objective and it is used as the \
final step after the maximization process.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"objectiveV", "[", 
      RowBox[{"dataArray_", ",", 
       RowBox[{"b__", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dataarray", ",", "groupids", ",", "satisfiedineqs", ",", 
         "totalineqs", ",", "stats"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dataarray", "=", 
         RowBox[{"dataArray", ".", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"N", "[", "coefficient1", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"groupids", "=", 
         RowBox[{"Flatten", "@", 
          StyleBox["groupIDs",
           Background->RGBColor[1, 1, 0]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"totalineqs", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Tally", "@", 
            StyleBox["groupIDs",
             Background->RGBColor[1, 1, 0]]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"satisfiedineqs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"UnitStep", "[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"GatherBy", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"dataarray", ",", "groupids"}], "}"}], "]"}], ",", 
               "Last"}], "]"}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], ")"}]}]}], 
        ";", "\n", "\[IndentingNewLine]", 
        RowBox[{"stats", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Insert", ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "@", 
                RowBox[{"Length", "@", "satisfiedineqs"}]}], ",", 
               "satisfiedineqs", ",", "totalineqs", ",", 
               RowBox[{"Chop", "@", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"100.", " ", 
                   RowBox[{"satisfiedineqs", "/", "totalineqs"}]}], ",", 
                  "1"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Market no\>\"", ",", "\"\<Satisfied\>\"", ",", 
               "\"\<Total\>\"", ",", "\"\<Percentage %\>\""}], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"1", ",", 
               RowBox[{"{", "4", "}"}]}], "]"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Information", "[", 
    RowBox[{"objectiveV", ",", 
     RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6265113948287263`*^9, 3.626511397081656*^9}, {
  3.6327422043828707`*^9, 3.632742224308652*^9}, {3.632742509644433*^9, 
  3.632742622866528*^9}, {3.6348051576266675`*^9, 3.6348051620691643`*^9}, {
  3.6527735135251427`*^9, 3.652773610325068*^9}, {3.652773653864812*^9, 
  3.65277365729708*^9}, {3.652774786232513*^9, 3.652774789104068*^9}, {
  3.652774857858574*^9, 3.652774883999564*^9}, {3.652775295800205*^9, 
  3.652775315408689*^9}, {3.652775354641181*^9, 3.652775362047738*^9}, {
  3.6527755988434*^9, 3.652775605353396*^9}, {3.65734328400035*^9, 
  3.6573433379449587`*^9}, {3.6573433838255167`*^9, 3.65734339015668*^9}, {
  3.6573434296259317`*^9, 3.65734343227414*^9}, {3.657345578900362*^9, 
  3.657345581620027*^9}, {3.7114351460002213`*^9, 3.7114351579081507`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"1ce1b3fb-1055-4bd5-bedd-3f874b5da89c"],

Cell[BoxData[
 StyleBox["\<\"objectiveV[dataArray,x1,x2,...,xn] is the verbose version of \
objective routine. It also uses groupIDs produced by CdataArray routine. It \
returns more information about how many inequalities are satisfied for each \
market. It is obviously slower than the plain objective and it is used as the \
final step after the maximization process.\"\>", "MSG"]], "Print", \
"PrintUsage",
 CellChangeTimes->{3.711435208185113*^9},
 CellTags->
  "Info93711446008-1408831",ExpressionUUID->"0c87741d-0f9f-4319-8c26-\
787880666016"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{988, 791},
WindowMargins->{{361, Automatic}, {Automatic, 215}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info53711445910-1408831"->{
  Cell[8590, 219, 420, 8, 
  53, "Print", "ExpressionUUID" -> "98207242-da7a-43f5-8e33-9ca2c8db662d",
   CellTags->"Info53711445910-1408831"]},
 "Info93711446008-1408831"->{
  Cell[24456, 633, 550, 10, 
  74, "Print", "ExpressionUUID" -> "0c87741d-0f9f-4319-8c26-787880666016",
   CellTags->"Info93711446008-1408831"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info53711445910-1408831", 25423, 661},
 {"Info93711446008-1408831", 25597, 665}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 459, 6, 82, "Section", "ExpressionUUID" -> \
"c5342bb2-6f2f-496c-b083-c9f8a4549277"],
Cell[CellGroupData[{
Cell[1063, 32, 110, 1, 45, "Subsubsection", "ExpressionUUID" -> \
"422573a1-39c5-436c-b8c0-40d552c9ecc7"],
Cell[1176, 35, 272, 5, 65, "Text", "ExpressionUUID" -> \
"90a24745-95a6-4758-9ce0-61dbd1739112"],
Cell[1451, 42, 179, 4, 46, "Input", "ExpressionUUID" -> \
"6079789c-01e3-4dbe-98af-dfec9696cb0e"],
Cell[1633, 48, 148, 3, 41, "Input", "ExpressionUUID" -> \
"c987a682-810c-4bf5-a473-d18994e36856"],
Cell[1784, 53, 132, 2, 41, "Input", "ExpressionUUID" -> \
"8c4f07c9-338d-42f9-80d7-f5e725f87212"],
Cell[1919, 57, 591, 11, 94, "Input", "ExpressionUUID" -> \
"bd2b8561-fc57-45e1-acd4-bd3623a84040"],
Cell[CellGroupData[{
Cell[2535, 72, 389, 8, 66, "Input", "ExpressionUUID" -> \
"24eb380a-f0f4-45f4-bf79-829601c81caa",
 InitializationCell->True],
Cell[2927, 82, 155, 3, 32, "Echo", "ExpressionUUID" -> \
"b960a39b-2ef7-4397-af8c-8509fe9ffcda"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3131, 91, 109, 1, 45, "Subsubsection", "ExpressionUUID" -> \
"e1dda8d1-9fcf-4fe9-9c06-2517abc3815a"],
Cell[3243, 94, 156, 2, 60, "Text", "ExpressionUUID" -> \
"2c3e0623-9060-4d43-a072-bf2dceb41670"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3436, 101, 582, 13, 76, "Subsection", "ExpressionUUID" -> \
"ea2d5931-12dc-43bd-8329-60c8f354b834"],
Cell[4021, 116, 755, 17, 150, "Input", "ExpressionUUID" -> \
"27d553d4-5aae-4c7a-baff-3980357870a1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4801, 137, 3786, 80, 365, "Input", "ExpressionUUID" -> \
"8525f615-5bbf-429c-89f6-45e28da4b2f9",
 InitializationCell->True],
Cell[8590, 219, 420, 8, 53, "Print", "ExpressionUUID" -> \
"98207242-da7a-43f5-8e33-9ca2c8db662d",
 CellTags->"Info53711445910-1408831"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9059, 233, 181, 3, 56, "Subsection", "ExpressionUUID" -> \
"fb91147d-babc-4ca9-91bc-654afb8b5c14"],
Cell[9243, 238, 1921, 43, 163, "Input", "ExpressionUUID" -> \
"4b34071a-ea4c-4f32-84bf-5f05e8dad5f6"],
Cell[CellGroupData[{
Cell[11189, 285, 167, 2, 45, "Subsubsection", "ExpressionUUID" -> \
"b3b59000-10f7-4d85-820e-fee2c5785789"],
Cell[CellGroupData[{
Cell[11381, 291, 864, 20, 70, "Input", "ExpressionUUID" -> \
"1dc92989-1e22-488a-bd21-6dc3ec37f86c"],
Cell[12248, 313, 406, 7, 41, "Output", "ExpressionUUID" -> \
"2a0ef2d2-0378-4abd-bff0-77cd893f4378"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12691, 325, 992, 22, 46, "Input", "ExpressionUUID" -> \
"f340f8f5-03dc-43d9-8c56-cb0c2a1bcd1b"],
Cell[13686, 349, 217, 4, 41, "Output", "ExpressionUUID" -> \
"d777467f-ae91-4ada-9347-deca1b4e4f84"]
}, Open  ]],
Cell[13918, 356, 112, 1, 41, "Input", "ExpressionUUID" -> \
"1f4448c4-9476-4399-bfd0-63025d6c4dcf"],
Cell[14033, 359, 317, 7, 65, "Text", "ExpressionUUID" -> \
"8dd91665-13ac-4478-88fc-a476205a0295"],
Cell[14353, 368, 142, 2, 41, "Input", "ExpressionUUID" -> \
"fb14342d-dec8-4389-8bb9-978caa25bd22"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14532, 375, 187, 2, 45, "Subsubsection", "ExpressionUUID" -> \
"5a625547-63a0-4a5b-ab8f-8f24f010ded2"],
Cell[14722, 379, 491, 14, 43, "Input", "ExpressionUUID" -> \
"40416805-29e1-4d42-bf0d-c9dcdff648af"],
Cell[15216, 395, 950, 20, 46, "Input", "ExpressionUUID" -> \
"80dafd2a-c831-4677-a6f9-617914cb1d7d"],
Cell[16169, 417, 396, 9, 41, "Input", "ExpressionUUID" -> \
"fa52c1d9-6bfe-47a2-9762-60aef8bfbc94"],
Cell[16568, 428, 107, 1, 40, "Text", "ExpressionUUID" -> \
"e80e2b6c-1f31-4ade-95cc-62911c59846d"],
Cell[16678, 431, 1208, 34, 130, "Input", "ExpressionUUID" -> \
"3de1b105-f204-476e-85ad-856e7cb5ba94"],
Cell[CellGroupData[{
Cell[17911, 469, 152, 3, 46, "Input", "ExpressionUUID" -> \
"9aec1617-2b55-4024-a8bd-3c26a83cde3b"],
Cell[18066, 474, 119, 2, 41, "Output", "ExpressionUUID" -> \
"e0f6c07d-e857-48e2-809f-fc83bf09d9ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18222, 481, 150, 3, 41, "Input", "ExpressionUUID" -> \
"83d8fe16-1684-4286-b659-3e5f98c46788"],
Cell[18375, 486, 118, 2, 41, "Output", "ExpressionUUID" -> \
"3c3ae5a2-3228-4847-928d-db8d7d8c1d3a"]
}, Open  ]],
Cell[18508, 491, 255, 5, 46, "Input", "ExpressionUUID" -> \
"a6ce331f-03c9-46b3-9776-1619b8d0f355"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[18812, 502, 102, 1, 45, "Subsection", "ExpressionUUID" -> \
"c30aa862-ac89-47a4-b210-b7cce5f81272"],
Cell[CellGroupData[{
Cell[18939, 507, 5514, 124, 662, "Input", "ExpressionUUID" -> \
"1ce1b3fb-1055-4bd5-bedd-3f874b5da89c",
 InitializationCell->True],
Cell[24456, 633, 550, 10, 74, "Print", "ExpressionUUID" -> \
"0c87741d-0f9f-4319-8c26-787880666016",
 CellTags->"Info93711446008-1408831"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

