(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    117335,       2977]
NotebookOptionsPosition[    104847,       2663]
NotebookOutlinePosition[    105934,       2698]
CellTagsIndexPosition[    105755,       2691]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["matching.nb", "Section",
 CellChangeTimes->{{3.62600628385137*^9, 3.626006284835745*^9}, {
  3.6260709487170696`*^9, 3.6260709533480415`*^9}, {3.626096953477417*^9, 
  3.6260969551364455`*^9}, {3.6261707215015993`*^9, 3.6261707234205446`*^9}}],

Cell[CellGroupData[{

Cell["For the Developer", "Subsubsection",
 CellChangeTimes->{{3.5819225877880845`*^9, 3.581922592443351*^9}}],

Cell["\<\
AutoGeneratedPackage is an option for notebooks that specifies whether a \
package is automatically created when a notebook that contains initialization \
cells or groups is saved.\
\>", "Text",
 CellChangeTimes->{{3.5808982533077106`*^9, 3.580898259632072*^9}}],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816697178146343`*^9, 3.581669717815634*^9}}],

Cell[BoxData[
 RowBox[{"ClearSystemCache", "[", "]"}]], "Input",
 CellChangeTimes->{{3.581669726757145*^9, 
  3.5816697379287844`*^9}},ExpressionUUID->"01eea030-8470-45b9-9500-\
c3aaf9d23462"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"directory", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.6392064512024283`*^9, 3.6392064555015736`*^9}, {
  3.6392064862997465`*^9, 3.6392065233606443`*^9}, {3.6392250169707823`*^9, 
  3.6392250177207823`*^9}, {3.6535358489289207`*^9, 
  3.653535855296494*^9}},ExpressionUUID->"4d3021ef-1422-4ee8-bcd9-\
abdb45eee057"],

Cell[BoxData["\<\"/home/tchr/Projects/Mathematica/MSE-Mathematica/\"\>"], \
"Output",
 CellChangeTimes->{3.7092029481919518`*^9, 
  3.709203513358639*^9},ExpressionUUID->"90819378-cf01-4a3f-b9d6-\
ec2760c38899"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"\"\<mse.m\>\"", ",", 
   RowBox[{"Path", "\[Rule]", "directory"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.653535866321363*^9},ExpressionUUID->"2ac63eb2-db17-417a-8b1f-\
6d22c370239a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"190878600", ",", "153953696", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.709202957040566*^9, 
  3.709203515033618*^9},ExpressionUUID->"e861d8a5-28cb-4e84-bc8d-\
05721ca87fae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["generateAssignmentMatrix[payoffs,quotaU,quotaD]", "Subsection",
 CellChangeTimes->{{3.626169503603243*^9, 3.62616950426756*^9}, 
   3.6261707398111696`*^9, 3.6263308937397165`*^9}],

Cell["\<\
generateAssignmentMatrix - Generates the optimal assignment of matches from \
the given matrix of payoffs for each match. 
\t\t\t\tIn an assignment matrix, each entry (i,j) is 1 if i and j are matched \
and 0 otherwise. 
\t\t\t\t\t
\tParameters:
\t\tpayoffs - A list of matrices (one for each market) where the (i,j)th \
element is
\t\t\t  the total production from matching i and j. 
\t\tquotaU - Maximum number of partners each upstream agent can have. Default \
= 1. 
\t\tquotaD - Maximum number of partners each downstream agent can have. \
Default = 1. 
\t\t
\t\tquotaU and (or) quotaD can be lists of specific quotas.\
\>", "Text",
 CellChangeTimes->{{3.611658004382143*^9, 3.6116580497034025`*^9}, {
  3.611923247193398*^9, 3.6119232502275777`*^9}, {3.642293485630185*^9, 
  3.642293511749206*^9}, {3.687875948455463*^9, 3.687875948552136*^9}},
 Background->RGBColor[1, 0.9, 0.8]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "generateAssignmentMatrix", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateAssignmentMatrix", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"linearProgrammingOptions", "\[Rule]", "Null"}], ",", 
     RowBox[{"rationalizeResult", "\[Rule]", "True"}], ",", 
     RowBox[{"domain", "\[Rule]", "Integers"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateAssignmentMatrix", "::", "usage"}], "=", 
   "\"\<generateAssignmentMatrix[payoffs,quotaU,quotaD], generates the \
optimal assignment of matches from the given matrix of payoffs for each \
match. The optimal assignment is the one that maximizes the total payoff \
(i.e. the sum of all payoffs) in a market. In an assignment matrix, each \
entry (i,j) is 1 if i and j are matched and 0 otherwise. The quota can be a \
number (the same for all streams) or a list that sets a specific quota per \
agent.\nNotice that the quota is max number of matches per agent ( so in the \
data the real number of matches could be lower than the max).\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateAssignmentMatrix", "[", 
    RowBox[{"payoffs_", ",", 
     RowBox[{"quotaU_:", "1"}], ",", 
     RowBox[{"quotaD_:", "1"}], ",", 
     RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "realorint", ",", "rationalize", ",", "lpOptions", ",", "numU", ",", 
       "numD", ",", "m1", ",", "m2", ",", "m3", ",", "m", ",", "b", ",", 
       "matchMatrix", ",", "result"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"realorint", ",", "rationalize", ",", "lpOptions"}], "}"}], 
       "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "domain", ",", "rationalizeResult", ",", 
          "linearProgrammingOptions"}], "}"}], "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"options", ",", 
           RowBox[{"Options", "[", "generateAssignmentMatrix", "]"}]}], "}"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numU", ",", "numD"}], "}"}], "=", 
       RowBox[{"Dimensions", "[", "payoffs", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"In", " ", "this", " ", "function"}], ",", 
        RowBox[{
        "there", " ", "are", " ", "two", " ", "sides", " ", "to", " ", "the", 
         " ", "market"}], ",", 
        RowBox[{"U", " ", 
         RowBox[{"(", "pstream", ")"}], " ", "and", " ", "D", " ", 
         RowBox[{
          RowBox[{"(", "ownstream", ")"}], ".", "i"}], " ", "will", " ", 
         "index", " ", "upstream", " ", "firms", " ", "and", " ", "j", " ", 
         "will", " ", "index", " ", "downstream", " ", 
         RowBox[{"firms", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "m1", " ", "is", " ", "the", " ", "first", " ", "third", " ", "of", 
         " ", "the", " ", "constraint", " ", 
         RowBox[{"matrix", ".", "It"}], " ", "represents", " ", "the", " ", 
         RowBox[{"constraint", "\\", "sum"}], 
         RowBox[{"{", 
          RowBox[{"x_", " ", 
           RowBox[{"{", "ij", "}"}]}], "}"}], "_", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", "=", "1"}], "}"}], "^", "n"}]}], "\[LessEqual]", 
        RowBox[{"quotaD", " ", "for", " ", "all", " ", "j"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"m1", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"Outer", "[", 
          RowBox[{"Times", ",", 
           RowBox[{"SparseArray", "[", 
            RowBox[{"IdentityMatrix", "[", "numU", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"1", ",", 
              RowBox[{"{", "numD", "}"}]}], "]"}], "}"}]}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "m2", " ", "is", " ", "the", " ", "second", " ", "third", " ", "of", 
         " ", "the", " ", "constraint", " ", 
         RowBox[{"matrix", ".", "It"}], " ", "represents", " ", "the", " ", 
         RowBox[{"constraint", "\\", "sum"}], 
         RowBox[{"{", 
          RowBox[{"x_", " ", 
           RowBox[{"{", "ij", "}"}]}], "}"}], "_", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j", "=", "1"}], "}"}], "^", "n"}]}], "\[LessEqual]", 
        RowBox[{"quotaU", " ", "for", " ", "all", " ", "i"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"m2", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"Outer", "[", 
          RowBox[{"Times", ",", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"1", ",", 
              RowBox[{"{", "numU", "}"}]}], "]"}], "}"}], ",", 
           RowBox[{"SparseArray", "[", 
            RowBox[{"IdentityMatrix", "[", "numD", "]"}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "m3", " ", "is", " ", "the", " ", "last", " ", "third", " ", "of", " ",
         "the", " ", "constraint", " ", 
        RowBox[{"matrix", ".", "It"}], " ", "represents", " ", "the", " ", 
        "constraint", " ", "that", " ", "each", " ", "pair", " ", "of", " ", 
        "people", " ", "can", " ", "only", " ", "match", " ", "with", " ", 
        "each", " ", "other", " ", 
        RowBox[{"once", "."}]}], "*)"}], 
      RowBox[{"m3", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"numU", "*", "numD"}], ",", 
           RowBox[{"numU", "*", "numD"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "m1", "}"}], ",", 
           RowBox[{"{", "m2", "}"}], ",", 
           RowBox[{"{", "m3", "}"}]}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "@", "quotaU"}], ",", "quotaU", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"quotaU", ",", 
             RowBox[{"{", "numU", "}"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "@", "quotaD"}], ",", "quotaD", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"quotaD", ",", 
             RowBox[{"{", "numD", "}"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"numU", "*", "numD"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Remember", ":", 
         RowBox[{
         "linear", " ", "programming", " ", "will", " ", "minimize"}]}], ",", 
        RowBox[{
        "so", " ", "we", " ", "need", " ", "to", " ", "negate", " ", "the", 
         " ", "\"\<c\>\"", " ", 
         RowBox[{"vector", ".", "Similarly"}]}], ",", 
        RowBox[{
         RowBox[{
         "since", " ", "the", " ", "constraint", " ", "is", " ", "taken", " ",
           "to", " ", "be", " ", 
          RowBox[{"m", ".", "x"}]}], "\[GreaterEqual]", "b"}], ",", 
        RowBox[{
        "we", " ", "need", " ", "to", " ", "negate", " ", "m", " ", "and", 
         " ", "b", " ", "as", " ", 
         RowBox[{"well", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"lpOptions", "\[NotEqual]", "Null"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"matchMatrix", "=", 
         RowBox[{"LinearProgramming", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Flatten", "[", "payoffs", "]"}]}], ",", 
           RowBox[{"-", "m"}], ",", 
           RowBox[{"-", "b"}], ",", "lpOptions", ",", "realorint"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"matchMatrix", "=", 
         RowBox[{"LinearProgramming", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Flatten", "[", "payoffs", "]"}]}], ",", 
           RowBox[{"-", "m"}], ",", 
           RowBox[{"-", "b"}], ",", "0", ",", "realorint"}], "]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"matchMatrix", ",", "numD"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"rationalize", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Rationalize", "[", 
            RowBox[{"#", ",", ".01"}], "]"}], "&"}], ",", "result", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6116580777335625`*^9, 3.611658154281042*^9}, {
  3.6116581919628253`*^9, 3.61165826679718*^9}, {3.6116590577307205`*^9, 
  3.6116590805779696`*^9}, {3.611659119697054*^9, 3.611659120615999*^9}, {
  3.6116593314820538`*^9, 3.61165937656909*^9}, {3.611659480903691*^9, 
  3.611659578482917*^9}, {3.611659608930728*^9, 3.611659619544986*^9}, {
  3.6327387424390244`*^9, 3.632738769770079*^9}, {3.632738816189351*^9, 
  3.6327388352926674`*^9}, {3.642292975360422*^9, 3.642293080458453*^9}, {
  3.642293386011127*^9, 3.642293449637931*^9}, {3.642310160774971*^9, 
  3.642310175623087*^9}, {3.6970478390739317`*^9, 3.697047864768412*^9}, {
  3.7012573028474207`*^9, 3.701257347069387*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell["Unit testing", "Subsubsection",
 CellChangeTimes->{{3.642294105795484*^9, 3.6422941255956783`*^9}, {
  3.642294430670465*^9, 3.642294433638226*^9}, {3.642294476574922*^9, 
  3.642294477301858*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<TU*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.642294218365328*^9, 3.642294223744439*^9}, {
  3.6422942686184607`*^9, 3.6422943390309*^9}, {3.642295073410316*^9, 
  3.642295104993127*^9}, {3.642295338079138*^9, 3.642295338504883*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUnumNests", " ", "=", " ", "1"}], ";"}]], "Input",
 CellChangeTimes->{
  3.605410304515371*^9, 3.642294908606838*^9, {3.6422951114251337`*^9, 
   3.642295112151396*^9}, {3.642295235722637*^9, 3.642295248825018*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TUnumMatchesU", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUnumMatchesD", "=", "15"}], ";"}]}], "Input",
 CellChangeTimes->{{3.605410386167041*^9, 3.605410411203473*^9}, {
   3.6054105561227617`*^9, 3.6054105582358828`*^9}, {3.6054110321959915`*^9, 
   3.6054110325230103`*^9}, {3.6054112753478994`*^9, 
   3.6054112758749294`*^9}, {3.6054115910839586`*^9, 
   3.6054115939071198`*^9}, {3.6054116949659*^9, 3.605411697683056*^9}, 
   3.6054122937761497`*^9, {3.642294913615336*^9, 3.6422949154623747`*^9}, {
   3.642295114408959*^9, 3.6422951184956703`*^9}, {3.6422952418229322`*^9, 
   3.6422952537124853`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TUx1m", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"4", "*", 
       RowBox[{"Random", "[", 
        RowBox[{"ChiDistribution", "[", "1.5", "]"}], "]"}]}], " ", "+", " ", 
      "9"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", " ", "1", ",", "TUnumNests"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "TUnumMatchesU"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUx1f", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"4", "*", 
       RowBox[{"Random", "[", 
        RowBox[{"ChiDistribution", "[", "2", "]"}], "]"}]}], "+", "9"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", "TUnumMatchesD"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUx2m", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Random", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"10", ",", " ", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "TUnumMatchesU"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUx2f", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Random", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"10", ",", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "TUnumMatchesD"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUx3m", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Random", "[", 
      RowBox[{"LogNormalDistribution", "[", 
       RowBox[{"1", ",", " ", ".5"}], "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "TUnumMatchesU"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUx3f", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Random", "[", 
      RowBox[{"LogNormalDistribution", "[", 
       RowBox[{"1", ",", " ", "1.5"}], "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "TUnumMatchesD"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.605410425341282*^9, {3.6057524884753885`*^9, 3.6057525188391247`*^9}, 
   3.6057534025436697`*^9, {3.6422949197797203`*^9, 3.642294929954302*^9}, {
   3.642295021066193*^9, 3.642295038238151*^9}, {3.64229512331435*^9, 
   3.642295195047188*^9}, {3.642295257283011*^9, 3.642295324578657*^9}, {
   3.64229548318147*^9, 3.642295486247067*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchPayoff", "[", 
   RowBox[{"n_", ",", "i_", ",", "j_", ",", "b1_", ",", "b2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"TUx1m", "[", 
     RowBox[{"[", 
      RowBox[{"n", ",", "i"}], "]"}], "]"}], "*", 
    RowBox[{"TUx1f", "[", 
     RowBox[{"[", 
      RowBox[{"n", ",", "j"}], "]"}], "]"}]}], " ", "+", " ", 
   RowBox[{"b1", "*", 
    RowBox[{"TUx2m", "[", 
     RowBox[{"[", 
      RowBox[{"n", ",", "i"}], "]"}], "]"}], "*", 
    RowBox[{"TUx2f", "[", 
     RowBox[{"[", 
      RowBox[{"n", ",", "j"}], "]"}], "]"}]}], " ", "+", " ", 
   RowBox[{"b2", "*", 
    RowBox[{"TUx3m", "[", 
     RowBox[{"[", 
      RowBox[{"n", ",", "i"}], "]"}], "]"}], "*", 
    RowBox[{"TUx3f", "[", 
     RowBox[{"[", 
      RowBox[{"n", ",", "j"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.642294932078219*^9, 3.642294943561193*^9}, {
  3.642295219309515*^9, 3.642295219543807*^9}, {3.642295349093055*^9, 
  3.642295368339279*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUpayoffMatrices", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TUmatchPayoff", "[", 
       RowBox[{"h", ",", " ", "i", ",", "j", ",", " ", "5", ",", " ", "3"}], 
       "]"}], " ", "+", " ", 
      RowBox[{"Random", "[", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", " ", "1", ",", " ", "TUnumNests"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "TUnumMatchesU"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "TUnumMatchesD"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6054104858447423`*^9, 3.6054104894689493`*^9}, {
  3.642294945665576*^9, 3.642294966497395*^9}, {3.642295370941181*^9, 
  3.642295380546425*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "TUpayoffMatrices", "]"}]], "Input",
 CellChangeTimes->{{3.60541049280214*^9, 3.605410499859544*^9}, 
   3.642294971392233*^9, 3.642295386146529*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "5", ",", "15"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6054105005835853`*^9, 3.605410564898264*^9, 3.605411038315342*^9, 
   3.6054112813172407`*^9, 3.605411602394605*^9, 3.605411703160369*^9, 
   3.6054123001455145`*^9, 3.6057534330134125`*^9, 3.6057724304418135`*^9, 
   3.605775139680773*^9, 3.605775367776819*^9, 3.6058378794005933`*^9, {
   3.606453374363126*^9, 3.606453384346697*^9}, 3.6064535616588387`*^9, 
   3.60709244133764*^9, 3.6070931607757893`*^9, 3.60709669700105*^9, 
   3.6422942481987123`*^9, 3.642294349540679*^9, 3.642294971985488*^9, 
   3.642295047156818*^9, 3.642295503302658*^9, 3.642295812178952*^9, 
   3.642295991926442*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchMatrices", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      StyleBox["generateAssignmentMatrix",
       Background->RGBColor[1, 1, 0]], "[", 
      RowBox[{
       RowBox[{"TUpayoffMatrices", "[", 
        RowBox[{"[", "h", "]"}], "]"}], ",", "3", ",", "1"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.605410632700142*^9, 3.6054106394205265`*^9}, {
   3.6054107015250783`*^9, 3.6054107197961235`*^9}, 3.6054110218524*^9, {
   3.6054112029897604`*^9, 3.6054112216678286`*^9}, 3.60541157643112*^9, {
   3.6054116075408993`*^9, 3.605411607708909*^9}, {3.6054116434529533`*^9, 
   3.605411643619963*^9}, {3.605411681693141*^9, 3.605411682044161*^9}, 
   3.605411741444558*^9, 3.605412172737227*^9, {3.6054122823204947`*^9, 
   3.605412313256264*^9}, 3.60645337949742*^9, 3.6064535565685472`*^9, {
   3.642294973184353*^9, 3.642294980415756*^9}, {3.642295389003191*^9, 
   3.642295396891281*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchMatrices", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6054105288662033`*^9, 3.6054105724756975`*^9}, {
   3.6057753562701607`*^9, 3.6057753891190395`*^9}, 3.642294984060108*^9, 
   3.642295399547504*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "1", "1", "0", "0", "0", 
      "0"},
     {"1", "0", "0", "0", "1", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "1", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "1", "0", "0", "1", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "1", "0", 
      "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.605410532220395*^9, 3.6054105727967157`*^9}, {
   3.605410634213228*^9, 3.605410640723601*^9}, {3.6054107053722982`*^9, 
   3.605410721362213*^9}, {3.6054110232244787`*^9, 3.6054110400424404`*^9}, {
   3.605411204360839*^9, 3.605411222931901*^9}, 3.6054112826503167`*^9, {
   3.6054115792742825`*^9, 3.6054116089369793`*^9}, 3.60541164741218*^9, {
   3.60541168307822*^9, 3.605411706311549*^9}, 3.605411743339667*^9, {
   3.605412155462239*^9, 3.6054121740853043`*^9}, {3.6054122833815556`*^9, 
   3.605412315263379*^9}, 3.6057534360835886`*^9, 3.605772431674884*^9, 
   3.605775139721775*^9, {3.605775369502918*^9, 3.605775389630069*^9}, 
   3.605837881208697*^9, {3.6064533744561315`*^9, 3.6064533843856993`*^9}, 
   3.606453561695841*^9, 3.607092443398758*^9, 3.607093160796791*^9, 
   3.6070966970230513`*^9, 3.642294262282794*^9, 3.6422943528855467`*^9, 
   3.642294984923685*^9, 3.642295048576661*^9, 3.642295503354072*^9, 
   3.642295812270731*^9, 3.642295991976677*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchMatrices", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      StyleBox["generateAssignmentMatrix",
       Background->RGBColor[1, 1, 0]], "[", 
      RowBox[{
       RowBox[{"TUpayoffMatrices", "[", 
        RowBox[{"[", "h", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3", ",", "3", ",", "3"}], "}"}], ",", 
       "1"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.605410632700142*^9, 3.6054106394205265`*^9}, {
   3.6054107015250783`*^9, 3.6054107197961235`*^9}, 3.6054110218524*^9, {
   3.6054112029897604`*^9, 3.6054112216678286`*^9}, 3.60541157643112*^9, {
   3.6054116075408993`*^9, 3.605411607708909*^9}, {3.6054116434529533`*^9, 
   3.605411643619963*^9}, {3.605411681693141*^9, 3.605411682044161*^9}, 
   3.605411741444558*^9, 3.605412172737227*^9, {3.6054122823204947`*^9, 
   3.605412313256264*^9}, 3.60645337949742*^9, 3.6064535565685472`*^9, {
   3.642294375091053*^9, 3.642294406763351*^9}, {3.642294986947877*^9, 
   3.6422949942971354`*^9}, {3.642295402708186*^9, 3.642295410856958*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchMatrices", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6054105288662033`*^9, 3.6054105724756975`*^9}, {
   3.6057753562701607`*^9, 3.6057753891190395`*^9}, 3.642294997856779*^9, 
   3.642295413867114*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "1", "1", "0", "0", "0", 
      "0"},
     {"1", "0", "0", "0", "1", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "1", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "1", "0", "0", "1", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "1", "0", 
      "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.605410532220395*^9, 3.6054105727967157`*^9}, {
   3.605410634213228*^9, 3.605410640723601*^9}, {3.6054107053722982`*^9, 
   3.605410721362213*^9}, {3.6054110232244787`*^9, 3.6054110400424404`*^9}, {
   3.605411204360839*^9, 3.605411222931901*^9}, 3.6054112826503167`*^9, {
   3.6054115792742825`*^9, 3.6054116089369793`*^9}, 3.60541164741218*^9, {
   3.60541168307822*^9, 3.605411706311549*^9}, 3.605411743339667*^9, {
   3.605412155462239*^9, 3.6054121740853043`*^9}, {3.6054122833815556`*^9, 
   3.605412315263379*^9}, 3.6057534360835886`*^9, 3.605772431674884*^9, 
   3.605775139721775*^9, {3.605775369502918*^9, 3.605775389630069*^9}, 
   3.605837881208697*^9, {3.6064533744561315`*^9, 3.6064533843856993`*^9}, 
   3.606453561695841*^9, 3.607092443398758*^9, 3.607093160796791*^9, 
   3.6070966970230513`*^9, 3.642294262282794*^9, 3.6422943528855467`*^9, {
   3.642294387957086*^9, 3.642294408749008*^9}, 3.642294998599391*^9, 
   3.6422950499561462`*^9, 3.642295503401086*^9, 3.642295812357624*^9, 
   3.6422959920480947`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchMatrices", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      StyleBox["generateAssignmentMatrix",
       Background->RGBColor[1, 1, 0]], "[", 
      RowBox[{
       RowBox[{"TUpayoffMatrices", "[", 
        RowBox[{"[", "h", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "3", ",", "0", ",", "2"}], "}"}], ",", 
       "1"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.605410632700142*^9, 3.6054106394205265`*^9}, {
   3.6054107015250783`*^9, 3.6054107197961235`*^9}, 3.6054110218524*^9, {
   3.6054112029897604`*^9, 3.6054112216678286`*^9}, 3.60541157643112*^9, {
   3.6054116075408993`*^9, 3.605411607708909*^9}, {3.6054116434529533`*^9, 
   3.605411643619963*^9}, {3.605411681693141*^9, 3.605411682044161*^9}, 
   3.605411741444558*^9, 3.605412172737227*^9, {3.6054122823204947`*^9, 
   3.605412313256264*^9}, 3.60645337949742*^9, 3.6064535565685472`*^9, {
   3.642294375091053*^9, 3.642294406763351*^9}, {3.642294499876985*^9, 
   3.642294514148917*^9}, {3.6422950018089037`*^9, 3.642295006879889*^9}, {
   3.642295416828452*^9, 3.6422954248350983`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchMatrices", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6054105288662033`*^9, 3.6054105724756975`*^9}, {
   3.6057753562701607`*^9, 3.6057753891190395`*^9}, 3.6422950091801357`*^9, 
   3.642295428602992*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"1", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "1", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "1", "0", "0", "0", "0", "0", 
      "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.605410532220395*^9, 3.6054105727967157`*^9}, {
   3.605410634213228*^9, 3.605410640723601*^9}, {3.6054107053722982`*^9, 
   3.605410721362213*^9}, {3.6054110232244787`*^9, 3.6054110400424404`*^9}, {
   3.605411204360839*^9, 3.605411222931901*^9}, 3.6054112826503167`*^9, {
   3.6054115792742825`*^9, 3.6054116089369793`*^9}, 3.60541164741218*^9, {
   3.60541168307822*^9, 3.605411706311549*^9}, 3.605411743339667*^9, {
   3.605412155462239*^9, 3.6054121740853043`*^9}, {3.6054122833815556`*^9, 
   3.605412315263379*^9}, 3.6057534360835886`*^9, 3.605772431674884*^9, 
   3.605775139721775*^9, {3.605775369502918*^9, 3.605775389630069*^9}, 
   3.605837881208697*^9, {3.6064533744561315`*^9, 3.6064533843856993`*^9}, 
   3.606453561695841*^9, 3.607092443398758*^9, 3.607093160796791*^9, 
   3.6070966970230513`*^9, 3.642294262282794*^9, 3.6422943528855467`*^9, {
   3.642294387957086*^9, 3.642294408749008*^9}, {3.642294502594481*^9, 
   3.642294515959733*^9}, 3.642295010162237*^9, 3.642295054937532*^9, 
   3.6422955034562407`*^9, 3.642295812406707*^9, 3.642295992110311*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchMatrices", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      StyleBox["generateAssignmentMatrix",
       Background->RGBColor[1, 1, 0]], "[", 
      RowBox[{
       RowBox[{"TUpayoffMatrices", "[", 
        RowBox[{"[", "h", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "3", ",", "0", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "2", ",", "2", ",", "1", ",", "1", ",", "1", ",", 
         "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
          "0"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "TUnumNests"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.605410632700142*^9, 3.6054106394205265`*^9}, {
   3.6054107015250783`*^9, 3.6054107197961235`*^9}, 3.6054110218524*^9, {
   3.6054112029897604`*^9, 3.6054112216678286`*^9}, 3.60541157643112*^9, {
   3.6054116075408993`*^9, 3.605411607708909*^9}, {3.6054116434529533`*^9, 
   3.605411643619963*^9}, {3.605411681693141*^9, 3.605411682044161*^9}, 
   3.605411741444558*^9, 3.605412172737227*^9, {3.6054122823204947`*^9, 
   3.605412313256264*^9}, 3.60645337949742*^9, 3.6064535565685472`*^9, {
   3.642294375091053*^9, 3.642294406763351*^9}, {3.642294499876985*^9, 
   3.642294514148917*^9}, {3.6422950018089037`*^9, 3.642295006879889*^9}, {
   3.642295416828452*^9, 3.6422954248350983`*^9}, {3.642295937268672*^9, 
   3.642295950680901*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TUmatchMatrices", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6054105288662033`*^9, 3.6054105724756975`*^9}, {
   3.6057753562701607`*^9, 3.6057753891190395`*^9}, 3.6422950091801357`*^9, 
   3.642295428602992*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"1", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "1", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.605410532220395*^9, 3.6054105727967157`*^9}, {
   3.605410634213228*^9, 3.605410640723601*^9}, {3.6054107053722982`*^9, 
   3.605410721362213*^9}, {3.6054110232244787`*^9, 3.6054110400424404`*^9}, {
   3.605411204360839*^9, 3.605411222931901*^9}, 3.6054112826503167`*^9, {
   3.6054115792742825`*^9, 3.6054116089369793`*^9}, 3.60541164741218*^9, {
   3.60541168307822*^9, 3.605411706311549*^9}, 3.605411743339667*^9, {
   3.605412155462239*^9, 3.6054121740853043`*^9}, {3.6054122833815556`*^9, 
   3.605412315263379*^9}, 3.6057534360835886`*^9, 3.605772431674884*^9, 
   3.605775139721775*^9, {3.605775369502918*^9, 3.605775389630069*^9}, 
   3.605837881208697*^9, {3.6064533744561315`*^9, 3.6064533843856993`*^9}, 
   3.606453561695841*^9, 3.607092443398758*^9, 3.607093160796791*^9, 
   3.6070966970230513`*^9, 3.642294262282794*^9, 3.6422943528855467`*^9, {
   3.642294387957086*^9, 3.642294408749008*^9}, {3.642294502594481*^9, 
   3.642294515959733*^9}, 3.642295010162237*^9, 3.642295054937532*^9, 
   3.6422955034562407`*^9, 3.642295812406707*^9, 3.642295992213331*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["matchMatrix=CmatchMatrix[payoffMatrix,quotaU,quotaD]", "Subsection",
 CellChangeTimes->{{3.6263308968647165`*^9, 3.6263309292397165`*^9}}],

Cell["Obviously we must calculate the payoffMatrix first!", "Text",
 CellChangeTimes->{{3.6263309331615915`*^9, 3.6263309641303415`*^9}, 
   3.6263310299584665`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "CmatchMatrix", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CmatchMatrix", "::", "usage"}], "=", 
   "\"\<CmatchMatrix[payoffMatrix_,quotaU_:1,quotaD_:1,p_:0]  \nCalculates \
and creates/updates the global variable 'matchMatrix'.\nIf p is set to 0, it \
creates the matchMatrix by running the generateAssignmentMatrix routine for \
all markets.\nIf p is set to an integer from 1 to the 'number of Markets' \
then the p'th element of the matchMatrix is calculated.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatchMatrix", "[", 
   RowBox[{"payoffMatrix_", ",", 
    RowBox[{"quotaU_:", "1"}], ",", 
    RowBox[{"quotaD_:", "1"}], ",", 
    RowBox[{"p_:", "False"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IntegerQ", "@", "p"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"1", "\[LessEqual]", " ", "p", "\[LessEqual]", 
       RowBox[{"Length", "@", "payoffMatrix"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Definition", "@", "matchMatrix"}], "\[Equal]", "Null"}], 
         ",", 
         RowBox[{"matchMatrix", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"Null", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "@", "payoffMatrix"}], "}"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"matchMatrix", "[", 
         RowBox[{"[", "p", "]"}], "]"}], "=", "\[IndentingNewLine]", 
        RowBox[{"generateAssignmentMatrix", "[", 
         RowBox[{
          RowBox[{"payoffMatrix", "[", 
           RowBox[{"[", "p", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", "quotaU"}], ",", 
            RowBox[{"quotaU", "[", 
             RowBox[{"[", "p", "]"}], "]"}], ",", "quotaU"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", "quotaD"}], ",", 
            RowBox[{"quotaD", "[", 
             RowBox[{"[", "p", "]"}], "]"}], ",", "quotaD"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "matchMatrix"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Invalid market index!\>\"", "]"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"matchMatrix", "=", "\[IndentingNewLine]", 
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"generateAssignmentMatrix", "[", 
         RowBox[{"#1", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", "quotaU"}], ",", 
            RowBox[{"quotaU", "[", 
             RowBox[{"[", 
              RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", 
            "quotaU"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", "quotaD"}], ",", 
            RowBox[{"quotaD", "[", 
             RowBox[{"[", 
              RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", 
            "quotaD"}], "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
       "payoffMatrix"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwlzVtIk3EYBvCvUdqJubRtJbS5NMlTiZRbB62v0iZsWEsqZs08tJKINiNq
u5ktRXOFDCvnMJoiJmwL2UV2WGKSojJKBGWCmiQY9qkktMAD1v/57+Llx/Nc
PK+s5I7mOo9hmCRysNedGvBs5NjelLEg1T0xG3bnYriXZnqpU/KwLSep7men
YEXd2chZAcd2CuMkUGcyZUPX237qTBdfCY/zjPnQtiXyvDSeY8XJixq4wec8
nUisWFDmwBMXmz1w7H3QC588mPwIFZXXuqH1tviDwMyxg542P8yI5Ydg6FP7
P6h7nrN5B3Gl8gI1wzS6Hf7dcyYWWr7lSiF/zhIPW+8uHIXzN81a6p/fRTCk
l5TDx7u0Bvi6JcEItffUVig0VD2Cn5n5Wqh3HKqDzWsFnbBjQEd1hmr9cMne
3QMlzuovdOfpah8snV4ZhNGul0Nwm9w2AvvFUUF4rsz8HcY9TFmCokDj1Wji
VzZA9R/pKoFbU5kyqPJdtkPfXNQLqMmN2S1EjrhFVSa49sP7QzVpsM/qkMNf
7YcVMM/+zruPuO5ZfgNlPw+uJhIFstI1mL5pRFFvI/8Fw8fghLdG3djAscYD
9Veglpc15SCKVHnTsPzHuqqJuHzjlRqqx8cLoEVkuQT3ZhYWwwZDtR7+BztY
N7M=
  "],
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"f81cb481-8ef7-46f3-ad04-80fc01eb88db"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "CmatchMatrix"}]], "Input",
 CellChangeTimes->{{3.687878152264941*^9, 3.687878155003717*^9}}],

Cell[BoxData[
 StyleBox["\<\"CmatchMatrix[payoffMatrix_,quotaU_:1,quotaD_:1,p_:0]  \
\\nCalculates and creates/updates the global variable 'matchMatrix'.\\nIf p \
is set to 0, it creates the matchMatrix by running the \
generateAssignmentMatrix routine for all markets.\\nIf p is set to an integer \
from 1 to the 'number of Markets' then the p'th element of the matchMatrix is \
calculated.\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.701263219855154*^9},
 CellTags->"Info173701274019-6163275"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MapIndexed"}]], "Input",
 CellChangeTimes->{{3.6879230567301083`*^9, 3.687923061164179*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\!\(\*RowBox[{\\\"MapIndexed\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"expr\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\) applies \!\(\*StyleBox[\\\"f\\\", \\\"TI\\\"]\) to \
the elements of \!\(\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\), giving the part \
specification of each element as a second argument to \
\!\(\*StyleBox[\\\"f\\\", \\\"TI\\\"]\). \\n\!\(\*RowBox[{\\\"MapIndexed\\\", \
\\\"[\\\", RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"levelspec\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\) applies \!\(\*StyleBox[\\\"f\\\", \\\"TI\\\"]\) to \
all parts of \!\(\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\) on levels specified \
by \!\(\*StyleBox[\\\"levelspec\\\", \\\"TI\\\"]\). \
\\n\!\(\*RowBox[{\\\"MapIndexed\\\", \\\"[\\\", StyleBox[\\\"f\\\", \
\\\"TI\\\"], \\\"]\\\"}]\) represents an operator form of MapIndexed that can \
be applied to an expression.\"\>", "MSG"], "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/MapIndexed"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.701263222809723*^9},
 CellTags->"Info183701274022-6163275"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unit testing", "Subsubsection",
 CellChangeTimes->{{3.642310216818613*^9, 3.64231021959524*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"directory", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.6369625741502457`*^9, 3.636962600654554*^9}, 
   3.636962650795623*^9, 3.6369626892682133`*^9, {3.6423103614323263`*^9, 
   3.642310362527133*^9}, {3.642310571679482*^9, 3.64231058932232*^9}, 
   3.642310642104238*^9}],

Cell[BoxData["\<\"/home/tchr/Dropbox/Denisa_Mathematica-MSE/library/\"\>"], \
"Output",
 CellChangeTimes->{
  3.636962651174423*^9, 3.636962691969932*^9, 3.6369639605988894`*^9, 
   3.636970790974526*^9, 3.6369712290984173`*^9, 3.6385983830553455`*^9, 
   3.6422988416568823`*^9, 3.6422988945146523`*^9, 3.642310208787644*^9, {
   3.642310519787836*^9, 3.6423105400752163`*^9}, {3.642310573540146*^9, 
   3.642310620443858*^9}, {3.6423106713191137`*^9, 3.642310699742436*^9}, 
   3.6423108767002897`*^9, 3.642311061694797*^9, 3.642311223235867*^9, 
   3.6878776246057777`*^9, 3.6878776813191977`*^9, 3.687877719508357*^9, 
   3.6878777946909*^9, 3.687878582803176*^9, 3.687884927295385*^9, 
   3.687925789580884*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"\"\<mse.m\>\"", ",", 
   RowBox[{"Path", "\[Rule]", "directory"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6303091438379374`*^9, 3.6303091800723124`*^9}, 
   3.6303092721035624`*^9, {3.642310367373456*^9, 3.642310367870948*^9}, {
   3.642310576283866*^9, 3.642310594648158*^9}, 3.642310676876841*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"157369264", ",", "127706576", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6305770055258126`*^9, 3.6305772673468037`*^9, 3.630582335665759*^9, 
   3.6305834061494207`*^9, 3.630583906116443*^9, 3.6305843465826235`*^9, 
   3.6305845633013735`*^9, 3.6305848948013735`*^9, 3.630586651074811*^9, 
   3.630586784777936*^9, 3.630590320467389*^9, 3.630590471654889*^9, 
   3.630591358451764*^9, 3.630592818764264*^9, {3.630592936670514*^9, 
   3.630592964217389*^9}, 3.630595132545514*^9, 3.630595243936139*^9, 
   3.630595628295514*^9, 3.6305978411558657`*^9, 3.630599442272568*^9, 
   3.630612258359473*^9, 3.630671763991976*^9, 3.6306744008009043`*^9, 
   3.630725069310239*^9, 3.6307276209078417`*^9, 3.6307277743368106`*^9, 
   3.6307278183917274`*^9, 3.6307434152694626`*^9, 3.6307444819866962`*^9, 
   3.630744556708056*^9, {3.6307473665954723`*^9, 3.630747374724143*^9}, 
   3.6307511730713773`*^9, 3.6307542944695225`*^9, 3.630754835660693*^9, 
   3.6307556841551332`*^9, 3.6307650704149313`*^9, 3.6307651156649313`*^9, 
   3.6307656563680563`*^9, 3.6307677783993063`*^9, 3.63076889099656*^9, 
   3.630770585848946*^9, 3.6307745487334375`*^9, 3.6309364193399267`*^9, 
   3.6309394034268007`*^9, 3.630940866111972*^9, 3.630941899304834*^9, 
   3.6309420995623007`*^9, 3.630948869497966*^9, 3.630956482109168*^9, 
   3.6309567939625196`*^9, 3.6311699615566916`*^9, 3.6311705482754416`*^9, 
   3.6311707685566916`*^9, 3.631174956777395*^9, 3.6311803584805193`*^9, 
   3.631187095421926*^9, 3.6311926649540997`*^9, 3.6311946574795623`*^9, 
   3.6311949322450075`*^9, 3.6311951020984774`*^9, 3.631195706189581*^9, 
   3.632931685388751*^9, 3.6337014794318237`*^9, 3.6337017737205887`*^9, 
   3.6337022130852284`*^9, 3.636962552124161*^9, 3.6369626038675003`*^9, 
   3.636962694419063*^9, 3.636963970806754*^9, 3.636970797636963*^9, 
   3.636971239638914*^9, 3.6385983872584705`*^9, 3.6422988435433187`*^9, 
   3.64229889694057*^9, 3.642310210210979*^9, {3.642310520195928*^9, 
   3.642310541881769*^9}, {3.642310577309627*^9, 3.6423106365207577`*^9}, {
   3.642310671513424*^9, 3.642310700032502*^9}, 3.6423108770993633`*^9, 
   3.64231106256977*^9, 3.642311223636424*^9, 3.687877628107642*^9, 
   3.687877682659486*^9, 3.687877721307852*^9, 3.687877796412266*^9, 
   3.68787858429593*^9, 3.687884930043416*^9, 3.6879257917287283`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<TU*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.642310376272935*^9, 3.642310388066584*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TUheader", ",", "TUnoM", ",", "TUnoU", ",", "TUnoD", ",", 
     StyleBox["noAttr",
      Background->RGBColor[1, 0.5, 0.5]], ",", 
     StyleBox["distanceMatrices",
      Background->RGBColor[1, 0.5, 0.5]], ",", "TUmatchMatrix", ",", 
     "TUmate"}], "}"}], "=", 
   RowBox[{"import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</import/\>\"", 
      "<>", "\"\<precomp_testdata.dat\>\""}], ",", "\"\<precomp\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.626171011874079*^9, 3.626171023855977*^9}, {
  3.642310312437974*^9, 3.642310338682663*^9}, {3.6423109125915403`*^9, 
  3.6423109370743303`*^9}, {3.6423110506247377`*^9, 3.642311058372011*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUpayoffMatrix", "=", 
   RowBox[{"CpayoffMatrix", "[", 
    RowBox[{"payoffDM", ",", "TUnoM", ",", "TUnoU", ",", "TUnoD"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.6261710966927123`*^9, {3.6261716047920165`*^9, 3.6261716104789906`*^9}, 
   3.626172860525609*^9, 3.626173494133915*^9, {3.6263319744115915`*^9, 
   3.6263319766615915`*^9}, {3.642310395147726*^9, 3.642310411264344*^9}, 
   3.642310711834962*^9}],

Cell["\<\
\[LineSeparator]Setting real values for x\[CloseCurlyQuote]s (Only then the \
matchMatrix can be calculated - it is a numerical computation - not symbolic)\
\>", "Text",
 CellChangeTimes->{{3.6263319895834665`*^9, 3.6263320654428415`*^9}, 
   3.687877634740879*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUpayoffMatrix", "=", 
   RowBox[{"TUpayoffMatrix", "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Cx", "[", "4", "]"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "1.5", ",", "2.3"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.626171121982574*^9, 3.626171168978284*^9}, 
   3.6261713989239902`*^9, 3.6261716277635903`*^9, {3.642310418342949*^9, 
   3.6423104238894033`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TUmatchMatrix", "=", 
  RowBox[{
   StyleBox["CmatchMatrix",
    Background->RGBColor[1, 1, 0]], "[", 
   RowBox[{"TUpayoffMatrix", ",", "2", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.626171261461618*^9, 3.626171265327815*^9}, {
   3.6263298485678415`*^9, 3.6263299028647165`*^9}, 3.6263320729272165`*^9, {
   3.6423076035037193`*^9, 3.642307613811006*^9}, {3.642310429302258*^9, 
   3.642310434193273*^9}, {3.642310715130673*^9, 3.642310715608391*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6423105203584023`*^9, {3.64231067171667*^9, 3.64231070025386*^9}, 
   3.642310878443864*^9, 3.642311069235189*^9, 3.642311223831292*^9, 
   3.6878776410049343`*^9, 3.68787772921108*^9, 3.687877805163247*^9, 
   3.687878593864867*^9, 3.6879258437108593`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TUmatchMatrix2", "=", 
  RowBox[{
   StyleBox["CmatchMatrix",
    Background->RGBColor[1, 1, 0]], "[", 
   RowBox[{"TUpayoffMatrix", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", "1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.642307172543664*^9, 3.642307236414545*^9}, 
   3.642307375071673*^9, {3.642310451185691*^9, 3.642310451681561*^9}, {
   3.642310724634617*^9, 3.642310725164034*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.642307238463759*^9, 3.642307377412858*^9, 3.642307958729604*^9, 
   3.642310520389979*^9, {3.64231067175851*^9, 3.6423107003070393`*^9}, 
   3.642310879040522*^9, 3.642311070696342*^9, 3.642311223910417*^9, 
   3.687877810848044*^9, 3.687878597538733*^9, 3.687925845327777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TUmatchMatrix", "\[Equal]", "TUmatchMatrix2"}]], "Input",
 CellChangeTimes->{{3.642307971241332*^9, 3.642307982498884*^9}, {
  3.642310479303022*^9, 3.642310483465802*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.642307983356431*^9, 3.642310520428269*^9, {3.642310671808074*^9, 
   3.642310700362966*^9}, 3.6423108791502542`*^9, 3.6423110718683577`*^9, 
   3.642311223914863*^9, 3.687877814050988*^9, 3.6878786000498447`*^9, 
   3.687925848439762*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TUmatchMatrix2", "=", 
  RowBox[{
   StyleBox["CmatchMatrix",
    Background->RGBColor[1, 1, 0]], "[", 
   RowBox[{"TUpayoffMatrix", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", 
        "2", ",", "2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "3", ",", 
        "2", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", 
        "2", ",", "2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642307172543664*^9, 3.642307236414545*^9}, 
   3.642307375071673*^9, {3.6423082208147297`*^9, 3.6423082828893633`*^9}, {
   3.6423104870189734`*^9, 3.642310487472363*^9}, {3.6423107202191153`*^9, 
   3.642310720489188*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "0", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.642308244306979*^9, 3.642308283751137*^9}, 
   3.642310520467792*^9, {3.642310671876874*^9, 3.642310700430065*^9}, 
   3.642310879720673*^9, 3.642311072758895*^9, 3.642311224029127*^9, 
   3.687877824571457*^9, 3.6878786013905*^9, 3.687925849766123*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"quotas", "[", "matchMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.687877836057673*^9, 3.687877893418015*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", 
       "2", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
       "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", 
       "2", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
       "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6878778488915443`*^9, 3.687877883592516*^9}, 
   3.687878604510825*^9, 3.6879258518224573`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matchMatrix", "==", "TUmatchMatrix2"}]], "Input",
 CellChangeTimes->{{3.6878778961251497`*^9, 3.687877943001815*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.68787790852485*^9, 3.687877943928334*^9}, 
   3.687878606474394*^9, 3.687925854794303*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate quotas from matchMatrix", "Subsection",
 CellChangeTimes->{{3.6423093280832243`*^9, 3.642309339756105*^9}, {
  3.709202636190818*^9, 
  3.709202640584889*^9}},ExpressionUUID->"153c495d-37d9-4f44-bd76-\
8bc2d1b9d84b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"Cquota", ",", "quota"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cquota", "::", "usage"}], "=", 
   "\"\<Calculates and creates/updates the global variable 'quota'. \
Cquota[matchMatrix] returns the association list quota = \
<|\\\"upstream\\\"->quotaU,\\\"downstream\\\"->quotaD|>. Quota is defined for \
each stream u and d.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cquota", "[", "matchMatrix_", "]"}], ":=", 
  RowBox[{"quota", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<upstream\>\"", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Total", "/@", "#"}], ")"}], "&"}], "/@", "matchMatrix"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<downstream\>\"", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "#"}], ")"}]}], ")"}], "&"}], "/@", 
        "matchMatrix"}], ")"}]}]}], "\[IndentingNewLine]", 
    "|>"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642303740898554*^9, 3.642303781931591*^9}, {
   3.6423093502911158`*^9, 3.642309374194827*^9}, {3.642309714805132*^9, 
   3.642309777526725*^9}, {3.697048434297811*^9, 3.6970484358083277`*^9}, {
   3.709202643298367*^9, 3.709202708529315*^9}, {3.709202796149979*^9, 
   3.709202908443727*^9}, {3.709202982649822*^9, 3.709202988949814*^9}, {
   3.709203128132598*^9, 3.709203140410335*^9}, {3.7092034742826633`*^9, 
   3.709203491320163*^9}, 3.709203543262155*^9, {3.709203648233172*^9, 
   3.709203674472826*^9}, {3.709204212095586*^9, 3.709204217347479*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"8e9d0655-4c11-4243-baa8-3fd8eeb0c0bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Cquota"}]], "Input",
 CellChangeTimes->{{3.709204237570758*^9, 
  3.709204243628023*^9}},ExpressionUUID->"c89b1647-73c3-4d16-ad21-\
d6a44b6e7f80"],

Cell[BoxData[
 StyleBox["\<\"Calculates and creates/updates the global variable 'quota'. \
Cquota[matchMatrix] returns the association list quota = \
<|\\\"upstream\\\"->quotaU,\\\"downstream\\\"->quotaD|>. Quota is defined for \
each stream u and d.\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.709204244249777*^9},
 CellTags->
  "Info803709215044-5870464",ExpressionUUID->"b4a4bc67-b1b5-4574-b7cd-\
d294e556c194"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unit testing", "Subsubsection",
 CellChangeTimes->{{3.642309619493703*^9, 
  3.642309622214303*^9}},ExpressionUUID->"c39a64d4-77e9-402b-affc-\
ff2e83803795"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matchMatrix", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
         "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "1", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
         "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
         "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matchMatrix", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.642309594735303*^9, 3.642309614299549*^9}, {
  3.642309782026322*^9, 3.6423097832211447`*^9}, {3.709203084278378*^9, 
  3.709203084456609*^9}, {3.709203161703246*^9, 
  3.709203170210462*^9}},ExpressionUUID->"b931bed6-1679-402b-88a5-\
321eafe27cb0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "1", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"1", "0", "0", "1", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"1", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.709203176007894*^9, {3.709203524716216*^9, 3.7092035473077374`*^9}, 
   3.709203687684538*^9},ExpressionUUID->"ccb99b3d-c971-4e59-ab82-\
8f5fa9e14cf8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "/@", 
  RowBox[{"(", 
   RowBox[{"matchMatrix", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.642298933548697*^9, 3.642298984626255*^9}, {
  3.642299038079836*^9, 3.6422990398418303`*^9}, {3.6423096684320517`*^9, 
  3.642309668904066*^9}, {3.642309795909629*^9, 3.642309797404664*^9}, {
  3.709203097240801*^9, 
  3.7092030973982677`*^9}},ExpressionUUID->"3e5c0fc8-b34e-4142-87b6-\
6eec33d0b131"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", "2", 
   ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.642298939203779*^9, 3.642298950894259*^9}, 
   3.642298985012514*^9, 3.6422990406705427`*^9, 3.642308105787703*^9, 
   3.6423096709453297`*^9, 3.64230979796542*^9, 3.709203007570681*^9, 
   3.709203098481433*^9, 3.7092031786399937`*^9, {3.709203527200993*^9, 
   3.7092035483189793`*^9}, 
   3.709203689004722*^9},ExpressionUUID->"7560fa21-4b19-45db-9734-\
643dcc0116e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "/@", 
  RowBox[{"(", 
   RowBox[{"Transpose", "@", 
    RowBox[{"(", 
     RowBox[{"matchMatrix", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ")"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.6422989960643873`*^9, 3.6422990111697598`*^9}, {
  3.6422990445799017`*^9, 3.6422990580672817`*^9}, {3.642309674860614*^9, 
  3.642309675321024*^9}, {3.709203101203765*^9, 
  3.709203101358398*^9}},ExpressionUUID->"372ebddd-bbfb-4680-9307-\
00f27576cd2e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", "2", 
   ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.642299011660445*^9, {3.64229904748363*^9, 3.6422990590427427`*^9}, 
   3.642308106722518*^9, 3.6423096766659*^9, 3.6423097987349367`*^9, 
   3.709203010053142*^9, 3.709203102003181*^9, 3.709203179652611*^9, {
   3.709203528206052*^9, 3.709203548994334*^9}, 
   3.709203690141642*^9},ExpressionUUID->"189fcd6c-c661-454d-93f9-\
2cb53a6785fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Total", "/@", "#"}], ")"}], "&"}], "/@", 
  "matchMatrix"}]], "Input",
 CellChangeTimes->{{3.642303625840535*^9, 3.642303643107699*^9}, {
  3.64230968018001*^9, 3.642309680528294*^9}, {3.709203106003644*^9, 
  3.709203106183962*^9}},ExpressionUUID->"dd1328b4-5c4d-485a-84b6-\
138e76a2c7ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", "2",
      ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2",
      ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.642303644113421*^9, 3.642308107404504*^9, 3.642309681379034*^9, 
   3.6423097995631247`*^9, 3.7092030113175087`*^9, 3.7092031080308123`*^9, 
   3.709203180758902*^9, {3.7092035293886347`*^9, 3.7092035496006403`*^9}, 
   3.709203690920806*^9},ExpressionUUID->"d3d2f066-7ddb-4d43-a5ce-\
2974016cd081"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Total", "/@", 
     RowBox[{"(", 
      RowBox[{"Transpose", "@", "#"}], ")"}]}], ")"}], "&"}], "/@", 
  "matchMatrix"}]], "Input",
 CellChangeTimes->{{3.6423036693529673`*^9, 3.642303678455509*^9}, {
  3.642309685792288*^9, 3.64230968621805*^9}, {3.7092031110633163`*^9, 
  3.709203111229579*^9}},ExpressionUUID->"726611b9-55ea-46ce-96f9-\
f91d963c1eff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", "2",
      ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2",
      ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.642303679685501*^9, 3.642308108333561*^9, 3.6423096871252813`*^9, 
   3.642309800305532*^9, 3.70920301251655*^9, 3.709203112331956*^9, 
   3.709203181822175*^9, {3.7092035306166477`*^9, 3.7092035502133703`*^9}, 
   3.7092036924013453`*^9},ExpressionUUID->"eeb56bb5-1fa7-43f2-8c67-\
f2dff1fb8f03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cquota", "[", "matchMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.7092032012592916`*^9, 3.709203214021523*^9}, 
   3.709203502003851*^9},ExpressionUUID->"4f0afdfd-8b1d-4f91-ab07-\
7fbe0c9b8f2a"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"upstream\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", 
        "2", ",", "2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"downstream\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", 
        "2", ",", "2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.7092032166606627`*^9, {3.709203532942464*^9, 3.709203550749898*^9}, 
   3.7092036967494173`*^9},ExpressionUUID->"f91b14e2-efb6-432e-81f3-\
d9d7b5575b79"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["quota"], "Input",
 CellChangeTimes->{{3.709203698768849*^9, 
  3.709203701584888*^9}},ExpressionUUID->"3fc529a3-d722-4804-965d-\
e2fd0785b1a1"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"upstream\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", 
        "2", ",", "2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"downstream\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0", ",", "1", ",", "3", ",", "2", ",", "1", ",", "2", ",", 
        "2", ",", "2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
        "2", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.709203702387011*^9},ExpressionUUID->"6c683919-a005-4293-b1b6-\
ca490af65653"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cmates[matchMatrix]", "Subsection",
 CellChangeTimes->{
  3.6117411131376095`*^9, 3.611741233674157*^9, {3.611741277829609*^9, 
   3.6117412916970325`*^9}, {3.611912880528715*^9, 3.611912891202575*^9}, {
   3.6119140668733816`*^9, 3.6119141092559533`*^9}, {3.61191461056221*^9, 
   3.6119146122298455`*^9}, {3.611916770293911*^9, 3.6119167752215366`*^9}, {
   3.611917597165457*^9, 3.611917598356863*^9}, 3.611917663199075*^9, {
   3.6119182097453203`*^9, 3.6119182120154114`*^9}, {3.611919677728411*^9, 
   3.6119196811942315`*^9}, 
   3.611921442829568*^9},ExpressionUUID->"47f427c8-e615-45d0-846b-\
f8051500f09f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "C", " ", "in", " ", "front", " ", "of", " ", "the", " ", "name", " ", 
    "means", " ", "create"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "Cmates", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cmates", "::", "usage"}], "=", 
     "\"\<\nCmates[matchMatrix] simplifies the matchMatrix to a list of \
triples that define matches across all markets. It provides another way to \
express all the matching information that is, which upstream is matched with \
which downstream and in which market. The output consists of a list of lists \
of triples each of which has the following structure: \
{market_index,upstream_index,downstream_index}.\nOutput \
example:{{{1,1,3},{1,3,1},{1,3,2}},{{2,1,1},{2,2,1},{2,2,3},{2,3,2}}}. In \
this example we have 2 lists, one per market and each inner list contains the \
triples. Note that in market 1, upstream agent 2 is not contributing which is \
fine. \nThis function is mainly used for the calculation of the total payoff \
- see Ctotalpayoff routine.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cmates", "[", "matchMatrix_", "]"}], ":=", 
     RowBox[{"mates", "=", 
      RowBox[{"GatherBy", "[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"matchMatrix", ",", "1", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], ",", "First"}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611654102177257*^9, 3.6116542218406477`*^9}, 
   3.611654420939027*^9, {3.6116544925174885`*^9, 3.6116545056894417`*^9}, {
   3.6116545421489096`*^9, 3.611654664496849*^9}, {3.611741108152258*^9, 
   3.611741109824133*^9}, {3.6117412417288446`*^9, 3.6117412863497148`*^9}, {
   3.6117415360333033`*^9, 3.611741537631454*^9}, {3.611916949583702*^9, 
   3.611917018355516*^9}, {3.611917052260789*^9, 3.611917084657938*^9}, {
   3.611917604796316*^9, 3.6119176077787385`*^9}, {3.6119193255870132`*^9, 
   3.6119193339679804`*^9}, {3.611919688618336*^9, 3.61191969788384*^9}, {
   3.6327390860990343`*^9, 3.6327391054730577`*^9}, {3.63273915881715*^9, 
   3.632739288309473*^9}, {3.632739324336192*^9, 3.6327393442238874`*^9}, 
   3.6327393877179394`*^9, {3.6880082323252983`*^9, 3.6880082365448513`*^9}, {
   3.697048184780802*^9, 3.69704819864695*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.611917258849233*^9, 3.6119172603767457`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mates", "=", 
  RowBox[{"Cmates", "[", "matchMatrix", "]"}]}]], "Input",
 CellChangeTimes->{{3.626171756051646*^9, 3.6261717660887556`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "6", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "7", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "8", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "9", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "10", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "8", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "10", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "10", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "8", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "10", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "10", ",", "10"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.626171768333873*^9, {3.626173487970665*^9, 3.626173497742124*^9}, 
   3.6263306991772165`*^9, 3.6263322923959665`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cmates", "[", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.611917086911497*^9, 3.61191710678026*^9}, {
   3.61191714723989*^9, 3.6119172206057825`*^9}, 3.6119176172091846`*^9, {
   3.6119179568491726`*^9, 3.611917958605032*^9}, {3.611918583279616*^9, 
   3.611918584865553*^9}, {3.6119194195411544`*^9, 3.611919434394255*^9}, {
   3.611919648556239*^9, 3.6119196538483367`*^9}, {3.6263323385990915`*^9, 
   3.6263323476459665`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6263334678022165`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cmate[matchMatrix]", "Subsection",
 CellChangeTimes->{
  3.6117411131376095`*^9, 3.611741233674157*^9, {3.611741277829609*^9, 
   3.6117412916970325`*^9}, {3.611912880528715*^9, 3.611912891202575*^9}, {
   3.6119140668733816`*^9, 3.6119141092559533`*^9}, {3.61191461056221*^9, 
   3.6119146122298455`*^9}, {3.611916770293911*^9, 3.6119167752215366`*^9}, {
   3.611917597165457*^9, 3.611917598356863*^9}, 3.611917663199075*^9, {
   3.6119182097453203`*^9, 3.6119182120154114`*^9}, {3.611919677728411*^9, 
   3.6119196811942315`*^9}, {3.611920435131773*^9, 3.6119204429100695`*^9}, {
   3.611920552241973*^9, 3.611920556548978*^9}, 3.6119214405720224`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "C", " ", "in", " ", "front", " ", "of", " ", "the", " ", "name", " ", 
    "means", " ", "create"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "Cmate", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cmate", "::", "usage"}], "=", 
     "\"\<Cmate[matchMatrix] simplifies the matchMatrix from the original \
code by Santiago & Fox, to a matrix format which consists of lists of pairs, \
one pair per market. Here, each pair has the following structure: \
{{{1},{2},...,{noU within this market}},{{downstreams that are matched with \
upstream1},{downstreams that are matched with upstream2},...,{downstreams \
that are matched with upstream noU}}.\nExample : \
{{{{1},{2},{3}},{{3},{},{1,2}}},{{{1},{2},{3}},{{1},{1,3},{2}}}}.  In this \
example, there are three upstream and three downstream agents in each market, \
indexed 1, 2, 3. In the first market, upstream 1 is matched with downstream \
3, upstream 2 is not matched, and upstream 3 is matched with downstream 1 and \
 2. In the second market, upstream 1 is matched with downstream 1, upstream 2 \
with downstream 1 and 3, and upstream 3 with downstream 2.  \nThe \
mate=Cmate[matchMatrix] is later fed into the Cineqmembers routine.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cmate", "[", "matchMatrix_", "]"}], ":=", 
    RowBox[{"mate", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Transpose", "@", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"First", "@", "#2"}], "}"}], ",", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Position", "[", 
                 RowBox[{"#1", ",", "1"}], "]"}]}]}], "}"}], "&"}], ",", 
            "#"}], "]"}]}], ")"}], "&"}], "/@", "matchMatrix"}], 
      ")"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611654102177257*^9, 3.6116542218406477`*^9}, 
   3.611654420939027*^9, {3.6116544925174885`*^9, 3.6116545056894417`*^9}, {
   3.6116545421489096`*^9, 3.611654664496849*^9}, {3.611741108152258*^9, 
   3.611741109824133*^9}, {3.6117412417288446`*^9, 3.6117412863497148`*^9}, {
   3.6117415360333033`*^9, 3.611741537631454*^9}, {3.611916949583702*^9, 
   3.611917018355516*^9}, {3.611917052260789*^9, 3.611917084657938*^9}, {
   3.611917604796316*^9, 3.6119176077787385`*^9}, {3.6119193255870132`*^9, 
   3.6119193339679804`*^9}, {3.611919688618336*^9, 3.61191969788384*^9}, {
   3.611920445930352*^9, 3.611920485267894*^9}, {3.611920539213221*^9, 
   3.6119205651999493`*^9}, {3.6327393936307545`*^9, 
   3.6327395532618265`*^9}, {3.688008247756948*^9, 3.6880082620889273`*^9}, 
   3.697048280934793*^9},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.611917258849233*^9, 3.6119172603767457`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mate", "=", 
  RowBox[{"Cmate", "[", "matchMatrix", "]"}]}]], "Input",
 CellChangeTimes->{{3.611920863325688*^9, 3.6119208715021544`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "4", "}"}], ",", 
       RowBox[{"{", "5", "}"}], ",", 
       RowBox[{"{", "6", "}"}], ",", 
       RowBox[{"{", "7", "}"}], ",", 
       RowBox[{"{", "8", "}"}], ",", 
       RowBox[{"{", "9", "}"}], ",", 
       RowBox[{"{", "10", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "9", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "5", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "7"}], "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "10", "}"}], ",", 
       RowBox[{"{", "8", "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "4", "}"}], ",", 
       RowBox[{"{", "5", "}"}], ",", 
       RowBox[{"{", "6", "}"}], ",", 
       RowBox[{"{", "7", "}"}], ",", 
       RowBox[{"{", "8", "}"}], ",", 
       RowBox[{"{", "9", "}"}], ",", 
       RowBox[{"{", "10", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"5", ",", "9"}], "}"}], ",", 
       RowBox[{"{", "7", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "10"}], "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "8"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "4", "}"}], ",", 
       RowBox[{"{", "5", "}"}], ",", 
       RowBox[{"{", "6", "}"}], ",", 
       RowBox[{"{", "7", "}"}], ",", 
       RowBox[{"{", "8", "}"}], ",", 
       RowBox[{"{", "9", "}"}], ",", 
       RowBox[{"{", "10", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "7", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "9", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "10"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6119208723618135`*^9, 3.611920880917739*^9}, 
   3.611921121672208*^9, 3.6119257225653768`*^9, {3.6261718500926085`*^9, 
   3.6261718605333567`*^9}, {3.6261734880908146`*^9, 3.6261734978212185`*^9}, 
   3.6263307072240915`*^9, 3.6263323038647165`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cmate", "[", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{3.6263323730834665`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6263323740209665`*^9, 3.6327396115550833`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1366, 702},
WindowMargins->{{Automatic, 29}, {Automatic, 200}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info173701274019-6163275"->{
  Cell[41169, 1000, 510, 8, 
  118, "Print", "ExpressionUUID" -> "25b6a92a-85a4-4a91-be56-0a47964460cf",
   CellTags->"Info173701274019-6163275"]},
 "Info183701274022-6163275"->{
  Cell[41840, 1017, 1271, 22, 
  105, "Print", "ExpressionUUID" -> "025f2664-3d7d-4cd0-ba98-46441fbe9ea3",
   CellTags->"Info183701274022-6163275"]},
 "Info803709215044-5870464"->{
  Cell[72459, 1793, 429, 8, 
  74, "Print", "ExpressionUUID" -> "b4a4bc67-b1b5-4574-b7cd-d294e556c194",
   CellTags->"Info803709215044-5870464"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info173701274019-6163275", 105225, 2676},
 {"Info183701274022-6163275", 105404, 2680},
 {"Info803709215044-5870464", 105585, 2684}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 249, 3, 82, "Section", "ExpressionUUID" -> \
"f78626e5-139a-4742-bc5d-e29f3b06d91e"],
Cell[CellGroupData[{
Cell[853, 29, 110, 1, 45, "Subsubsection", "ExpressionUUID" -> \
"905028fa-e5cb-4610-a833-cd4211872ad6"],
Cell[966, 32, 272, 5, 66, "Text", "ExpressionUUID" -> \
"389e86d7-d934-441a-a451-c2386b59c710"],
Cell[1241, 39, 179, 4, 46, "Input", "ExpressionUUID" -> \
"5f8106fa-cf27-40aa-a577-29b5abda6cd3"],
Cell[1423, 45, 148, 3, 41, "Input", "ExpressionUUID" -> \
"8ff8d5f8-f1c8-4920-9ee9-86ebf5949440"],
Cell[1574, 50, 192, 4, 41, "Input", "ExpressionUUID" -> \
"01eea030-8470-45b9-9500-c3aaf9d23462"],
Cell[CellGroupData[{
Cell[1791, 58, 380, 7, 41, "Input", "ExpressionUUID" -> \
"4d3021ef-1422-4ee8-bcd9-abdb45eee057"],
Cell[2174, 67, 211, 4, 41, "Output", "ExpressionUUID" -> \
"90819378-cf01-4a3f-b9d6-ec2760c38899"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2422, 76, 234, 6, 46, "Input", "ExpressionUUID" -> \
"2ac63eb2-db17-417a-8b1f-6d22c370239a"],
Cell[2659, 84, 223, 5, 41, "Output", "ExpressionUUID" -> \
"e861d8a5-28cb-4e84-bc8d-05721ca87fae"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2931, 95, 186, 2, 56, "Subsection", "ExpressionUUID" -> \
"99b91b11-44a3-4b01-bef3-dd2d7b32d980"],
Cell[3120, 99, 897, 20, 289, "Text", "ExpressionUUID" -> \
"90d27952-eadf-4470-82bd-a02791129150"],
Cell[4020, 121, 10435, 243, 1546, "Input", "ExpressionUUID" -> \
"f8cd007b-d202-42a7-a209-d1a9184507f2",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[14480, 368, 203, 3, 45, "Subsubsection", "ExpressionUUID" -> \
"7a4da267-5b82-4cd0-bbe9-afdc46addcec"],
Cell[14686, 373, 281, 4, 62, "Input", "ExpressionUUID" -> \
"49c22088-5c75-42a0-9b15-ddffe832eb1e"],
Cell[14970, 379, 251, 5, 62, "Input", "ExpressionUUID" -> \
"6cb370d0-b7e0-4891-83f9-ad9d0112ce9f"],
Cell[15224, 386, 670, 12, 107, "Input", "ExpressionUUID" -> \
"a52e075c-eeb0-4817-a77b-24a4d096e74d"],
Cell[15897, 400, 3004, 82, 282, "Input", "ExpressionUUID" -> \
"e7c03c8e-1db2-41f9-b23e-e447419137cb"],
Cell[18904, 484, 984, 28, 108, "Input", "ExpressionUUID" -> \
"456184f3-d0ab-47a5-a13a-f264bccb2204"],
Cell[19891, 514, 888, 22, 107, "Input", "ExpressionUUID" -> \
"29240c39-5f58-4679-9be9-86155ad39464"],
Cell[CellGroupData[{
Cell[20804, 540, 191, 3, 62, "Input", "ExpressionUUID" -> \
"9cf83715-58f4-4700-921b-f7457fc9d2ab"],
Cell[20998, 545, 707, 12, 62, "Output", "ExpressionUUID" -> \
"fd19220c-7af2-4d1a-a352-b9db1ed01650"]
}, Open  ]],
Cell[21720, 560, 1064, 22, 62, "Input", "ExpressionUUID" -> \
"202a30c2-5b0e-41d8-b441-f98832de686c"],
Cell[CellGroupData[{
Cell[22809, 586, 297, 6, 62, "Input", "ExpressionUUID" -> \
"a5bc2167-22c5-45a7-ae36-0c218c21c603"],
Cell[23109, 594, 1996, 39, 207, "Output", "ExpressionUUID" -> \
"3eb97235-5c65-49fd-8e6c-989fcf55a17a"]
}, Open  ]],
Cell[25120, 636, 1207, 25, 107, "Input", "ExpressionUUID" -> \
"c381ab44-7d2a-4be1-8cde-6bc5bcfc8d30"],
Cell[CellGroupData[{
Cell[26352, 665, 297, 6, 62, "Input", "ExpressionUUID" -> \
"c157a961-9578-4d7e-b829-260dd2ed699a"],
Cell[26652, 673, 2050, 40, 207, "Output", "ExpressionUUID" -> \
"1f9e42f0-9c85-4e7d-884f-2ba76ca54ce5"]
}, Open  ]],
Cell[28717, 716, 1259, 26, 107, "Input", "ExpressionUUID" -> \
"f914ca2c-088f-4e0f-af08-2538c6613576"],
Cell[CellGroupData[{
Cell[30001, 746, 299, 6, 62, "Input", "ExpressionUUID" -> \
"ab1f5d40-ceb2-4c64-8cfd-b5e2b00d4b40"],
Cell[30303, 754, 2094, 40, 207, "Output", "ExpressionUUID" -> \
"dc19647f-9955-42ce-96ca-7ab238e21abe"]
}, Open  ]],
Cell[32412, 797, 1517, 31, 151, "Input", "ExpressionUUID" -> \
"f171b52d-deab-4676-991c-4b55758c5755"],
Cell[CellGroupData[{
Cell[33954, 832, 299, 6, 62, "Input", "ExpressionUUID" -> \
"933ca1b8-be28-41a3-81f2-e7aaf46b8b34"],
Cell[34256, 840, 2094, 40, 207, "Output", "ExpressionUUID" -> \
"d1513ba2-9117-4bda-a8f9-e199d25511f6"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36411, 887, 144, 1, 56, "Subsection", "ExpressionUUID" -> \
"c6d7d15a-c653-4742-9e1e-4267956eb323"],
Cell[36558, 890, 165, 2, 40, "Text", "ExpressionUUID" -> \
"432673d9-e0ea-43f3-8a71-8a04c2c024f3"],
Cell[36726, 894, 4294, 98, 839, "Input", "ExpressionUUID" -> \
"f81cb481-8ef7-46f3-ad04-80fc01eb88db",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[41045, 996, 121, 2, 41, "Input", "ExpressionUUID" -> \
"a5f2eb8f-5ca0-4f1f-8e53-5cd5f9b5d1de"],
Cell[41169, 1000, 510, 8, 118, "Print", "ExpressionUUID" -> \
"25b6a92a-85a4-4a91-be56-0a47964460cf",
 CellTags->"Info173701274019-6163275"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41716, 1013, 121, 2, 41, "Input", "ExpressionUUID" -> \
"b01cb502-2fd8-46b9-bbe1-468d2ffe868b"],
Cell[41840, 1017, 1271, 22, 105, "Print", "ExpressionUUID" -> \
"025f2664-3d7d-4cd0-ba98-46441fbe9ea3",
 CellTags->"Info183701274022-6163275"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43148, 1044, 102, 1, 45, "Subsubsection", "ExpressionUUID" -> \
"22aaa0a3-4876-420b-bb61-4a7662da46ae"],
Cell[CellGroupData[{
Cell[43275, 1049, 337, 6, 50, "Input", "ExpressionUUID" -> \
"a2cbd5e5-30fa-4e17-9fcf-78fcbf84017b"],
Cell[43615, 1057, 716, 11, 50, "Output", "ExpressionUUID" -> \
"6342ce5e-e21d-4d35-aaa3-0786124df5b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44368, 1073, 348, 6, 50, "Input", "ExpressionUUID" -> \
"4565158b-3866-4f26-8df3-864016e4fe6e"],
Cell[44719, 1081, 2380, 34, 50, "Output", "ExpressionUUID" -> \
"5048fa6b-ffb1-4334-a6a9-9582f3f57549"]
}, Open  ]],
Cell[47114, 1118, 137, 2, 50, "Input", "ExpressionUUID" -> \
"5a01fee5-9bee-40f3-aaa5-5ecf646f7bc9"],
Cell[47254, 1122, 776, 18, 87, "Input", "ExpressionUUID" -> \
"6b4d9ebf-fc7a-4f75-91f6-b694935cb6f2"],
Cell[48033, 1142, 459, 10, 50, "Input", "ExpressionUUID" -> \
"48bea210-857e-4ed7-84eb-3becfaec64d1"],
Cell[48495, 1154, 275, 5, 83, "Text", "ExpressionUUID" -> \
"bfd87bfc-48eb-4ac7-a142-86fbc006d3d7"],
Cell[48773, 1161, 470, 12, 50, "Input", "ExpressionUUID" -> \
"8256e029-db1d-43a1-853a-30d2753f9ff8"],
Cell[CellGroupData[{
Cell[49268, 1177, 488, 9, 50, "Input", "ExpressionUUID" -> \
"e255f3d9-c0af-47f7-ae7b-e6c295edb8f1"],
Cell[49759, 1188, 5192, 133, 366, "Output", "ExpressionUUID" -> \
"9f9cfc59-8ac3-4dc8-a20c-01dbb0bc3bc1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54988, 1326, 906, 23, 86, "Input", "ExpressionUUID" -> \
"ef72a914-141a-4a32-8d01-942030740d04"],
Cell[55897, 1351, 5212, 133, 366, "Output", "ExpressionUUID" -> \
"eae56dec-b654-4818-a776-7930ae52da4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61146, 1489, 196, 3, 50, "Input", "ExpressionUUID" -> \
"33f8daf9-573d-4a48-80f0-950f82d05d23"],
Cell[61345, 1494, 294, 5, 50, "Output", "ExpressionUUID" -> \
"7fab9252-ac29-4c73-a96e-4e9933da6fb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61676, 1504, 1500, 37, 121, "Input", "ExpressionUUID" -> \
"cf1aebb7-1789-4385-9bc1-06db0a7e2ad5"],
Cell[63179, 1543, 5186, 132, 366, "Output", "ExpressionUUID" -> \
"fc948df4-c833-49b3-b5d0-f868c03831d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68402, 1680, 135, 2, 50, "Input", "ExpressionUUID" -> \
"088bab4a-0686-47d7-8043-ffea27e22f0b"],
Cell[68540, 1684, 1197, 32, 86, "Output", "ExpressionUUID" -> \
"88764094-bfe4-4756-9463-430df4b347a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69774, 1721, 141, 2, 50, "Input", "ExpressionUUID" -> \
"94fa2de7-600d-475b-8181-dfb471ee12bb"],
Cell[69918, 1725, 144, 2, 50, "Output", "ExpressionUUID" -> \
"36aac58a-65e0-48e6-8fce-eafa860d6193"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70123, 1734, 232, 4, 56, "Subsection", "ExpressionUUID" -> \
"153c495d-37d9-4f44-bd76-8bc2d1b9d84b"],
Cell[70358, 1740, 1898, 43, 300, "Input", "ExpressionUUID" -> \
"8e9d0655-4c11-4243-baa8-3fd8eeb0c0bc",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[72281, 1787, 175, 4, 41, "Input", "ExpressionUUID" -> \
"c89b1647-73c3-4d16-ad21-d6a44b6e7f80"],
Cell[72459, 1793, 429, 8, 74, "Print", "ExpressionUUID" -> \
"b4a4bc67-b1b5-4574-b7cd-d294e556c194",
 CellTags->"Info803709215044-5870464"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72925, 1806, 163, 3, 45, "Subsubsection", "ExpressionUUID" -> \
"c39a64d4-77e9-402b-affc-ff2e83803795"],
Cell[CellGroupData[{
Cell[73113, 1813, 5614, 139, 350, "Input", "ExpressionUUID" -> \
"b931bed6-1679-402b-88a5-321eafe27cb0"],
Cell[78730, 1954, 1297, 29, 271, "Output", "ExpressionUUID" -> \
"ccb99b3d-c971-4e59-ab82-8f5fa9e14cf8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80064, 1988, 466, 10, 46, "Input", "ExpressionUUID" -> \
"3e5c0fc8-b34e-4142-87b6-6eec33d0b131"],
Cell[80533, 2000, 554, 11, 41, "Output", "ExpressionUUID" -> \
"7560fa21-4b19-45db-9734-643dcc0116e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81124, 2016, 480, 11, 46, "Input", "ExpressionUUID" -> \
"372ebddd-bbfb-4680-9307-00f27576cd2e"],
Cell[81607, 2029, 525, 11, 41, "Output", "ExpressionUUID" -> \
"189fcd6c-c661-454d-93f9-2cb53a6785fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82169, 2045, 355, 9, 41, "Input", "ExpressionUUID" -> \
"dd1328b4-5c4d-485a-84b6-138e76a2c7ba"],
Cell[82527, 2056, 827, 20, 41, "Output", "ExpressionUUID" -> \
"d3d2f066-7ddb-4d43-a5ce-2974016cd081"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83391, 2081, 420, 11, 41, "Input", "ExpressionUUID" -> \
"726611b9-55ea-46ce-96f9-f91d963c1eff"],
Cell[83814, 2094, 824, 20, 41, "Output", "ExpressionUUID" -> \
"eeb56bb5-1fa7-43f2-8c67-f2dff1fb8f03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84675, 2119, 220, 4, 46, "Input", "ExpressionUUID" -> \
"4f0afdfd-8b1d-4f91-ab07-7fbe0c9b8f2a"],
Cell[84898, 2125, 1415, 37, 77, "Output", "ExpressionUUID" -> \
"f91b14e2-efb6-432e-81f3-d9d7b5575b79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86350, 2167, 157, 3, 41, "Input", "ExpressionUUID" -> \
"3fc529a3-d722-4804-965d-e2fd0785b1a1"],
Cell[86510, 2172, 1339, 36, 77, "Output", "ExpressionUUID" -> \
"6c683919-a005-4293-b1b6-ca490af65653"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87910, 2215, 622, 10, 56, "Subsection", "ExpressionUUID" -> \
"47f427c8-e615-45d0-846b-f8051500f09f"],
Cell[88535, 2227, 2441, 46, 403, "Input", "ExpressionUUID" -> \
"2f37a1fc-db03-4cd6-a848-9dedf9a0e3b0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[91001, 2277, 100, 1, 45, "Subsubsection", "ExpressionUUID" -> \
"2d9d64b0-c525-47fd-a371-f94a48c7d069"],
Cell[CellGroupData[{
Cell[91126, 2282, 164, 3, 46, "Input", "ExpressionUUID" -> \
"00f14698-5627-467d-928f-308f710d1951"],
Cell[91293, 2287, 2511, 71, 98, "Output", "ExpressionUUID" -> \
"a08f5bf8-f8cd-4740-8f30-d27f8c9ecce4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93841, 2363, 1266, 28, 294, "Input", "ExpressionUUID" -> \
"896a192d-02f8-41af-a167-f5a75326ed79"],
Cell[95110, 2393, 686, 21, 41, "Output", "ExpressionUUID" -> \
"7aeb4431-f416-48a2-a30e-78114e7ea35e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95857, 2421, 660, 9, 56, "Subsection", "ExpressionUUID" -> \
"c1f7b227-365d-4b2e-8ab5-3316d2540358"],
Cell[96520, 2432, 2923, 59, 519, "Input", "ExpressionUUID" -> \
"a0ce6c97-9887-448b-bee0-f98a7ec212a0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[99468, 2495, 100, 1, 45, "Subsubsection", "ExpressionUUID" -> \
"5e175f28-bf4e-48a2-805c-8136163ba9fd"],
Cell[CellGroupData[{
Cell[99593, 2500, 162, 3, 46, "Input", "ExpressionUUID" -> \
"55909e58-09bb-4794-848b-2b36ee5ee4de"],
Cell[99758, 2505, 3204, 93, 98, "Output", "ExpressionUUID" -> \
"9281f64c-c450-4841-82b8-c005f6d2e5c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102999, 2603, 913, 23, 294, "Input", "ExpressionUUID" -> \
"909578f0-b2cd-4c9e-a1b4-e8440c7e5482"],
Cell[103915, 2628, 880, 29, 41, "Output", "ExpressionUUID" -> \
"5959beb4-3703-4ff3-b5e1-7d8c70d5c3b6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

