(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    113957,       3130]
NotebookOptionsPosition[    108069,       2924]
NotebookOutlinePosition[    108461,       2941]
CellTagsIndexPosition[    108418,       2938]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["modifydata.nb", "Section",
 CellChangeTimes->{{3.62600628385137*^9, 3.626006284835745*^9}, {
  3.6260709487170696`*^9, 3.6260709533480415`*^9}, {3.626096953477417*^9, 
  3.6260969551364455`*^9}, {3.6385979441998763`*^9, 3.6385979449967513`*^9}, {
  3.639320178276136*^9, 3.6393201843042994`*^9}}],

Cell[CellGroupData[{

Cell["For the Developer", "Subsubsection",
 CellChangeTimes->{{3.5819225877880845`*^9, 3.581922592443351*^9}}],

Cell["\<\
AutoGeneratedPackage is an option for notebooks that specifies whether a \
package is automatically created when a notebook that contains initialization \
cells or groups is saved.\
\>", "Text",
 CellChangeTimes->{{3.5808982533077106`*^9, 3.580898259632072*^9}}],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816697178146343`*^9, 3.581669717815634*^9}}],

Cell[BoxData[
 RowBox[{"ClearSystemCache", "[", "]"}]], "Input",
 CellChangeTimes->{{3.581669726757145*^9, 3.5816697379287844`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"directory", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.6392064512024283`*^9, 3.6392064555015736`*^9}, {
  3.6392064862997465`*^9, 3.6392065233606443`*^9}, {3.6392250169707823`*^9, 
  3.6392250177207823`*^9}, {3.6535358489289207`*^9, 3.653535855296494*^9}}],

Cell[BoxData["\<\"/home/tchr/Projects/Mathematica-MSE/library/\"\>"], "Output",
 CellChangeTimes->{3.6535358608398933`*^9, 3.686929203726038*^9, 
  3.686930821364958*^9, 3.686931006815919*^9, 3.686936864604438*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"\"\<mse.m\>\"", ",", 
   RowBox[{"Path", "\[Rule]", "directory"}]}], "]"}]], "Input",
 CellChangeTimes->{3.653535866321363*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"99328640", ",", "84049824", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.653535866999463*^9, 3.6869292064743853`*^9, 
  3.686930822073544*^9, 3.686931008094768*^9, 3.686936866702326*^9}]
}, Open  ]],

Cell["\<\
Global Variables:
directory, header,noM,noU,noD,noAttr,distanceMatrices,matchMatrix,mate,
payoffMatrix, 
storedpayoffMatrix,
storedmatchMatrix,
currentquotas,
payoffMatrixTEST,offset\
\>", "Text",
 CellChangeTimes->{{3.686936783380797*^9, 3.686936828517181*^9}, {
  3.686936883455488*^9, 3.6869369401671247`*^9}, {3.686936992475047*^9, 
  3.6869370087416697`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Code & Examples", "Subsection",
 CellChangeTimes->{{3.6385979918248763`*^9, 3.6385979933717513`*^9}, {
  3.6385980689811263`*^9, 3.6385980704186263`*^9}, {3.6392093938614073`*^9, 
  3.6392093984395323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "header", ",", "noM", ",", "noU", ",", "noD", ",", "noAttr", ",", 
    "distanceMatrices", ",", "matchMatrix", ",", "mate"}], "}"}], "=", 
  RowBox[{"import", "[", 
   RowBox[{
    RowBox[{
    "directory", "<>", "\"\<import/\>\"", "<>", 
     "\"\<precomp_proof.xlsx\>\""}], ",", "\"\<precomp\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.686929191134601*^9, 3.686929199500938*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"m\"\>", ",", "\<\"u\"\>", ",", "\<\"d\"\>", 
     ",", "\<\"a1\"\>", ",", "\<\"a2\"\>", ",", "\<\"a3\"\>", 
     ",", "\<\"match\"\>"}], "}"}], ",", "3", ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", "3", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\<\"d111_1\"\>", ",", "\<\"d111_2\"\>", 
           ",", "\<\"d111_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d112_1\"\>", ",", "\<\"d112_2\"\>", 
           ",", "\<\"d112_3\"\>"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\<\"d121_1\"\>", ",", "\<\"d121_2\"\>", 
           ",", "\<\"d121_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d122_1\"\>", ",", "\<\"d122_2\"\>", 
           ",", "\<\"d122_3\"\>"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\<\"d131_1\"\>", ",", "\<\"d131_2\"\>", 
           ",", "\<\"d131_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d132_1\"\>", ",", "\<\"d132_2\"\>", 
           ",", "\<\"d132_3\"\>"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\<\"d211_1\"\>", ",", "\<\"d211_2\"\>", 
           ",", "\<\"d211_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d212_1\"\>", ",", "\<\"d212_2\"\>", 
           ",", "\<\"d212_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d213_1\"\>", ",", "\<\"d213_2\"\>", 
           ",", "\<\"d213_3\"\>"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"d221_1\"\>", ",", "\<\"d221_2\"\>", 
           ",", "\<\"d221_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d222_1\"\>", ",", "\<\"d222_2\"\>", 
           ",", "\<\"d222_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d223_1\"\>", ",", "\<\"d223_2\"\>", 
           ",", "\<\"d223_3\"\>"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\<\"d311_1\"\>", ",", "\<\"d311_2\"\>", 
           ",", "\<\"d311_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d312_1\"\>", ",", "\<\"d312_2\"\>", 
           ",", "\<\"d312_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d313_1\"\>", ",", "\<\"d313_2\"\>", 
           ",", "\<\"d313_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d314_1\"\>", ",", "\<\"d314_2\"\>", 
           ",", "\<\"d314_3\"\>"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\<\"d321_1\"\>", ",", "\<\"d321_2\"\>", 
           ",", "\<\"d321_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d322_1\"\>", ",", "\<\"d322_2\"\>", 
           ",", "\<\"d322_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d323_1\"\>", ",", "\<\"d323_2\"\>", 
           ",", "\<\"d323_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d324_1\"\>", ",", "\<\"d324_2\"\>", 
           ",", "\<\"d324_3\"\>"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\<\"d331_1\"\>", ",", "\<\"d331_2\"\>", 
           ",", "\<\"d331_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d332_1\"\>", ",", "\<\"d332_2\"\>", 
           ",", "\<\"d332_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d333_1\"\>", ",", "\<\"d333_2\"\>", 
           ",", "\<\"d333_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d334_1\"\>", ",", "\<\"d334_2\"\>", 
           ",", "\<\"d334_3\"\>"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\<\"d341_1\"\>", ",", "\<\"d341_2\"\>", 
           ",", "\<\"d341_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d342_1\"\>", ",", "\<\"d342_2\"\>", 
           ",", "\<\"d342_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d343_1\"\>", ",", "\<\"d343_2\"\>", 
           ",", "\<\"d343_3\"\>"}], "}"}], ",", 
         RowBox[{"{", 
          
          RowBox[{"\<\"d344_1\"\>", ",", "\<\"d344_2\"\>", 
           ",", "\<\"d344_3\"\>"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6261699630234623`*^9, {3.626170418041931*^9, 3.626170436202551*^9}, 
   3.6261734223975024`*^9, 3.6261734532695274`*^9, 3.6263317512397165`*^9, 
   3.6328506642490873`*^9, 3.6328930580781555`*^9, 3.632931712389413*^9, 
   3.632933007862385*^9, 3.638591924266164*^9, 3.6385968871431885`*^9, 
   3.6385984236178455`*^9, 3.6385985589303455`*^9, 3.6392065315438323`*^9, 
   3.6392250223770323`*^9, 3.653535873633078*^9, 3.6869292094360037`*^9, 
   3.686930822287695*^9, 3.686931010702362*^9, 3.686936875407168*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix", "=", 
  RowBox[{"CpayoffMatrix", "[", 
   RowBox[{"payoffDM", ",", "noM", ",", "noU", ",", "noD"}], "]"}]}]], "Input",
 CellChangeTimes->{3.626171586031844*^9, 3.626172819674096*^9, 
  3.6261729763817234`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d111_1\"\>", "+", 
        RowBox[{"\<\"d111_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d111_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d112_1\"\>", "+", 
        RowBox[{"\<\"d112_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d112_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d121_1\"\>", "+", 
        RowBox[{"\<\"d121_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d121_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d122_1\"\>", "+", 
        RowBox[{"\<\"d122_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d122_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d131_1\"\>", "+", 
        RowBox[{"\<\"d131_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d131_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d132_1\"\>", "+", 
        RowBox[{"\<\"d132_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d132_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d211_1\"\>", "+", 
        RowBox[{"\<\"d211_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d211_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d212_1\"\>", "+", 
        RowBox[{"\<\"d212_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d212_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d213_1\"\>", "+", 
        RowBox[{"\<\"d213_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d213_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d221_1\"\>", "+", 
        RowBox[{"\<\"d221_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d221_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d222_1\"\>", "+", 
        RowBox[{"\<\"d222_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d222_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d223_1\"\>", "+", 
        RowBox[{"\<\"d223_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d223_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d311_1\"\>", "+", 
        RowBox[{"\<\"d311_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d311_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d312_1\"\>", "+", 
        RowBox[{"\<\"d312_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d312_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d313_1\"\>", "+", 
        RowBox[{"\<\"d313_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d313_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d314_1\"\>", "+", 
        RowBox[{"\<\"d314_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d314_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d321_1\"\>", "+", 
        RowBox[{"\<\"d321_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d321_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d322_1\"\>", "+", 
        RowBox[{"\<\"d322_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d322_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d323_1\"\>", "+", 
        RowBox[{"\<\"d323_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d323_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d324_1\"\>", "+", 
        RowBox[{"\<\"d324_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d324_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d331_1\"\>", "+", 
        RowBox[{"\<\"d331_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d331_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d332_1\"\>", "+", 
        RowBox[{"\<\"d332_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d332_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d333_1\"\>", "+", 
        RowBox[{"\<\"d333_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d333_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d334_1\"\>", "+", 
        RowBox[{"\<\"d334_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d334_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d341_1\"\>", "+", 
        RowBox[{"\<\"d341_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d341_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d342_1\"\>", "+", 
        RowBox[{"\<\"d342_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d342_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d343_1\"\>", "+", 
        RowBox[{"\<\"d343_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d343_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d344_1\"\>", "+", 
        RowBox[{"\<\"d344_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d344_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.626170530374075*^9, 3.626173422574032*^9, 
  3.6261734533624926`*^9, 3.6263317703490915`*^9, 3.6263318433647165`*^9, 
  3.6328507171121535`*^9, 3.632893063661786*^9, 3.6329317852626963`*^9, 
  3.632933019830291*^9, 3.638591992172659*^9, 3.638596899229884*^9, 
  3.6385985589459705`*^9, 3.6392065324655237`*^9, 3.6392250233457823`*^9, 
  3.653535880304591*^9, 3.686929213696899*^9, 3.686930822390349*^9, 
  3.68693101177462*^9, 3.686936877318942*^9}]
}, Open  ]],

Cell["\<\
In several cases we need to remove some individuals from a specific or \
several markets. In that way we can assess how they affect the total payoff.\
\>", "Text",
 CellChangeTimes->{{3.6329325031180043`*^9, 3.6329325739354687`*^9}, {
  3.63293262011125*^9, 3.632932638031172*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "@", 
  RowBox[{"{", 
   RowBox[{"noU", ",", "noD"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6328519345728016`*^9, 3.632851944483059*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6328519452200336`*^9, 3.6329318008027716`*^9, 
  3.632933024692831*^9, 3.638592030027366*^9, 3.6385969063944254`*^9, 
  3.6385985589615955`*^9, 3.6392065353854523`*^9, 3.6392250258770323`*^9, 
  3.65353588638596*^9, 3.686929215454955*^9, 3.686930822610055*^9, 
  3.686931013595476*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "payoffMatrix"}]], "Input",
 CellChangeTimes->{{3.632851841461672*^9, 3.6328518483327656`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6328518488220234`*^9, 3.632907690502166*^9, 
  3.632931801500801*^9, 3.632933025814063*^9, 3.638592031303516*^9, 
  3.6385969074228125`*^9, 3.6385985589615955`*^9, 3.63920653596914*^9, 
  3.6392250267520323`*^9, 3.6535358876293173`*^9, 3.686929217381192*^9, 
  3.686930822690593*^9, 3.686931014445388*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixForm", "/@", "payoffMatrix"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.632851586842531*^9, 3.6328515985759296`*^9}, {
  3.6328519899532976`*^9, 3.6328520326407976`*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{"\<\"d111_1\"\>", "+", 
            RowBox[{"\<\"d111_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d111_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d112_1\"\>", "+", 
            RowBox[{"\<\"d112_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d112_3\"\>", " ", "x2"}]}]},
          {
           RowBox[{"\<\"d121_1\"\>", "+", 
            RowBox[{"\<\"d121_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d121_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d122_1\"\>", "+", 
            RowBox[{"\<\"d122_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d122_3\"\>", " ", "x2"}]}]},
          {
           RowBox[{"\<\"d131_1\"\>", "+", 
            RowBox[{"\<\"d131_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d131_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d132_1\"\>", "+", 
            RowBox[{"\<\"d132_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d132_3\"\>", " ", "x2"}]}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]},
     {
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{"\<\"d211_1\"\>", "+", 
            RowBox[{"\<\"d211_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d211_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d212_1\"\>", "+", 
            RowBox[{"\<\"d212_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d212_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d213_1\"\>", "+", 
            RowBox[{"\<\"d213_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d213_3\"\>", " ", "x2"}]}]},
          {
           RowBox[{"\<\"d221_1\"\>", "+", 
            RowBox[{"\<\"d221_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d221_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d222_1\"\>", "+", 
            RowBox[{"\<\"d222_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d222_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d223_1\"\>", "+", 
            RowBox[{"\<\"d223_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d223_3\"\>", " ", "x2"}]}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]},
     {
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{"\<\"d311_1\"\>", "+", 
            RowBox[{"\<\"d311_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d311_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d312_1\"\>", "+", 
            RowBox[{"\<\"d312_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d312_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d313_1\"\>", "+", 
            RowBox[{"\<\"d313_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d313_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d314_1\"\>", "+", 
            RowBox[{"\<\"d314_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d314_3\"\>", " ", "x2"}]}]},
          {
           RowBox[{"\<\"d321_1\"\>", "+", 
            RowBox[{"\<\"d321_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d321_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d322_1\"\>", "+", 
            RowBox[{"\<\"d322_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d322_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d323_1\"\>", "+", 
            RowBox[{"\<\"d323_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d323_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d324_1\"\>", "+", 
            RowBox[{"\<\"d324_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d324_3\"\>", " ", "x2"}]}]},
          {
           RowBox[{"\<\"d331_1\"\>", "+", 
            RowBox[{"\<\"d331_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d331_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d332_1\"\>", "+", 
            RowBox[{"\<\"d332_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d332_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d333_1\"\>", "+", 
            RowBox[{"\<\"d333_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d333_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d334_1\"\>", "+", 
            RowBox[{"\<\"d334_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d334_3\"\>", " ", "x2"}]}]},
          {
           RowBox[{"\<\"d341_1\"\>", "+", 
            RowBox[{"\<\"d341_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d341_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d342_1\"\>", "+", 
            RowBox[{"\<\"d342_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d342_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d343_1\"\>", "+", 
            RowBox[{"\<\"d343_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d343_3\"\>", " ", "x2"}]}], 
           RowBox[{"\<\"d344_1\"\>", "+", 
            RowBox[{"\<\"d344_2\"\>", " ", "x1"}], "+", 
            RowBox[{"\<\"d344_3\"\>", " ", "x2"}]}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6328515996364765`*^9, {3.6328519945001726`*^9, 3.6328520331095476`*^9}, 
   3.6329076884134407`*^9, 3.6329318023022785`*^9, 3.632933027272191*^9, 
   3.638592034206004*^9, 3.638596908789725*^9, 3.6385985589772205`*^9, 
   3.639206536639935*^9, 3.6392250275645323`*^9, 3.653535891822194*^9, 
   3.6869292211808033`*^9, 3.686930822880148*^9, 3.686931016402269*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["payoffMatrix"], "Input",
 CellChangeTimes->{{3.6328522268595476`*^9, 3.6328522303439226`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d111_1\"\>", "+", 
        RowBox[{"\<\"d111_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d111_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d112_1\"\>", "+", 
        RowBox[{"\<\"d112_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d112_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d121_1\"\>", "+", 
        RowBox[{"\<\"d121_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d121_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d122_1\"\>", "+", 
        RowBox[{"\<\"d122_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d122_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d131_1\"\>", "+", 
        RowBox[{"\<\"d131_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d131_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d132_1\"\>", "+", 
        RowBox[{"\<\"d132_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d132_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d211_1\"\>", "+", 
        RowBox[{"\<\"d211_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d211_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d212_1\"\>", "+", 
        RowBox[{"\<\"d212_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d212_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d213_1\"\>", "+", 
        RowBox[{"\<\"d213_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d213_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d221_1\"\>", "+", 
        RowBox[{"\<\"d221_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d221_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d222_1\"\>", "+", 
        RowBox[{"\<\"d222_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d222_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d223_1\"\>", "+", 
        RowBox[{"\<\"d223_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d223_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d311_1\"\>", "+", 
        RowBox[{"\<\"d311_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d311_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d312_1\"\>", "+", 
        RowBox[{"\<\"d312_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d312_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d313_1\"\>", "+", 
        RowBox[{"\<\"d313_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d313_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d314_1\"\>", "+", 
        RowBox[{"\<\"d314_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d314_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d321_1\"\>", "+", 
        RowBox[{"\<\"d321_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d321_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d322_1\"\>", "+", 
        RowBox[{"\<\"d322_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d322_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d323_1\"\>", "+", 
        RowBox[{"\<\"d323_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d323_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d324_1\"\>", "+", 
        RowBox[{"\<\"d324_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d324_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d331_1\"\>", "+", 
        RowBox[{"\<\"d331_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d331_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d332_1\"\>", "+", 
        RowBox[{"\<\"d332_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d332_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d333_1\"\>", "+", 
        RowBox[{"\<\"d333_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d333_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d334_1\"\>", "+", 
        RowBox[{"\<\"d334_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d334_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d341_1\"\>", "+", 
        RowBox[{"\<\"d341_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d341_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d342_1\"\>", "+", 
        RowBox[{"\<\"d342_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d342_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d343_1\"\>", "+", 
        RowBox[{"\<\"d343_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d343_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d344_1\"\>", "+", 
        RowBox[{"\<\"d344_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d344_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6328522308751726`*^9, 3.6328536544220476`*^9, 
  3.632893044448406*^9, 3.632907684892725*^9, 3.6329318038157835`*^9, 
  3.6329330288819227`*^9, 3.63859203911588*^9, 3.63859691014979*^9, 
  3.6385985589928455`*^9, 3.639206537640543*^9, 3.6392250286895323`*^9, 
  3.653535894335677*^9, 3.686929221944806*^9, 3.686930822887501*^9, 
  3.6869310181389513`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"quotas", "[", "matchMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.6869292247531433`*^9, 3.6869292411386433`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "2", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "3", ",", "2"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.686929241702742*^9, 3.686930822954411*^9, 
  3.686931020065798*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"store", ",", "restore"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"store", "::", "usage"}], "=", 
   "\"\<store[] is used for storing the lists payoffMatrix and matchMatrix \
before they are modified. In that case they can restored later (with the \
restore[] command).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"store", "[", 
    RowBox[{"printflag_:", "True"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       StyleBox["storedpayoffMatrix",
        Background->RGBColor[1, 1, 0]], "=", "payoffMatrix"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["storedmatchMatrix",
        Background->RGBColor[1, 1, 0]], "=", "matchMatrix"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["currentquotas",
        Background->RGBColor[1, 1, 0]], "=", 
       RowBox[{"quotas", "@", "matchMatrix"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\< storedpayoffMatrix=payoffMatrix\\n storedmatchMatrix=matchMatrix\
\\n currentquotas=quotas@matchMatrix\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"restore", "::", "usage"}], "=", 
   "\"\<restore[] is used to restore the lists payoffMatrix and matchMatrix \
mate to their original (when the last store[] command was used)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"restore", "[", 
    RowBox[{"printflag_:", "False"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       StyleBox["payoffMatrix",
        Background->RGBColor[1, 1, 0]], "=", "storedpayoffMatrix"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["matchMatrix",
        Background->RGBColor[1, 1, 0]], "=", "storedmatchMatrix"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["currentquotas",
        Background->RGBColor[1, 1, 0]], "=", 
       RowBox[{"quotas", "@", "matchMatrix"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"printflag", ",", 
        RowBox[{
        "Print", "[", 
         "\"\< payoffMatrix and matchMatrix have been restored!\>\"", "]"}]}],
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6392068247294497`*^9, 3.639207145676154*^9}, {
   3.639207487553937*^9, 3.639207685176422*^9}, {3.639207745252594*^9, 
   3.639207813277017*^9}, {3.6393024855876837`*^9, 3.639302543616435*^9}, {
   3.6393138554628053`*^9, 3.639313873392329*^9}, {3.686929249481617*^9, 
   3.6869292705470743`*^9}, 3.686929306642232*^9, {3.68692935035732*^9, 
   3.6869294931567297`*^9}, {3.6869296032410383`*^9, 
   3.6869296033833103`*^9}, {3.686930647648005*^9, 3.686930663093301*^9}, {
   3.6869307232291822`*^9, 3.686930745950575*^9}, {3.6869351562899313`*^9, 
   3.686935201471002*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"store", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6869294987915154`*^9, 3.686929507421185*^9}}],

Cell[BoxData["\<\" storedpayoffMatrix=payoffMatrix\\n \
storedmatchMatrix=matchMatrix\\n currentquotas=quotas@matchMatrix\"\>"], \
"Print",
 CellChangeTimes->{3.686929508343115*^9, 3.6869296051032887`*^9, 
  3.6869299786506367`*^9, 3.686930572201391*^9, 3.6869307274726057`*^9, 
  3.686930823023613*^9, 3.6869310301143084`*^9, 3.686936964253907*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"restore", "[", "]"}]], "Input",
 CellChangeTimes->{{3.639207175632209*^9, 3.6392071764769354`*^9}, {
  3.6392072701339192`*^9, 3.6392072756892643`*^9}, {3.6392077960172424`*^9, 
  3.6392077960455627`*^9}, {3.686929539639091*^9, 3.6869295413095293`*^9}}],

Cell[BoxData["\<\" payoffMatrix and matchMatrix have been restored!\"\>"], \
"Print",
 CellChangeTimes->{
  3.686929542789872*^9, 3.686929975166958*^9, 3.686930568534293*^9, 
   3.686930728205083*^9, {3.686930811415215*^9, 3.686930823129135*^9}, 
   3.686931031099881*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "removeU", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeU", "::", "usage"}], "=", 
   "\"\<removeU[m_,u_List,match_:False] removes from the payoffMatrix's \
market m the upstreams that are included in the list u. If the match flag is \
set to True then they are removed also from the matchMatrix. This is \
preferred on the precomputed case where we do not have to change noU and noD \
lists.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeU", "[", 
    RowBox[{"m_", ",", "u_List", ",", 
     RowBox[{"match_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "keep", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"keep", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{"payoffMatrix", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "u"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"payoffMatrix", "[", 
        RowBox[{"[", "m", "]"}], "]"}], "=", 
       RowBox[{"payoffMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "keep"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"currentquotas", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "m"}], "]"}], "]"}], "=", 
       RowBox[{"currentquotas", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "m", ",", "keep"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"match", ",", 
        RowBox[{
         RowBox[{"matchMatrix", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "=", 
         RowBox[{"matchMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "keep"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6328520699689226`*^9, 3.6328520753595476`*^9}, {
   3.6328521130782976`*^9, 3.6328521150470476`*^9}, {3.6328521626251726`*^9, 
   3.6328522040470476`*^9}, {3.6328532282189226`*^9, 
   3.6328533037657976`*^9}, {3.6328534886876726`*^9, 
   3.6328535104376726`*^9}, {3.6328928664689727`*^9, 
   3.6328929266632504`*^9}, {3.6328929685441093`*^9, 
   3.6328929765079765`*^9}, {3.632908932389927*^9, 3.632908953300083*^9}, {
   3.632908983934849*^9, 3.6329090031965675`*^9}, {3.6329090374885597`*^9, 
   3.632909053037388*^9}, {3.6329326892167187`*^9, 3.632932922538721*^9}, {
   3.6329333340352297`*^9, 3.6329333408057375`*^9}, {3.6392251718614073`*^9, 
   3.6392251724239073`*^9}, {3.686929894619204*^9, 3.686929900557266*^9}, 
   3.686930406027337*^9, {3.686930458339118*^9, 3.68693056228625*^9}, {
   3.6869306708597116`*^9, 3.6869306793529453`*^9}, 3.686930862461831*^9},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell[BoxData["currentquotas"], "Input",
 CellChangeTimes->{{3.686929984498309*^9, 3.686930016409659*^9}, {
  3.686930108861974*^9, 3.6869301098374567`*^9}, {3.6869310413328457`*^9, 
  3.686931044724804*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "2", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "3", ",", "2"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.686929992384515*^9, 3.686930110231583*^9, {3.686930802339082*^9, 
   3.68693082327684*^9}, 3.686931045567976*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Attention", " ", ":", " ", 
    RowBox[{
    "removeU", " ", "removes", " ", "rows", " ", "and", " ", "removeD", " ", 
     "removes", " ", 
     RowBox[{"columns", ".", " ", "They"}], " ", "are", " ", 
     RowBox[{"interchangeable", "!"}]}]}], "*)"}], " "}]], "Input",
 CellChangeTimes->{{3.63859695014544*^9, 3.6385970235521393`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"removeU", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", "True"}], "]"}], ";", 
  "payoffMatrix"}]], "Input",
 CellChangeTimes->{{3.6328535767345476`*^9, 3.6328536109689226`*^9}, 
   3.6328536432657976`*^9, {3.6328930209366875`*^9, 3.6328930213429375`*^9}, {
   3.6329077194971213`*^9, 3.632907752836935*^9}, {3.632909067061802*^9, 
   3.6329090682707863`*^9}, {3.6329333761143312`*^9, 3.6329333775225344`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d111_1\"\>", "+", 
        RowBox[{"\<\"d111_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d111_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d112_1\"\>", "+", 
        RowBox[{"\<\"d112_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d112_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d121_1\"\>", "+", 
        RowBox[{"\<\"d121_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d121_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d122_1\"\>", "+", 
        RowBox[{"\<\"d122_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d122_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d131_1\"\>", "+", 
        RowBox[{"\<\"d131_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d131_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d132_1\"\>", "+", 
        RowBox[{"\<\"d132_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d132_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d211_1\"\>", "+", 
        RowBox[{"\<\"d211_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d211_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d212_1\"\>", "+", 
        RowBox[{"\<\"d212_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d212_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d213_1\"\>", "+", 
        RowBox[{"\<\"d213_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d213_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d221_1\"\>", "+", 
        RowBox[{"\<\"d221_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d221_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d222_1\"\>", "+", 
        RowBox[{"\<\"d222_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d222_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d223_1\"\>", "+", 
        RowBox[{"\<\"d223_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d223_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d311_1\"\>", "+", 
        RowBox[{"\<\"d311_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d311_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d312_1\"\>", "+", 
        RowBox[{"\<\"d312_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d312_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d313_1\"\>", "+", 
        RowBox[{"\<\"d313_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d313_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d314_1\"\>", "+", 
        RowBox[{"\<\"d314_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d314_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d341_1\"\>", "+", 
        RowBox[{"\<\"d341_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d341_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d342_1\"\>", "+", 
        RowBox[{"\<\"d342_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d342_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d343_1\"\>", "+", 
        RowBox[{"\<\"d343_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d343_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d344_1\"\>", "+", 
        RowBox[{"\<\"d344_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d344_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6328535931564226`*^9, 3.6328536447970476`*^9}, {
   3.632893001735516*^9, 3.6328930221974297`*^9}, 3.632907700496237*^9, {
   3.632907733986537*^9, 3.63290775665754*^9}, 3.632907848038558*^9, 
   3.63290909604405*^9, 3.632931877321469*^9, 3.632932974358057*^9, 
   3.6329330381914797`*^9, {3.6329333823633547`*^9, 3.632933398560066*^9}, 
   3.6385921092992897`*^9, 3.638596735197484*^9, 3.638596922125903*^9, 
   3.6385985590397205`*^9, 3.6392073008455143`*^9, 3.6392250379864073`*^9, 
   3.653536247123118*^9, 3.6869299071797733`*^9, 3.68693059557542*^9, 
   3.686930823427189*^9, 3.6869309757832336`*^9, 3.6869310501150103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["currentquotas"], "Input",
 CellChangeTimes->{{3.686930603476439*^9, 3.686930608007038*^9}, {
  3.6869310576952343`*^9, 3.686931059784758*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "3", ",", "2"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.68693060933603*^9, 3.686930823491598*^9, 
  3.686931061119748*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["storedmatchMatrix"], "Input",
 CellChangeTimes->{{3.638596770946246*^9, 3.6385967711517725`*^9}, {
  3.6392073061882877`*^9, 3.639207311959772*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.638596772988391*^9, 3.638596924065233*^9, 
  3.6385985590397205`*^9, 3.6392073131306705`*^9, 3.6392250393457823`*^9, 
  3.653536248939501*^9, 3.68693082349664*^9, 3.686931071313251*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["matchMatrix"], "Input",
 CellChangeTimes->{{3.6385966881280956`*^9, 3.6385966931274796`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6385966985172367`*^9, 3.638596736730381*^9, 
  3.6385969269422235`*^9, 3.6385985590553455`*^9, 3.639207314560358*^9, 
  3.6392250401270323`*^9, 3.653536250505241*^9, 3.686930823586458*^9, 
  3.686931073572604*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "removeD", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeD", "::", "usage"}], "=", 
   "\"\<removeD[m_,d_List,match_:False] removes from the payoffMatrix's \
market m the downstreams that are included in the list d. If the match flag \
is set to True then they are removed also from the matchMatrix. This is \
preferred on the precomputed case where we do not have to change noU and noD \
lists.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeD", "[", 
    RowBox[{"m_", ",", "d_List", ",", 
     RowBox[{"match_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "keep", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"keep", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{"payoffMatrix", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "d"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"payoffMatrix", "[", 
        RowBox[{"[", "m", "]"}], "]"}], "=", 
       RowBox[{"payoffMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "All", ",", "keep"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"currentquotas", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "m"}], "]"}], "]"}], "=", 
       RowBox[{"currentquotas", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "m", ",", "keep"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"match", ",", 
        RowBox[{
         RowBox[{"matchMatrix", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "=", 
         RowBox[{"matchMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "All", ",", "keep"}], "]"}], "]"}]}]}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6328533576251726`*^9, 3.6328534431407976`*^9}, {
   3.6328535267189226`*^9, 3.6328535326095476`*^9}, {3.6328929581437187`*^9, 
   3.6328929895040703`*^9}, {3.6329078360490494`*^9, 
   3.6329078368187237`*^9}, {3.6329089635022316`*^9, 
   3.6329089770920753`*^9}, {3.6329090079202003`*^9, 3.632909059601841*^9}, {
   3.632932710437422*^9, 3.6329327206434765`*^9}, {3.632932932248682*^9, 
   3.6329329610963383`*^9}, {3.6329333636133547`*^9, 3.632933369183667*^9}, {
   3.6392251636739073`*^9, 3.6392251641114073`*^9}, 3.6866272299539967`*^9, {
   3.686930922647997*^9, 3.686930930744996*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell[BoxData["currentquotas"], "Input",
 CellChangeTimes->{{3.686931095465029*^9, 3.686931096968503*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "3", ",", "2"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.686931098404694*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Attention", " ", ":", " ", 
    RowBox[{
    "removeU", " ", "removes", " ", "rows", " ", "and", " ", "removeD", " ", 
     "removes", " ", 
     RowBox[{"columns", ".", " ", "They"}], " ", "are", " ", 
     RowBox[{"interchangeable", "!"}]}]}], "*)"}], " "}]], "Input",
 CellChangeTimes->{{3.63859695014544*^9, 3.6385970235521393`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"removeD", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", "True"}], "]"}], ";", 
  "payoffMatrix"}]], "Input",
 CellChangeTimes->{{3.632907779762329*^9, 3.6329077994497876`*^9}, {
  3.63290907533362*^9, 3.632909076668851*^9}, {3.632933384733472*^9, 
  3.6329333851580753`*^9}, {3.6385967924728775`*^9, 3.6385967937192965`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d111_1\"\>", "+", 
        RowBox[{"\<\"d111_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d111_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d112_1\"\>", "+", 
        RowBox[{"\<\"d112_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d112_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d121_1\"\>", "+", 
        RowBox[{"\<\"d121_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d121_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d122_1\"\>", "+", 
        RowBox[{"\<\"d122_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d122_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d131_1\"\>", "+", 
        RowBox[{"\<\"d131_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d131_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d132_1\"\>", "+", 
        RowBox[{"\<\"d132_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d132_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d211_1\"\>", "+", 
        RowBox[{"\<\"d211_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d211_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d212_1\"\>", "+", 
        RowBox[{"\<\"d212_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d212_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d213_1\"\>", "+", 
        RowBox[{"\<\"d213_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d213_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d221_1\"\>", "+", 
        RowBox[{"\<\"d221_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d221_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d222_1\"\>", "+", 
        RowBox[{"\<\"d222_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d222_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d223_1\"\>", "+", 
        RowBox[{"\<\"d223_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d223_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d312_1\"\>", "+", 
        RowBox[{"\<\"d312_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d312_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d313_1\"\>", "+", 
        RowBox[{"\<\"d313_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d313_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d342_1\"\>", "+", 
        RowBox[{"\<\"d342_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d342_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d343_1\"\>", "+", 
        RowBox[{"\<\"d343_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d343_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6329078006409616`*^9, 3.6329078495018907`*^9, 3.6329091001700644`*^9, 
   3.6329318784484215`*^9, 3.632932975349268*^9, 3.632933039324292*^9, {
   3.6329333856801367`*^9, 3.632933399682521*^9}, 3.638592110428512*^9, 
   3.638596794709613*^9, 3.638596932753639*^9, 3.6385985590709705`*^9, 
   3.6392073162263737`*^9, 3.6392250457364073`*^9, 3.653536256518532*^9, 
   3.6869308237418222`*^9, 3.686931109464858*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["currentquotas"], "Input",
 CellChangeTimes->{{3.686931113622075*^9, 3.6869311152500963`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.686931115827424*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["storedmatchMatrix"], "Input",
 CellChangeTimes->{{3.638596805682616*^9, 3.638596806057602*^9}, {
  3.6392073194675846`*^9, 3.63920732213653*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.638596808912069*^9, 3.6385969349723644`*^9, 
  3.6385985590709705`*^9, 3.6392073226863346`*^9, 3.6392250471114073`*^9, 
  3.653536258257475*^9, 3.686930823788271*^9, 3.686931130666266*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["matchMatrix"], "Input",
 CellChangeTimes->{{3.6329078945163355`*^9, 3.6329078966117845`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6329078978461385`*^9, 3.6329091023617544`*^9, 
  3.632931879751156*^9, 3.6329329763346195`*^9, 3.632933040666089*^9, 
  3.6329334013086786`*^9, 3.6385921158841643`*^9, 3.638596812331961*^9, 
  3.6385969368638196`*^9, 3.6385985590865955`*^9, 3.6392073247312565`*^9, 
  3.6392250484082823`*^9, 3.653536259846035*^9, 3.686930823837418*^9, 
  3.686931132331324*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Cmates", "[", "storedmatchMatrix", "]"}], ",", 
   RowBox[{"Cmates", "[", "matchMatrix", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{
  3.632909252779014*^9, {3.6869311540757647`*^9, 3.686931176983666*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4", ",", "4"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.632909254354209*^9, 3.632931881705258*^9, 3.6329329772428226`*^9, 
   3.632933041867261*^9, 3.632933402057949*^9, 3.6385921169312086`*^9, 
   3.638597037713546*^9, 3.6385985590865955`*^9, 3.6392073274988346`*^9, 
   3.6392250491426573`*^9, 3.653536261413965*^9, 3.686930823884214*^9, {
   3.6869311481412563`*^9, 3.686931177969861*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Cmate", "[", "storedmatchMatrix", "]"}], ",", 
   RowBox[{"Cmate", "[", "matchMatrix", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.6329091597253027`*^9, 3.632909199213584*^9}, {
  3.686931201100853*^9, 3.6869312085550737`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.632909174677451*^9, 3.6329091996696386`*^9}, 
   3.6329318823976407`*^9, 3.6329329791578617`*^9, 3.632933043494214*^9, 
   3.6329334027337418`*^9, 3.6385921176108694`*^9, 3.638597040768428*^9, 
   3.6385985591022205`*^9, 3.6392073288562565`*^9, 3.6392250503457823`*^9, 
   3.653536263208703*^9, 3.686930823931995*^9, 3.686931149351677*^9, 
   3.686931209645266*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"restore", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6392093642364073`*^9, 3.6392093659082823`*^9}, {
  3.6392250555801573`*^9, 3.6392250556739073`*^9}}],

Cell[BoxData["\<\" payoffMatrix and matchMatrix have been restored!\"\>"], \
"Print",
 CellChangeTimes->{3.686930824016157*^9, 3.686933479900433*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "removeUD", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeUD", "::", "usage"}], "=", 
   "\"\<removeUD[m_,u_List,d_List,match_:False] combines removeU and removeD \
in one step\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeUD", "[", 
   RowBox[{"m_", ",", "u_List", ",", "d_List", ",", 
    RowBox[{"match_:", "False"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"removeU", "[", 
     RowBox[{"m", ",", "u", ",", "match"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"removeD", "[", 
     RowBox[{"m", ",", "d", ",", "match"}], "]"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6328533576251726`*^9, 3.6328534431407976`*^9}, {
  3.6328535267189226`*^9, 3.6328535326095476`*^9}, {3.6328929581437187`*^9, 
  3.6328929895040703`*^9}, {3.6329078360490494`*^9, 3.6329078368187237`*^9}, {
  3.6329089635022316`*^9, 3.6329089770920753`*^9}, {3.6329090079202003`*^9, 
  3.632909059601841*^9}, {3.632932710437422*^9, 3.6329327206434765`*^9}, {
  3.632932932248682*^9, 3.6329329610963383`*^9}, {3.6329333636133547`*^9, 
  3.632933369183667*^9}, {3.6392220416270323`*^9, 3.6392220585645323`*^9}, {
  3.6392232351426573`*^9, 3.6392233150176573`*^9}, {3.6392251512832823`*^9, 
  3.6392251520489073`*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"removeUD", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", "True"}], "]"}], ";", 
  "payoffMatrix"}]], "Input",
 CellChangeTimes->{{3.6392250021582823`*^9, 3.6392250037051573`*^9}, {
  3.6392250681426573`*^9, 3.6392250720489073`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d111_1\"\>", "+", 
        RowBox[{"\<\"d111_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d111_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d112_1\"\>", "+", 
        RowBox[{"\<\"d112_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d112_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d121_1\"\>", "+", 
        RowBox[{"\<\"d121_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d121_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d122_1\"\>", "+", 
        RowBox[{"\<\"d122_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d122_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d131_1\"\>", "+", 
        RowBox[{"\<\"d131_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d131_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d132_1\"\>", "+", 
        RowBox[{"\<\"d132_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d132_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d211_1\"\>", "+", 
        RowBox[{"\<\"d211_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d211_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d212_1\"\>", "+", 
        RowBox[{"\<\"d212_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d212_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d213_1\"\>", "+", 
        RowBox[{"\<\"d213_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d213_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d221_1\"\>", "+", 
        RowBox[{"\<\"d221_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d221_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d222_1\"\>", "+", 
        RowBox[{"\<\"d222_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d222_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d223_1\"\>", "+", 
        RowBox[{"\<\"d223_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d223_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d312_1\"\>", "+", 
        RowBox[{"\<\"d312_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d312_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d313_1\"\>", "+", 
        RowBox[{"\<\"d313_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d313_3\"\>", " ", "x2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"d342_1\"\>", "+", 
        RowBox[{"\<\"d342_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d342_3\"\>", " ", "x2"}]}], ",", 
       RowBox[{"\<\"d343_1\"\>", "+", 
        RowBox[{"\<\"d343_2\"\>", " ", "x1"}], "+", 
        RowBox[{"\<\"d343_3\"\>", " ", "x2"}]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6392250735176573`*^9, 3.6535362704131603`*^9, 
  3.68693082413523*^9, 3.686933484069737*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["storedmatchMatrix"], "Input",
 CellChangeTimes->{{3.638596805682616*^9, 3.638596806057602*^9}, {
  3.6392073194675846`*^9, 3.63920732213653*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.638596808912069*^9, 3.6385969349723644`*^9, 
  3.6385985590709705`*^9, 3.6392073226863346`*^9, 3.6392250471114073`*^9, 
  3.6392250912364073`*^9, 3.653536272082418*^9, 3.686930824176803*^9, 
  3.686933493217215*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["matchMatrix"], "Input",
 CellChangeTimes->{{3.6329078945163355`*^9, 3.6329078966117845`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6329078978461385`*^9, 3.6329091023617544`*^9, 
  3.632931879751156*^9, 3.6329329763346195`*^9, 3.632933040666089*^9, 
  3.6329334013086786`*^9, 3.6385921158841643`*^9, 3.638596812331961*^9, 
  3.6385969368638196`*^9, 3.6385985590865955`*^9, 3.6392073247312565`*^9, 
  3.6392250484082823`*^9, 3.6392250924864073`*^9, 3.653536277142653*^9, 
  3.686930824218524*^9, 3.6869334943084803`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cmates", "[", "matchMatrix", "]"}]], "Input",
 CellChangeTimes->{3.632909252779014*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "2"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.632909254354209*^9, 3.632931881705258*^9, 
  3.6329329772428226`*^9, 3.632933041867261*^9, 3.632933402057949*^9, 
  3.6385921169312086`*^9, 3.638597037713546*^9, 3.6385985590865955`*^9, 
  3.6392073274988346`*^9, 3.6392250491426573`*^9, 3.6392250933614073`*^9, 
  3.653536278589529*^9, 3.686930824260499*^9, 3.68693349521104*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cmate", "[", "matchMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.6329091597253027`*^9, 3.632909199213584*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.632909174677451*^9, 3.6329091996696386`*^9}, 
   3.6329318823976407`*^9, 3.6329329791578617`*^9, 3.632933043494214*^9, 
   3.6329334027337418`*^9, 3.6385921176108694`*^9, 3.638597040768428*^9, 
   3.6385985591022205`*^9, 3.6392073288562565`*^9, 3.6392250503457823`*^9, 
   3.6392250943301573`*^9, 3.653536279981572*^9, 3.686930824304174*^9, 
   3.686933496511709*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "header", ",", "noM", ",", "noU", ",", "noD", ",", "noAttr", ",", 
   "distanceMatrices", ",", "matchMatrix", ",", "mate", ",", "payoffMatrix", 
   ",", "storedmatchMatrix", ",", "storedpayoffMatrix", ",", 
   "currentquotas"}], "]"}]], "Input",
 CellChangeTimes->{{3.6385984050084705`*^9, 3.6385984965553455`*^9}, {
  3.639207331285944*^9, 3.639207356777155*^9}, {3.686933505372117*^9, 
  3.6869335078408546`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["payoffMatrix2Positive", "Section",
 CellChangeTimes->{{3.6328515776159687`*^9, 3.632851583139406*^9}, {
   3.632932492961161*^9, 3.6329324982433987`*^9}, 3.6330216979763966`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumericQ", "/@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.2", ",", "4"}], "}"}], ",", "4.", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "/", "2"}], ",", "1"}], "}"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.6330170059883366`*^9, 3.6330170283633366`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "True", ",", "True", ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6330170309883366`*^9, 3.6330172316289616`*^9, 
  3.6330216022576466`*^9, 3.6330227909607716`*^9, 3.6385973407495914`*^9, 
  3.6385985591178455`*^9, 3.639324619256258*^9, 3.6393246496171207`*^9, 
  3.653536286618436*^9, 3.686930824357644*^9, 3.6869342492769136`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"And", "@@", "%"}]], "Input",
 CellChangeTimes->{{3.6330172276445866`*^9, 3.6330172298789616`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6330172321758366`*^9, 3.6330216028670216`*^9, 3.6330227916482716`*^9, 
   3.6385973456083784`*^9, 3.6385985591178455`*^9, {3.6393246202164116`*^9, 
   3.639324650162042*^9}, 3.65353629302323*^9, 3.686930824399569*^9, 
   3.6869342506948*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrixTEST", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1000"}], ",", "1000"}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"3", ",", "5"}], "}"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"4", ",", "6"}], "}"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "3", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6330198539930043`*^9, 3.63301986438363*^9}, {
   3.6330200003055043`*^9, 3.6330200773367543`*^9}, {3.63302024913363*^9, 
   3.63302026363363*^9}, 3.6330215985388966`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "982.5142232137187`"}], ",", 
       RowBox[{"-", "198.61051958090775`"}], ",", "781.1667739984891`", ",", 
       RowBox[{"-", "405.1806319812663`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "22.39936261628054`", ",", "968.0535177557626`", ",", 
       "545.436056393034`", ",", "144.75019749135026`", ",", 
       RowBox[{"-", "784.219516528356`"}], ",", 
       RowBox[{"-", "180.9517659216226`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"974.1980652661423`", ",", 
       RowBox[{"-", "104.60308252945106`"}], ",", "491.1160136832268`", ",", 
       "860.4440584573399`", ",", 
       RowBox[{"-", "837.8418856817029`"}], ",", 
       RowBox[{"-", "60.560317893092815`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "890.0870136290227`"}], ",", "855.5193166509043`", ",", 
       "405.1741055299458`", ",", "747.0906912028381`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "530.3258749107495`"}], ",", 
       RowBox[{"-", "748.5651483648926`"}], ",", 
       RowBox[{"-", "227.76864586897773`"}], ",", 
       RowBox[{"-", "165.25904874154458`"}], ",", "453.43683488248007`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "988.3079910856295`", ",", "433.213786632115`", ",", 
       "655.6765775074791`", ",", "755.5543955984349`", ",", 
       "979.846124085585`", ",", 
       RowBox[{"-", "888.1588799000551`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"776.7144380167865`", ",", 
       RowBox[{"-", "403.389788100239`"}], ",", "519.5382588156745`", ",", 
       "77.56967285585688`", ",", "186.53104358456312`", ",", 
       RowBox[{"-", "715.1994930001297`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"695.4805173386703`", ",", 
       RowBox[{"-", "116.03599422646221`"}], ",", "954.7939228532045`", ",", 
       RowBox[{"-", "211.78751920910827`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "628.3096955092806`"}], ",", "773.8166375660921`", ",", 
       "118.856654240019`", ",", "897.3994347867365`", ",", 
       "309.61585347614664`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "160.18877291087847`", ",", "432.8678865822285`", ",", 
       "531.7613163093456`", ",", 
       RowBox[{"-", "499.68479757029354`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "474.53915078238424`"}], ",", 
       RowBox[{"-", "522.1598286455996`"}], ",", "963.0280578825605`", ",", 
       RowBox[{"-", "819.2188234017517`"}], ",", "625.1958234850208`", ",", 
       RowBox[{"-", "545.1295024286555`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "194.68448693792152`"}], ",", "605.3341648187043`", ",", 
       RowBox[{"-", "447.8318920518095`"}], ",", "773.558557901435`", ",", 
       RowBox[{"-", "917.0879077374534`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "962.5947075512795`"}], ",", "247.55828181825154`", ",", 
       RowBox[{"-", "882.2700364365023`"}], ",", 
       RowBox[{"-", "454.81611766503556`"}], ",", "64.64460469361075`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"713.8695515852737`", ",", 
       RowBox[{"-", "395.5482800834425`"}], ",", 
       RowBox[{"-", "284.0186909851577`"}], ",", "324.3027283078354`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"429.1239659845428`", ",", 
       RowBox[{"-", "386.4817070916688`"}], ",", 
       RowBox[{"-", "59.422399712011156`"}], ",", 
       RowBox[{"-", "563.8258304797778`"}], ",", 
       RowBox[{"-", "662.5620586629439`"}], ",", 
       RowBox[{"-", "948.5699371884457`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.63302006447738*^9, 3.63302007816488*^9}, 
   3.63302026647738*^9, 3.6330214906013966`*^9, 3.6330216036482716`*^9, 
   3.6330227929451466`*^9, 3.638597348427187*^9, 3.6385985591334705`*^9, {
   3.6393246228778896`*^9, 3.639324650767511*^9}, 3.6535362943097887`*^9, 
   3.686930824447296*^9, 3.686934252002941*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "payoffMatrix2Positive", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"payoffMatrix2Positive", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"payoffMatrix2Positive", "::", "usage"}], "=", 
   "\"\<payoffMatrix2Positive[offset,payoffMatrix,epsilon_:0,sameoffset_:\
False] returns a list of matrices of positive elements. The offset variable \
is set accordingly. If the sameoffset flag is set to True then the offset \
equals the minimum element in the entire payoffMatrix.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"payoffMatrix2Positive", "[", 
    RowBox[{"offset_", ",", 
     RowBox[{"payoffMatrix_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{"NumericQ", "/@", 
           RowBox[{"Flatten", "@", "#"}]}], ")"}]}], "&"}], ")"}]}], ",", 
     RowBox[{"epsilon_:", "0"}], ",", 
     RowBox[{"sameoffset_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "min", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"offset", "=", 
       RowBox[{"Min", "/@", "payoffMatrix"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"sameoffset", ",", 
        RowBox[{
         RowBox[{"min", "=", 
          RowBox[{"Min", "@", "offset"}]}], ";", 
         RowBox[{"offset", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"min", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "@", "payoffMatrix"}], "}"}]}], "]"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"payoffMatrix", "-", "offset", "+", "epsilon"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQXbLgkVKe4GvHEoUTuiB647E9HvlAepMbp08+mC8e
AuHHhEL433ZB+Ef2Quj1J6DqTkH4kechfO+LEPrUHYj47Psgeondap4CEL3v
Ny+YtptqDqEVHSHiM70gfH8fCC11GSL+5TaEH/wIQi96DKJn2Ux4XCr72vHO
UZ7nIJr3CtMHEC10cvoPEP1PO8Z9osVrxzVzVniBaLlpPzpcKl473u1imAOi
F54sWAyite1z14FosbbkTSD6VNWuzSD6uaTzURDdsjP9HIj+KMd4BUQvktK5
AaLP6dS+BdFrri78CKIBK4mmzw==
  "],
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST"}], "]"}]], "Input",
 CellChangeTimes->{{3.6330214590545216`*^9, 3.6330214701951466`*^9}, 
   3.6330215005857716`*^9, {3.6393246379852843`*^9, 3.6393246452587223`*^9}, {
   3.6869342290333443`*^9, 3.686934229663679*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "783.9037036328109`", ",", "1763.6809972122078`", ",", 
       "577.3335912324524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1004.9135858299992`", ",", "1950.5677409694813`", ",", 
       "1527.9502796067527`", ",", "1127.264420705069`", ",", 
       "198.2947066853626`", ",", "801.562457292096`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1956.712288479861`", ",", "877.9111406842676`", ",", 
       "1473.6302368969455`", ",", "1842.9582816710586`", ",", 
       "144.67233753201572`", ",", "921.9539053206258`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "92.4272095846959`", ",", "1838.033539864623`", ",", 
       "1387.6883287436644`", ",", "1729.6049144165568`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "452.1883483029692`", ",", "233.94907484882606`", ",", 
       "754.7455773447409`", ",", "817.2551744721741`", ",", 
       "1435.9510580961987`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1876.4668709856846`", ",", "1321.3726665321701`", ",", 
       "1543.8354574075342`", ",", "1643.71327549849`", ",", 
       "1868.00500398564`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1664.8733179168416`", ",", "484.7690917998161`", ",", 
       "1407.6971387157296`", ",", "965.728552755912`", ",", 
       "1074.6899234846182`", ",", "172.95938689992545`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1583.6393972387255`", ",", "772.1228856735929`", ",", 
       "1842.9528027532597`", ",", "676.3713606909469`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "259.84918439077455`", ",", "1661.9755174661473`", ",", 
       "1007.0155341400741`", ",", "1785.5583146867916`", ",", 
       "1197.7747333762018`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1048.3476528109336`", ",", "1321.0267664822836`", ",", 
       "1419.9201962094007`", ",", "388.4740823297616`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "488.05555676889526`", ",", "440.43487890567985`", ",", 
       "1925.62276543384`", ",", "143.3758841495278`", ",", 
       "1587.7905310363003`", ",", "417.46520512262396`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "767.910220613358`", ",", "1567.9288723699838`", ",", 
       "514.76281549947`", ",", "1736.1532654527145`", ",", 
       "45.50679981382609`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "1210.152989369531`", ",", "80.32467111477717`", ",", 
       "507.77858988624394`", ",", "1027.2393122448902`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1676.4642591365532`", ",", "567.046427467837`", ",", 
       "678.5760165661218`", ",", "1286.897435859115`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1391.7186735358223`", ",", "576.1130004596107`", ",", 
       "903.1723078392683`", ",", "398.7688770715017`", ",", 
       "300.03264888833564`", ",", "14.024770362833806`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6330215029138966`*^9, 3.6330216066326466`*^9, 3.6330227604920216`*^9, 
   3.6330228039451466`*^9, 3.6385973524731045`*^9, 3.6385985591490955`*^9, {
   3.639324628892536*^9, 3.6393246576522765`*^9}, 3.653536302795327*^9, 
   3.6535363589727697`*^9, 3.6869308245249157`*^9, 3.686934255571175*^9, 
   3.686934360499251*^9, 3.686934415667163*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["offset"], "Input",
 CellChangeTimes->{{3.6330215606013966`*^9, 3.6330215626326466`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "982.5142232137187`"}], ",", 
   RowBox[{"-", "888.1588799000551`"}], ",", 
   RowBox[{"-", "962.5947075512795`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6330215637576466`*^9, 3.6330216080232716`*^9, 
  3.6330228056482716`*^9, 3.6385973557372103`*^9, 3.6385985591490955`*^9, 
  3.6393246632509093`*^9, 3.653536361749962*^9, 3.686930824566407*^9, 
  3.686934258205463*^9, 3.686934361524753*^9, 3.6869344166252823`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", "0", ",", "True"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6869342416130457`*^9, 3.686934244339658*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "783.9037036328109`", ",", "1763.6809972122078`", ",", 
       "577.3335912324524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1004.9135858299992`", ",", "1950.5677409694813`", ",", 
       "1527.9502796067527`", ",", "1127.264420705069`", ",", 
       "198.2947066853626`", ",", "801.562457292096`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1956.712288479861`", ",", "877.9111406842676`", ",", 
       "1473.6302368969455`", ",", "1842.9582816710586`", ",", 
       "144.67233753201572`", ",", "921.9539053206258`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "92.4272095846959`", ",", "1838.033539864623`", ",", 
       "1387.6883287436644`", ",", "1729.6049144165568`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "452.1883483029692`", ",", "233.94907484882606`", ",", 
       "754.7455773447409`", ",", "817.2551744721741`", ",", 
       "1435.9510580961987`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1970.8222142993482`", ",", "1415.7280098458336`", ",", 
       "1638.1908007211978`", ",", "1738.0686188121535`", ",", 
       "1962.3603472993036`", ",", "94.35534331366352`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1759.2286612305052`", ",", "579.1244351134796`", ",", 
       "1502.052482029393`", ",", "1060.0838960695755`", ",", 
       "1169.0452667982818`", ",", "267.314730213589`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1677.994740552389`", ",", "866.4782289872564`", ",", 
       "1937.3081460669232`", ",", "770.7267040046104`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "354.2045277044381`", ",", "1756.3308607798108`", ",", 
       "1101.3708774537376`", ",", "1879.9136580004551`", ",", 
       "1292.1300766898653`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1142.7029961245971`", ",", "1415.3821097959471`", ",", 
       "1514.2755395230643`", ",", "482.8294256434251`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "507.9750724313344`", ",", "460.354394568119`", ",", 
       "1945.542281096279`", ",", "163.29539981196694`", ",", 
       "1607.7100466987395`", ",", "437.3847207850631`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "787.8297362757971`", ",", "1587.848388032423`", ",", 
       "534.6823311619091`", ",", "1756.0727811151537`", ",", 
       "65.42631547626524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "19.919515662439153`", ",", "1230.0725050319702`", ",", 
       "100.24418677721633`", ",", "527.6981055486831`", ",", 
       "1047.1588279073294`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1696.3837747989924`", ",", "586.9659431302762`", ",", 
       "698.4955322285609`", ",", "1306.816951521554`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1411.6381891982614`", ",", "596.0325161220499`", ",", 
       "923.0918235017075`", ",", "418.6883927339409`", ",", 
       "319.9521645507748`", ",", "33.94428602527296`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.686934262254747*^9, 3.6869343625559196`*^9, 
  3.686934417645965*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["offset"], "Input",
 CellChangeTimes->{{3.686934423520091*^9, 3.686934424964717*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "982.5142232137187`"}], ",", 
   RowBox[{"-", "982.5142232137187`"}], ",", 
   RowBox[{"-", "982.5142232137187`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.68693442557227*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.639324677399347*^9, 3.639324681115167*^9}, {
  3.686934441847653*^9, 3.6869344424439*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "784.9037036328109`", ",", "1764.6809972122078`", ",", 
       "578.3335912324524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1005.9135858299992`", ",", "1951.5677409694813`", ",", 
       "1528.9502796067527`", ",", "1128.264420705069`", ",", 
       "199.2947066853626`", ",", "802.562457292096`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1957.712288479861`", ",", "878.9111406842676`", ",", 
       "1474.6302368969455`", ",", "1843.9582816710586`", ",", 
       "145.67233753201572`", ",", "922.9539053206258`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "93.4272095846959`", ",", "1839.033539864623`", ",", 
       "1388.6883287436644`", ",", "1730.6049144165568`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "453.1883483029692`", ",", "234.94907484882606`", ",", 
       "755.7455773447409`", ",", "818.2551744721741`", ",", 
       "1436.9510580961987`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1877.4668709856846`", ",", "1322.3726665321701`", ",", 
       "1544.8354574075342`", ",", "1644.71327549849`", ",", 
       "1869.00500398564`", ",", "1.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1665.8733179168416`", ",", "485.7690917998161`", ",", 
       "1408.6971387157296`", ",", "966.728552755912`", ",", 
       "1075.6899234846182`", ",", "173.95938689992545`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1584.6393972387255`", ",", "773.1228856735929`", ",", 
       "1843.9528027532597`", ",", "677.3713606909469`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "260.84918439077455`", ",", "1662.9755174661473`", ",", 
       "1008.0155341400741`", ",", "1786.5583146867916`", ",", 
       "1198.7747333762018`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1049.3476528109336`", ",", "1322.0267664822836`", ",", 
       "1420.9201962094007`", ",", "389.4740823297616`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "489.05555676889526`", ",", "441.43487890567985`", ",", 
       "1926.62276543384`", ",", "144.3758841495278`", ",", 
       "1588.7905310363003`", ",", "418.46520512262396`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "768.910220613358`", ",", "1568.9288723699838`", ",", 
       "515.76281549947`", ",", "1737.1532654527145`", ",", 
       "46.50679981382609`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "1211.152989369531`", ",", "81.32467111477717`", ",", 
       "508.77858988624394`", ",", "1028.2393122448902`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1677.4642591365532`", ",", "568.046427467837`", ",", 
       "679.5760165661218`", ",", "1287.897435859115`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1392.7186735358223`", ",", "577.1130004596107`", ",", 
       "904.1723078392683`", ",", "399.7688770715017`", ",", 
       "301.03264888833564`", ",", "15.024770362833806`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.639324686267511*^9, 3.6535363664024563`*^9, 
  3.686930824610546*^9, 3.686934445892683*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", "1", ",", "True"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.686934469314392*^9, 3.686934470556911*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "784.9037036328109`", ",", "1764.6809972122078`", ",", 
       "578.3335912324524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1005.9135858299992`", ",", "1951.5677409694813`", ",", 
       "1528.9502796067527`", ",", "1128.264420705069`", ",", 
       "199.2947066853626`", ",", "802.562457292096`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1957.712288479861`", ",", "878.9111406842676`", ",", 
       "1474.6302368969455`", ",", "1843.9582816710586`", ",", 
       "145.67233753201572`", ",", "922.9539053206258`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "93.4272095846959`", ",", "1839.033539864623`", ",", 
       "1388.6883287436644`", ",", "1730.6049144165568`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "453.1883483029692`", ",", "234.94907484882606`", ",", 
       "755.7455773447409`", ",", "818.2551744721741`", ",", 
       "1436.9510580961987`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1971.8222142993482`", ",", "1416.7280098458336`", ",", 
       "1639.1908007211978`", ",", "1739.0686188121535`", ",", 
       "1963.3603472993036`", ",", "95.35534331366352`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1760.2286612305052`", ",", "580.1244351134796`", ",", 
       "1503.052482029393`", ",", "1061.0838960695755`", ",", 
       "1170.0452667982818`", ",", "268.314730213589`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1678.994740552389`", ",", "867.4782289872564`", ",", 
       "1938.3081460669232`", ",", "771.7267040046104`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "355.2045277044381`", ",", "1757.3308607798108`", ",", 
       "1102.3708774537376`", ",", "1880.9136580004551`", ",", 
       "1293.1300766898653`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1143.7029961245971`", ",", "1416.3821097959471`", ",", 
       "1515.2755395230643`", ",", "483.8294256434251`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "508.9750724313344`", ",", "461.354394568119`", ",", 
       "1946.542281096279`", ",", "164.29539981196694`", ",", 
       "1608.7100466987395`", ",", "438.3847207850631`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "788.8297362757971`", ",", "1588.848388032423`", ",", 
       "535.6823311619091`", ",", "1757.0727811151537`", ",", 
       "66.42631547626524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "20.919515662439153`", ",", "1231.0725050319702`", ",", 
       "101.24418677721633`", ",", "528.6981055486831`", ",", 
       "1048.1588279073294`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1697.3837747989924`", ",", "587.9659431302762`", ",", 
       "699.4955322285609`", ",", "1307.816951521554`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1412.6381891982614`", ",", "597.0325161220499`", ",", 
       "924.0918235017075`", ",", "419.6883927339409`", ",", 
       "320.9521645507748`", ",", "34.94428602527296`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.686934471265759*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6393247098466125`*^9, 3.6393247516709285`*^9}, {
  3.6869344594286213`*^9, 3.686934459983068*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "784.9037036328109`", ",", "1764.6809972122078`", ",", 
       "578.3335912324524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1005.9135858299992`", ",", "1951.5677409694813`", ",", 
       "1528.9502796067527`", ",", "1128.264420705069`", ",", 
       "199.2947066853626`", ",", "802.562457292096`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1957.712288479861`", ",", "878.9111406842676`", ",", 
       "1474.6302368969455`", ",", "1843.9582816710586`", ",", 
       "145.67233753201572`", ",", "922.9539053206258`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "93.4272095846959`", ",", "1839.033539864623`", ",", 
       "1388.6883287436644`", ",", "1730.6049144165568`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "453.1883483029692`", ",", "234.94907484882606`", ",", 
       "755.7455773447409`", ",", "818.2551744721741`", ",", 
       "1436.9510580961987`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1878.4668709856846`", ",", "1323.3726665321701`", ",", 
       "1545.8354574075342`", ",", "1645.71327549849`", ",", 
       "1870.00500398564`", ",", "2.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1666.8733179168416`", ",", "486.7690917998161`", ",", 
       "1409.6971387157296`", ",", "967.728552755912`", ",", 
       "1076.6899234846182`", ",", "174.95938689992545`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1585.6393972387255`", ",", "774.1228856735929`", ",", 
       "1844.9528027532597`", ",", "678.3713606909469`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "261.84918439077455`", ",", "1663.9755174661473`", ",", 
       "1009.0155341400741`", ",", "1787.5583146867916`", ",", 
       "1199.7747333762018`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1050.3476528109336`", ",", "1323.0267664822836`", ",", 
       "1421.9201962094007`", ",", "390.4740823297616`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "491.05555676889526`", ",", "443.43487890567985`", ",", 
       "1928.62276543384`", ",", "146.3758841495278`", ",", 
       "1590.7905310363003`", ",", "420.46520512262396`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "770.910220613358`", ",", "1570.9288723699838`", ",", 
       "517.76281549947`", ",", "1739.1532654527145`", ",", 
       "48.50679981382609`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3.`", ",", "1213.152989369531`", ",", "83.32467111477717`", ",", 
       "510.77858988624394`", ",", "1030.2393122448902`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1679.4642591365532`", ",", "570.046427467837`", ",", 
       "681.5760165661218`", ",", "1289.897435859115`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1394.7186735358223`", ",", "579.1130004596107`", ",", 
       "906.1723078392683`", ",", "401.7688770715017`", ",", 
       "303.03264888833564`", ",", "17.024770362833806`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.63932473764787*^9, 3.6393247521236367`*^9}, 
   3.653536369293524*^9, 3.686930824654154*^9, 3.6869344789375257`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"payoffMatrix2Positive", "[", 
  RowBox[{"offset", ",", "payoffMatrixTEST", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.686934489123218*^9, 3.686934490382043*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "784.9037036328109`", ",", "1764.6809972122078`", ",", 
       "578.3335912324524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1005.9135858299992`", ",", "1951.5677409694813`", ",", 
       "1528.9502796067527`", ",", "1128.264420705069`", ",", 
       "199.2947066853626`", ",", "802.562457292096`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1957.712288479861`", ",", "878.9111406842676`", ",", 
       "1474.6302368969455`", ",", "1843.9582816710586`", ",", 
       "145.67233753201572`", ",", "922.9539053206258`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "93.4272095846959`", ",", "1839.033539864623`", ",", 
       "1388.6883287436644`", ",", "1730.6049144165568`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "453.1883483029692`", ",", "234.94907484882606`", ",", 
       "755.7455773447409`", ",", "818.2551744721741`", ",", 
       "1436.9510580961987`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1972.8222142993482`", ",", "1417.7280098458336`", ",", 
       "1640.1908007211978`", ",", "1740.0686188121535`", ",", 
       "1964.3603472993036`", ",", "96.35534331366352`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1761.2286612305052`", ",", "581.1244351134796`", ",", 
       "1504.052482029393`", ",", "1062.0838960695755`", ",", 
       "1171.0452667982818`", ",", "269.314730213589`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1679.994740552389`", ",", "868.4782289872564`", ",", 
       "1939.3081460669232`", ",", "772.7267040046104`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "356.2045277044381`", ",", "1758.3308607798108`", ",", 
       "1103.3708774537376`", ",", "1881.9136580004551`", ",", 
       "1294.1300766898653`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1144.7029961245971`", ",", "1417.3821097959471`", ",", 
       "1516.2755395230643`", ",", "484.8294256434251`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "510.9750724313344`", ",", "463.354394568119`", ",", 
       "1948.542281096279`", ",", "166.29539981196694`", ",", 
       "1610.7100466987395`", ",", "440.3847207850631`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "790.8297362757971`", ",", "1590.848388032423`", ",", 
       "537.6823311619091`", ",", "1759.0727811151537`", ",", 
       "68.42631547626524`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "22.919515662439153`", ",", "1233.0725050319702`", ",", 
       "103.24418677721633`", ",", "530.6981055486831`", ",", 
       "1050.1588279073294`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1699.3837747989924`", ",", "589.9659431302762`", ",", 
       "701.4955322285609`", ",", "1309.816951521554`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1414.6381891982614`", ",", "599.0325161220499`", ",", 
       "926.0918235017075`", ",", "421.6883927339409`", ",", 
       "322.9521645507748`", ",", "36.94428602527296`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.686934490957397*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"payoffMatrixTEST", ",", "offset"}], "]"}]], "Input",
 CellChangeTimes->{{3.6330216186326466`*^9, 3.6330216584607716`*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1366, 729},
WindowMargins->{{1, Automatic}, {0, Automatic}},
ShowSelection->True,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 302, 4, 65, "Section"],
Cell[CellGroupData[{
Cell[906, 30, 110, 1, 35, "Subsubsection"],
Cell[1019, 33, 272, 5, 33, "Text"],
Cell[1294, 40, 179, 4, 34, "Input"],
Cell[1476, 46, 148, 3, 34, "Input"],
Cell[1627, 51, 132, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[1784, 57, 320, 5, 32, "Input"],
Cell[2107, 64, 214, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2358, 71, 174, 4, 34, "Input"],
Cell[2535, 77, 232, 4, 34, "Output"]
}, Open  ]],
Cell[2782, 84, 374, 11, 165, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3193, 100, 213, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[3431, 107, 445, 12, 34, "Input"],
Cell[3879, 121, 7746, 226, 241, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11662, 352, 248, 5, 34, "Input"],
Cell[11913, 359, 5147, 118, 172, "Output"]
}, Open  ]],
Cell[17075, 480, 291, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[17391, 489, 176, 4, 34, "Input"],
Cell[17570, 495, 537, 13, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18144, 513, 138, 2, 32, "Input"],
Cell[18285, 517, 557, 13, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18879, 535, 223, 4, 32, "Input"],
Cell[19105, 541, 7171, 163, 174, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26313, 709, 108, 1, 32, "Input"],
Cell[26424, 712, 5053, 117, 172, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31514, 834, 139, 2, 32, "Input"],
Cell[31656, 838, 661, 21, 34, "Output"]
}, Open  ]],
Cell[32332, 862, 3173, 77, 416, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[35530, 943, 121, 2, 32, "Input"],
Cell[35654, 947, 349, 5, 65, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36040, 957, 277, 4, 32, "Input"],
Cell[36320, 963, 272, 5, 24, "Print"]
}, Open  ]],
Cell[36607, 971, 2987, 68, 278, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[39619, 1043, 207, 3, 32, "Input"],
Cell[39829, 1048, 710, 22, 34, "Output"]
}, Open  ]],
Cell[40554, 1073, 390, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[40969, 1086, 487, 10, 34, "Input"],
Cell[41459, 1098, 4067, 92, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45563, 1195, 156, 2, 32, "Input"],
Cell[45722, 1199, 640, 21, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46399, 1225, 162, 2, 32, "Input"],
Cell[46564, 1229, 1047, 30, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47648, 1264, 107, 1, 32, "Input"],
Cell[47758, 1267, 909, 27, 34, "Output"]
}, Open  ]],
Cell[48682, 1297, 2736, 64, 278, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[51443, 1365, 105, 1, 32, "Input"],
Cell[51551, 1368, 594, 20, 34, "Output"]
}, Open  ]],
Cell[52160, 1391, 390, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[52575, 1404, 402, 9, 34, "Input"],
Cell[52980, 1415, 3263, 78, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56280, 1498, 107, 1, 32, "Input"],
Cell[56390, 1501, 571, 19, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56998, 1525, 159, 2, 32, "Input"],
Cell[57160, 1529, 1050, 30, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58247, 1564, 107, 1, 32, "Input"],
Cell[58357, 1567, 1014, 28, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59408, 1600, 259, 6, 34, "Input"],
Cell[59670, 1608, 2601, 73, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62308, 1686, 283, 6, 34, "Input"],
Cell[62594, 1694, 2868, 89, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65499, 1788, 178, 3, 32, "Input"],
Cell[65680, 1793, 149, 2, 24, "Print"]
}, Open  ]],
Cell[65844, 1798, 1434, 29, 164, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[67303, 1831, 370, 10, 34, "Input"],
Cell[67676, 1843, 2940, 73, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70653, 1921, 159, 2, 32, "Input"],
Cell[70815, 1925, 1077, 31, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71929, 1961, 107, 1, 32, "Input"],
Cell[72039, 1964, 1040, 28, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73116, 1997, 111, 2, 32, "Input"],
Cell[73230, 2001, 1105, 29, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74372, 2035, 136, 2, 32, "Input"],
Cell[74511, 2039, 1403, 42, 34, "Output"]
}, Open  ]],
Cell[75929, 2084, 469, 9, 56, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76447, 2099, 184, 2, 65, "Section"],
Cell[CellGroupData[{
Cell[76656, 2105, 352, 10, 34, "Input"],
Cell[77011, 2117, 408, 7, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77456, 2129, 122, 2, 32, "Input"],
Cell[77581, 2133, 297, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77915, 2143, 861, 23, 34, "Input"],
Cell[78779, 2168, 4181, 96, 149, "Output"]
}, Open  ]],
Cell[82975, 2267, 2274, 57, 255, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[85274, 2328, 317, 5, 34, "Input"],
Cell[85594, 2335, 3523, 85, 149, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89154, 2425, 102, 1, 32, "Input"],
Cell[89259, 2428, 476, 9, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89772, 2442, 211, 4, 34, "Input"],
Cell[89986, 2448, 3287, 82, 149, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93310, 2535, 98, 1, 32, "Input"],
Cell[93411, 2538, 232, 6, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93680, 2549, 240, 4, 34, "Input"],
Cell[93923, 2555, 3269, 81, 149, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97229, 2641, 209, 4, 34, "Input"],
Cell[97441, 2647, 3238, 81, 149, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100716, 2733, 307, 6, 34, "Input"],
Cell[101026, 2741, 3295, 81, 149, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104358, 2827, 265, 5, 34, "Input"],
Cell[104626, 2834, 3238, 81, 149, "Output"]
}, Open  ]],
Cell[107879, 2918, 174, 3, 34, "Input"]
}, Open  ]]
}
]
*)

