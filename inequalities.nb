(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     72844,       1811]
NotebookOptionsPosition[     67867,       1677]
NotebookOutlinePosition[     68724,       1707]
CellTagsIndexPosition[     68593,       1701]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["inequalities.nb", "Section",
 CellChangeTimes->{{3.62600628385137*^9, 3.626006284835745*^9}, {
  3.6260709487170696`*^9, 3.6260709533480415`*^9}, {3.626096953477417*^9, 
  3.6260969551364455`*^9}, {3.6261707215015993`*^9, 3.6261707234205446`*^9}, {
  3.6261736078812375`*^9, 3.6261736107103395`*^9}, {3.6263372687397165`*^9, 
  3.6263372730053415`*^9}}],

Cell[CellGroupData[{

Cell["For the Developer", "Subsubsection",
 CellChangeTimes->{{3.5819225877880845`*^9, 3.581922592443351*^9}}],

Cell["\<\
AutoGeneratedPackage is an option for notebooks that specifies whether a \
package is automatically created when a notebook that contains initialization \
cells or groups is saved.\
\>", "Text",
 CellChangeTimes->{{3.5808982533077106`*^9, 3.580898259632072*^9}}],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816697178146343`*^9, 3.581669717815634*^9}}],

Cell[BoxData[
 RowBox[{"ClearSystemCache", "[", "]"}]], "Input",
 CellChangeTimes->{{3.581669726757145*^9, 3.5816697379287844`*^9}}],

Cell[BoxData[{
 RowBox[{"directory", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"\"\<mse.m\>\"", ",", 
   RowBox[{"Path", "\[Rule]", "directory"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6392064512024283`*^9, 3.6392064555015736`*^9}, {
  3.6392064862997465`*^9, 3.6392065233606443`*^9}, {3.6392250169707823`*^9, 
  3.6392250177207823`*^9}, {3.6535358489289207`*^9, 3.653535855296494*^9}, {
  3.709482620021003*^9, 3.70948262065952*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"0d323699-fbda-469a-b177-8c75bf156a77"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Echo", "[", "\"\<Loaded inequalities.m\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.711434116821677*^9, 3.711434132168717*^9}, {
  3.711434316073223*^9, 3.711434320192101*^9}, {3.711434722268729*^9, 
  3.711434728533441*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"616578b1-77c0-4f46-8c93-12683da7abda"],

Cell[BoxData["\<\"Loaded inequalities.m\"\>"], "Echo",
 CellChangeTimes->{
  3.711434739664863*^9},ExpressionUUID->"19425414-60a8-4d39-9313-\
019d65cb1c08"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global Variables", "Subsubsection",
 CellChangeTimes->{{3.657291540320045*^9, 3.657291544168*^9}}],

Cell["MSEresources, noD", "Text",
 CellChangeTimes->{{3.657291550272093*^9, 3.6572915617122097`*^9}},
 Background->RGBColor[1, 1, 0]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cineqmembers[mate]", "Subsection",
 CellChangeTimes->{{3.6119214276834106`*^9, 3.611921433805637*^9}, {
  3.611921486876209*^9, 3.611921507220935*^9}, {3.611921567047522*^9, 
  3.611921570873694*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Cineqmembers", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cineqmembers", "::", "usage"}], "=", 
   "\"\<Cineqmembers[mate] generates all the members required to form the \
inequalities for many to many relationships defined by the mate. The produced \
list of lists of triples defines also the way inequalities are formed. At \
this time, inequalities are created to follow the theoretical proofs done by \
J Fox. CAUTION: ineqmembers is the largest object so it consumes a lot of \
memory. This is why we use MSEresources=\\\"Memory\\\" when it is needed. Be \
careful because in the \[OpenCurlyDoubleQuote]Memory model\
\[CloseCurlyDoubleQuote], ineqmembers are erased after being used for the \
dataArray calculation, in order to speed up the calculations. \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cineqmembers", "[", "mate_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"marketineqs", ",", "head"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{
       "MSEresources", ",", "\[IndentingNewLine]", "\"\<Memory\>\"", ",", 
        RowBox[{"head", "=", "Compress"}], ",", "\[IndentingNewLine]", 
        "\"\<Speed\>\"", ",", 
        RowBox[{"head", "=", "Identity"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"marketineqs", "[", "marketid_", "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"mate", "[", 
             RowBox[{"[", 
              RowBox[{"marketid", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "Factual", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Join", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "i", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                   RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "i"}], "]"}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "j", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                   RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "j"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
              "1"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", "CounterFactual", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Join", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "i", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                   RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "j"}], "]"}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "j", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                   RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "i"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
              "1"}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ineqmembers", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"head", "/@", 
          RowBox[{"(", 
           RowBox[{"marketineqs", "[", "i", "]"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "mate"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Information", "[", 
  RowBox[{"Cineqmembers", ",", 
   RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6061899490806656`*^9, 3.606190030224307*^9}, {
   3.606190074583844*^9, 3.606190075719909*^9}, {3.606190132568161*^9, 
   3.6061903003667583`*^9}, {3.6061903872697287`*^9, 3.60619041159012*^9}, {
   3.6061904526544685`*^9, 3.606190598820829*^9}, {3.606190808281809*^9, 
   3.6061908474670506`*^9}, {3.6061908986739793`*^9, 3.606190934122007*^9}, {
   3.6061909680999503`*^9, 3.60619097089011*^9}, {3.6061910273083367`*^9, 
   3.606191037017892*^9}, {3.6061920266314945`*^9, 3.606192050039834*^9}, {
   3.606192134317654*^9, 3.6061922690143585`*^9}, {3.6061942332597065`*^9, 
   3.60619425778811*^9}, {3.60619488737712*^9, 3.6061949720709643`*^9}, {
   3.606195007641999*^9, 3.6061950398068385`*^9}, {3.6061962638878517`*^9, 
   3.6061962668880234`*^9}, {3.606205894570696*^9, 3.60620589954498*^9}, {
   3.606206277970625*^9, 3.606206319706012*^9}, {3.6062063661466684`*^9, 
   3.6062064312773933`*^9}, 3.606206538163507*^9, {3.6062067118024387`*^9, 
   3.6062067269613056`*^9}, {3.606207753559024*^9, 3.606207829447364*^9}, {
   3.6073098690312977`*^9, 3.6073098784308352`*^9}, {3.607309983856865*^9, 
   3.6073100026049376`*^9}, {3.6073102338291626`*^9, 
   3.6073102475139456`*^9}, {3.6073123654499207`*^9, 3.607312367606044*^9}, {
   3.6073125546177406`*^9, 3.607312586514565*^9}, {3.607312618194377*^9, 
   3.607312656098545*^9}, {3.6074340271569233`*^9, 3.607434050760273*^9}, 
   3.607435748424374*^9, {3.6119219449011216`*^9, 3.611921946896239*^9}, {
   3.6266885190199175`*^9, 3.6266885291292925`*^9}, {3.6266885860824175`*^9, 
   3.6266886473792925`*^9}, {3.6267077101514387`*^9, 3.626707723695911*^9}, {
   3.626707818002447*^9, 3.6267078306602197`*^9}, 3.626707881196027*^9, {
   3.626708157077135*^9, 3.6267081581025257`*^9}, {3.62670823188566*^9, 
   3.626708232989197*^9}, {3.626708458960743*^9, 3.626708463129713*^9}, {
   3.6267088787796817`*^9, 3.6267089193421817`*^9}, {3.6267099280970645`*^9, 
   3.6267099333939395`*^9}, {3.6267099746908145`*^9, 
   3.6267099791908145`*^9}, {3.630592805998639*^9, 3.630592809795514*^9}, {
   3.630593154076764*^9, 3.630593161076764*^9}, {3.630593221045514*^9, 
   3.630593225701764*^9}, {3.630593848061139*^9, 3.630593850576764*^9}, {
   3.630594613139264*^9, 3.630594629983014*^9}, {3.630594679561139*^9, 
   3.630594746358014*^9}, {3.630739352974348*^9, 3.630739513061531*^9}, {
   3.630747396329201*^9, 3.630747415733417*^9}, {3.6307487206799035`*^9, 
   3.6307487588508883`*^9}, {3.630749073625477*^9, 3.6307490941225414`*^9}, {
   3.6307491270235195`*^9, 3.630749215335967*^9}, {3.6307494372638316`*^9, 
   3.6307494446653357`*^9}, {3.630749741468005*^9, 3.630749777848136*^9}, {
   3.6307499443043914`*^9, 3.630749957990085*^9}, {3.630750089931745*^9, 
   3.6307501670932913`*^9}, 3.6307504611474895`*^9, {3.630751425622341*^9, 
   3.6307514917155604`*^9}, {3.6307515660295706`*^9, 
   3.6307516339551716`*^9}, {3.630751675878013*^9, 3.630751677126152*^9}, {
   3.6307517598668275`*^9, 3.630751763538354*^9}, {3.6307525566685643`*^9, 
   3.6307525682805395`*^9}, {3.630752708374181*^9, 3.6307527276346073`*^9}, {
   3.6307528023665795`*^9, 3.63075284653828*^9}, {3.630753192984475*^9, 
   3.6307532154495983`*^9}, {3.6307536300043087`*^9, 3.6307536462611856`*^9}, 
   3.630754331117269*^9, 3.6309396042670593`*^9, {3.630939656655115*^9, 
   3.6309396914161587`*^9}, {3.6309397555100775`*^9, 
   3.6309398220776405`*^9}, {3.630940025525439*^9, 3.630940045061107*^9}, {
   3.6311716214004416`*^9, 3.6311716526035666`*^9}, {3.6311717805723166`*^9, 
   3.6311718049004416`*^9}, {3.6311718353691916`*^9, 3.6311718356348166`*^9}, 
   3.6311722736660666`*^9, 3.6311724443848166`*^9, 3.6311725184004416`*^9, 
   3.6311731737910666`*^9, {3.6311732483848166`*^9, 3.6311732510723166`*^9}, {
   3.6311733146973166`*^9, 3.6311733320879416`*^9}, {3.632739993524544*^9, 
   3.63274000512647*^9}, {3.63274014692988*^9, 3.6327401931640863`*^9}, {
   3.632740239760373*^9, 3.632740414858444*^9}, {3.6327406522769895`*^9, 
   3.6327407342011414`*^9}, {3.632741345758588*^9, 3.632741391894642*^9}, 
   3.634195526774811*^9, {3.634195908307059*^9, 3.63419590995745*^9}, {
   3.634196072986123*^9, 3.634196116166732*^9}, 3.671431980277001*^9, {
   3.685457010173004*^9, 3.6854570126516933`*^9}, {3.6879641058434668`*^9, 
   3.687964134481648*^9}, 3.697050142823497*^9, {3.711434745167412*^9, 
   3.711434758679681*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"ff4a83ec-ebf7-4b4c-af2d-a1f718d9db6e"],

Cell[BoxData[
 StyleBox["\<\"Cineqmembers[mate] generates all the members required to form \
the inequalities for many to many relationships defined by the mate. The \
produced list of lists of triples defines also the way inequalities are \
formed. At this time, inequalities are created to follow the theoretical \
proofs done by J Fox. CAUTION: ineqmembers is the largest object so it \
consumes a lot of memory. This is why we use MSEresources=\\\"Memory\\\" when \
it is needed. Be careful because in the \[OpenCurlyDoubleQuote]Memory model\
\[CloseCurlyDoubleQuote], ineqmembers are erased after being used for the \
dataArray calculation, in order to speed up the calculations. \"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.711434760153302*^9},
 CellTags->
  "Info53711445560-4465173",ExpressionUUID->"bdf76057-d060-4a8f-bc67-\
5a187cc45420"]
}, Open  ]],

Cell[CellGroupData[{

Cell["examples", "Subsubsection",
 CellChangeTimes->{{3.71143487333278*^9, 
  3.711434875042542*^9}},ExpressionUUID->"bae3ae8a-1a78-4b56-9c50-\
33c311593670"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MSEresources", "=", "\"\<Speed\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.671432968836465*^9, 3.671432971363761*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cineqmembers", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", "2", "}"}], ",", 
        RowBox[{"{", "3", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "3", "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", "2", "}"}], ",", 
        RowBox[{"{", "3", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.67143295230982*^9, 3.67143296153185*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "3"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.671432973535729*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cineqmembers", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", "2", "}"}], ",", 
        RowBox[{"{", "3", "}"}], ",", 
        RowBox[{"{", "4", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "3", "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", "2", "}"}], ",", 
        RowBox[{"{", "3", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.67143327015108*^9, 3.671433283879622*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "3"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "4"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6714332850116587`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cineqmembers[mate,\[CloseCurlyDoubleQuote]pairwise\
\[CloseCurlyDoubleQuote]]", "Subsection",
 CellChangeTimes->{{3.6119214276834106`*^9, 3.611921433805637*^9}, {
  3.611921486876209*^9, 3.611921507220935*^9}, {3.611921567047522*^9, 
  3.611921570873694*^9}, {3.634194217462187*^9, 3.6341942187776165`*^9}, {
  3.642501800210512*^9, 3.6425018028977213`*^9}, {3.6425018430105*^9, 
  3.642501844954063*^9}}],

Cell["\<\
We are at market m where noU[[m]] upstreams exist and noD[[m]] downstream \
exist.
Let the matching {{5}, {3, 7, 9}} that is upstream no 5 is matched with \
downstreams no 3, 7 and 9
{{5,3},..,{5,3}} noD[[m]]-3 times   and  \
{{5,1},{5,2},{5,4},{5,5},{5,6},{5,8},{5,10},...}
{{5,7},..,{5,7}} noD[[m]]-3 times   and  \
{{5,1},{5,2},{5,4},{5,5},{5,6},{5,8},{5,10},...}
{{5,9},..,{5,9}} noD[[m]]-3 times   and  \
{{5,1},{5,2},{5,4},{5,5},{5,6},{5,8},{5,10},...}\
\>", "Text",
 CellChangeTimes->{{3.634187047196102*^9, 3.6341871156026287`*^9}, {
  3.6341873608197765`*^9, 3.634187406724476*^9}, {3.6341883403367596`*^9, 
  3.634188442007663*^9}, {3.6341885165110073`*^9, 3.634188521754172*^9}, {
  3.634188619513177*^9, 3.6341886745557127`*^9}, {3.6341887077953973`*^9, 
  3.6341887261136107`*^9}, {3.6341887653338985`*^9, 3.63418878339249*^9}, {
  3.6341889109527855`*^9, 3.6341889730858564`*^9}, {3.6341890350651503`*^9, 
  3.6341891742485743`*^9}, {3.634192266636553*^9, 3.6341922676258907`*^9}, {
  3.6341927888605456`*^9, 3.6341927934485826`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "1"}], ";", 
  RowBox[{"u", "=", "5"}], ";", 
  RowBox[{"d", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "9"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{
     RowBox[{"Range", "[", "12", "]"}], ",", 
     RowBox[{"List", "/@", "d"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"m", ",", "u", ",", "i"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Length", "[", "list", "]"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"m", ",", "u", ",", "#"}], "}"}], "}"}], "&"}], "/@", 
        "list"}], ",", 
       RowBox[{"{", 
        RowBox[{"Length", "@", "d"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]", "}"}]}], "Input",
 CellChangeTimes->{{3.6341892115162725`*^9, 3.6341892303231525`*^9}, {
  3.6341893147538323`*^9, 3.6341894307257977`*^9}, {3.6341894843661222`*^9, 
  3.6341894962877383`*^9}, {3.634189532512677*^9, 3.634189533101544*^9}, {
  3.63418958520506*^9, 3.6341896956931305`*^9}, {3.6341897817763424`*^9, 
  3.634189800652415*^9}, {3.6341901015185685`*^9, 3.6341901754005775`*^9}, {
  3.634190218841607*^9, 3.634190250325951*^9}, {3.634190548933544*^9, 
  3.6341905627597437`*^9}, {3.6341907009658527`*^9, 3.634190711016756*^9}, {
  3.634190815949853*^9, 3.6341908203297358`*^9}, {3.634191770608081*^9, 
  3.6341917918776703`*^9}, {3.634192084171069*^9, 3.634192173680977*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "7"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "9"}], "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "4"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "5"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "6"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "8"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "10"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "11"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "12"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "4"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "5"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "6"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "8"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "10"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "11"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "12"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "4"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "5"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "6"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "8"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "10"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "11"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "12"}], "}"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6341892313367214`*^9, 3.634189322374926*^9, 3.634189357318945*^9, 
   3.6341893890765133`*^9, 3.634189428491926*^9, 3.6341894970615177`*^9, 
   3.6341895340146303`*^9, {3.63418960174942*^9, 3.634189638689243*^9}, 
   3.6341896963002806`*^9, 3.6341898028727703`*^9, {3.6341901076195445`*^9, 
   3.6341901381937313`*^9}, {3.634190220223443*^9, 3.63419024796537*^9}, 
   3.6341905528007317`*^9, 3.634190711444845*^9, 3.634190830147414*^9, {
   3.6341917821833344`*^9, 3.634191792677475*^9}, 3.6341921756823497`*^9, 
   3.634192256220112*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cineqmembers", "[", 
    RowBox[{"mate_", ",", "\"\<pairwise\>\"", ",", 
     RowBox[{"nd_:", 
      StyleBox["noD",
       Background->RGBColor[1, 1, 0]]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ineqsleft", ",", "ineqsright", ",", "head"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{
       "MSEresources", ",", "\[IndentingNewLine]", "\"\<Memory\>\"", ",", 
        RowBox[{"head", "=", "Compress"}], ",", "\[IndentingNewLine]", 
        "\"\<Speed\>\"", ",", 
        RowBox[{"head", "=", "Identity"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ineqsleft", "[", 
        RowBox[{"m_", ",", "u_", ",", "d_"}], "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"list", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"nd", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
             RowBox[{"List", "/@", "d"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"m", ",", "u", ",", "i"}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "d"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", "list", "]"}], "}"}]}], "]"}], ",", 
            "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ineqsright", "[", 
        RowBox[{"m_", ",", "u_", ",", "d_"}], "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"list", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"nd", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
             RowBox[{"List", "/@", "d"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "u", ",", "#"}], "}"}], "}"}], "&"}], "/@",
                "list"}], ",", 
              RowBox[{"{", 
               RowBox[{"Length", "@", "d"}], "}"}]}], "]"}], ",", "1"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ineqmembers", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"head", "/@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "Factual", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ineqsleft", "[", 
                 RowBox[{"m", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Transpose", "@", 
                 RowBox[{"mate", "[", 
                  RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}], ",", "1"}], 
             "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", "CounterFactual", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ineqsright", "[", 
                 RowBox[{"m", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"Transpose", "@", 
                 RowBox[{"mate", "[", 
                  RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}], ",", "1"}], 
             "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"Length", "@", "mate"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.634193192793244*^9, 3.6341931937473454`*^9}, {
   3.6341934656387815`*^9, 3.6341935357278967`*^9}, {3.6341936709764104`*^9, 
   3.6341936893927245`*^9}, 3.6341937291575747`*^9, {3.634193872754001*^9, 
   3.63419392742924*^9}, {3.634195515736721*^9, 3.6341955417501497`*^9}, {
   3.6341958993773713`*^9, 3.634195985026701*^9}, {3.634234567429679*^9, 
   3.6342345870664253`*^9}, {3.634298246224962*^9, 3.634298256521837*^9}, {
   3.6425018517987223`*^9, 3.642501853493165*^9}, {3.642570192829912*^9, 
   3.6425702160274973`*^9}, {3.642570275505772*^9, 3.642570286717412*^9}, {
   3.688007902578045*^9, 3.6880079078307877`*^9}, {3.7114347678964243`*^9, 
   3.711434813821782*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"d3d971e4-445d-4e92-a31e-1b3b59638a29"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Cineqmembers[mate,\[CloseCurlyDoubleQuote]triples\[CloseCurlyDoubleQuote]] \
(*NEW maybe will use it in the future*)\
\>", "Subsection",
 CellChangeTimes->{{3.642651004854389*^9, 3.6426510154213963`*^9}, {
  3.6535377128626738`*^9, 3.653537732394827*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"See", " ", "screenshot", " ", "under", " ", "material"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Cineqmembers", "[", 
    RowBox[{"mate_", ",", "\"\<triples\>\""}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"marketineqs", ",", "head"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{
       "MSEresources", ",", "\[IndentingNewLine]", "\"\<Memory\>\"", ",", 
        RowBox[{"head", "=", "Compress"}], ",", "\[IndentingNewLine]", 
        "\"\<Speed\>\"", ",", 
        RowBox[{"head", "=", "Identity"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"marketineqs", "[", "marketid_", "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"mate", "[", 
             RowBox[{"[", 
              RowBox[{"marketid", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "Factual", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "i", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "i"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "j", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "j"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "k", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "k"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"i", "+", "1"}], ",", "n"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"j", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
                "2"}], "]"}], "\[IndentingNewLine]", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "i", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "i"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "j", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "j"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "k", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "k"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"i", "+", "1"}], ",", "n"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"j", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
                "2"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", "CounterFactual", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "i", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "j"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "j", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "k"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "k", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "i"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"i", "+", "1"}], ",", "n"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"j", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
                "2"}], "]"}], "\[IndentingNewLine]", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "i", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "k"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "j", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "i"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"marketid", ",", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "1", ",", "k", ",", "1"}], "]"}],
                     "]"}], ",", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"mate", "[", 
                    RowBox[{"[", 
                    RowBox[{"marketid", ",", "2", ",", "j"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"i", "+", "1"}], ",", "n"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"j", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
                "2"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ineqmembers", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"head", "/@", 
          RowBox[{"(", 
           RowBox[{"marketineqs", "[", "i", "]"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "mate"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6061899490806656`*^9, 3.606190030224307*^9}, {
   3.606190074583844*^9, 3.606190075719909*^9}, {3.606190132568161*^9, 
   3.6061903003667583`*^9}, {3.6061903872697287`*^9, 3.60619041159012*^9}, {
   3.6061904526544685`*^9, 3.606190598820829*^9}, {3.606190808281809*^9, 
   3.6061908474670506`*^9}, {3.6061908986739793`*^9, 3.606190934122007*^9}, {
   3.6061909680999503`*^9, 3.60619097089011*^9}, {3.6061910273083367`*^9, 
   3.606191037017892*^9}, {3.6061920266314945`*^9, 3.606192050039834*^9}, {
   3.606192134317654*^9, 3.6061922690143585`*^9}, {3.6061942332597065`*^9, 
   3.60619425778811*^9}, {3.60619488737712*^9, 3.6061949720709643`*^9}, {
   3.606195007641999*^9, 3.6061950398068385`*^9}, {3.6061962638878517`*^9, 
   3.6061962668880234`*^9}, {3.606205894570696*^9, 3.60620589954498*^9}, {
   3.606206277970625*^9, 3.606206319706012*^9}, {3.6062063661466684`*^9, 
   3.6062064312773933`*^9}, 3.606206538163507*^9, {3.6062067118024387`*^9, 
   3.6062067269613056`*^9}, {3.606207753559024*^9, 3.606207829447364*^9}, {
   3.6073098690312977`*^9, 3.6073098784308352`*^9}, {3.607309983856865*^9, 
   3.6073100026049376`*^9}, {3.6073102338291626`*^9, 
   3.6073102475139456`*^9}, {3.6073123654499207`*^9, 3.607312367606044*^9}, {
   3.6073125546177406`*^9, 3.607312586514565*^9}, {3.607312618194377*^9, 
   3.607312656098545*^9}, {3.6074340271569233`*^9, 3.607434050760273*^9}, 
   3.607435748424374*^9, {3.6119219449011216`*^9, 3.611921946896239*^9}, {
   3.6266885190199175`*^9, 3.6266885291292925`*^9}, {3.6266885860824175`*^9, 
   3.6266886473792925`*^9}, {3.6267077101514387`*^9, 3.626707723695911*^9}, {
   3.626707818002447*^9, 3.6267078306602197`*^9}, 3.626707881196027*^9, {
   3.626708157077135*^9, 3.6267081581025257`*^9}, {3.62670823188566*^9, 
   3.626708232989197*^9}, {3.626708458960743*^9, 3.626708463129713*^9}, {
   3.6267088787796817`*^9, 3.6267089193421817`*^9}, {3.6267099280970645`*^9, 
   3.6267099333939395`*^9}, {3.6267099746908145`*^9, 
   3.6267099791908145`*^9}, {3.630592805998639*^9, 3.630592809795514*^9}, {
   3.630593154076764*^9, 3.630593161076764*^9}, {3.630593221045514*^9, 
   3.630593225701764*^9}, {3.630593848061139*^9, 3.630593850576764*^9}, {
   3.630594613139264*^9, 3.630594629983014*^9}, {3.630594679561139*^9, 
   3.630594746358014*^9}, {3.630739352974348*^9, 3.630739513061531*^9}, {
   3.630747396329201*^9, 3.630747415733417*^9}, {3.6307487206799035`*^9, 
   3.6307487588508883`*^9}, {3.630749073625477*^9, 3.6307490941225414`*^9}, {
   3.6307491270235195`*^9, 3.630749215335967*^9}, {3.6307494372638316`*^9, 
   3.6307494446653357`*^9}, {3.630749741468005*^9, 3.630749777848136*^9}, {
   3.6307499443043914`*^9, 3.630749957990085*^9}, {3.630750089931745*^9, 
   3.6307501670932913`*^9}, 3.6307504611474895`*^9, {3.630751425622341*^9, 
   3.6307514917155604`*^9}, {3.6307515660295706`*^9, 
   3.6307516339551716`*^9}, {3.630751675878013*^9, 3.630751677126152*^9}, {
   3.6307517598668275`*^9, 3.630751763538354*^9}, {3.6307525566685643`*^9, 
   3.6307525682805395`*^9}, {3.630752708374181*^9, 3.6307527276346073`*^9}, {
   3.6307528023665795`*^9, 3.63075284653828*^9}, {3.630753192984475*^9, 
   3.6307532154495983`*^9}, {3.6307536300043087`*^9, 3.6307536462611856`*^9}, 
   3.630754331117269*^9, 3.6309396042670593`*^9, {3.630939656655115*^9, 
   3.6309396914161587`*^9}, {3.6309397555100775`*^9, 
   3.6309398220776405`*^9}, {3.630940025525439*^9, 3.630940045061107*^9}, {
   3.6311716214004416`*^9, 3.6311716526035666`*^9}, {3.6311717805723166`*^9, 
   3.6311718049004416`*^9}, {3.6311718353691916`*^9, 3.6311718356348166`*^9}, 
   3.6311722736660666`*^9, 3.6311724443848166`*^9, 3.6311725184004416`*^9, 
   3.6311731737910666`*^9, {3.6311732483848166`*^9, 3.6311732510723166`*^9}, {
   3.6311733146973166`*^9, 3.6311733320879416`*^9}, {3.632739993524544*^9, 
   3.63274000512647*^9}, {3.63274014692988*^9, 3.6327401931640863`*^9}, {
   3.632740239760373*^9, 3.632740414858444*^9}, {3.6327406522769895`*^9, 
   3.6327407342011414`*^9}, {3.632741345758588*^9, 3.632741391894642*^9}, 
   3.634195526774811*^9, {3.634195908307059*^9, 3.63419590995745*^9}, {
   3.634196072986123*^9, 3.634196116166732*^9}, {3.642651032760516*^9, 
   3.6426510413704033`*^9}, {3.642651219636096*^9, 3.642651298605483*^9}, {
   3.642651487210396*^9, 3.642651489948955*^9}, {3.6426521850551357`*^9, 
   3.642652189685508*^9}, {3.642652232286777*^9, 3.642652286499699*^9}, {
   3.6426523345306187`*^9, 3.6426523477113028`*^9}, {3.6426524152661867`*^9, 
   3.642652424194097*^9}, {3.642654697365321*^9, 3.642654708455822*^9}, {
   3.688007937756078*^9, 3.688007941216778*^9}},
 Background->RGBColor[0.88, 1, 0.88]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cinequalities[f,ineqmembers]", "Subsection",
 CellChangeTimes->{{3.6119214276834106`*^9, 3.611921433805637*^9}, {
   3.611921486876209*^9, 3.611921507220935*^9}, {3.611921567047522*^9, 
   3.611921570873694*^9}, {3.611921819881147*^9, 3.6119218714719954`*^9}, 
   3.611922316492015*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Cinequalities", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cinequalities", "::", "usage"}], "=", 
   "\"\<Cinequalities[f,ineqmembers] apply properly the f function to \
ineqmembers to create inequalities. This routine is called by CdataArray \
internally where as a function it uses payoffMatrix[[##]]&.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cinequalities", "[", 
    RowBox[{"f_", ",", "ineqmembers_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"headin", ",", "headout"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{
       "MSEresources", ",", "\[IndentingNewLine]", "\"\<Memory\>\"", ",", 
        RowBox[{
         RowBox[{"headout", "=", "Compress"}], ";", 
         RowBox[{"headin", "=", "Uncompress"}]}], ",", "\[IndentingNewLine]", 
        "\"\<Speed\>\"", ",", 
        RowBox[{
         RowBox[{"headout", "=", "Identity"}], ";", 
         RowBox[{"headin", "=", "Identity"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"inequalities", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"headout", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Differences", "@", 
               RowBox[{"Map", "[", 
                RowBox[{"Total", ",", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"f", ",", 
                   RowBox[{"headin", "/@", "#"}], ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}]}], ",", "1"}], "]"}]}], 
          "&"}], "\[IndentingNewLine]", ",", "ineqmembers"}], "]"}]}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Information", "[", 
  RowBox[{"Cinequalities", ",", 
   RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6080216407321196`*^9, 3.6080216474035015`*^9}, {
   3.6119219073221045`*^9, 3.611921920687592*^9}, {3.6119219840108795`*^9, 
   3.6119219865071263`*^9}, {3.630594973654889*^9, 3.630595019779889*^9}, {
   3.6307352839727345`*^9, 3.6307353870243444`*^9}, {3.630735424700785*^9, 
   3.630735429276957*^9}, {3.630737047133664*^9, 3.6307370558380156`*^9}, {
   3.630737228701536*^9, 3.630737364706221*^9}, 3.6307396201967306`*^9, 
   3.6311740911055193`*^9, {3.6327400079949656`*^9, 3.6327400153964553`*^9}, {
   3.632740426219055*^9, 3.6327405006947966`*^9}, {3.6327405644642563`*^9, 
   3.6327405677518525`*^9}, {3.632740629132227*^9, 3.6327406442784815`*^9}, {
   3.632740936201028*^9, 3.6327409691301575`*^9}, {3.6327410238049583`*^9, 
   3.6327410911319084`*^9}, {3.688007959412815*^9, 3.688007962621977*^9}, {
   3.697050310801469*^9, 3.697050327749548*^9}, {3.711434821673559*^9, 
   3.711434831824287*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"2745cfbc-8a5c-4b73-b216-930f5cbf23ae"],

Cell[BoxData[
 StyleBox["\<\"Cinequalities[f,ineqmembers] apply properly the f function to \
ineqmembers to create inequalities. This routine is called by CdataArray \
internally where as a function it uses payoffMatrix[[##]]&.\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.711434832890073*^9},
 CellTags->
  "Info143711445632-4465173",ExpressionUUID->"ccfbbc13-54f2-4270-be3e-\
5b32778cc0cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["examples", "Subsubsection",
 CellChangeTimes->{{3.711434839898058*^9, 
  3.711434849168866*^9}},ExpressionUUID->"d98fb0c8-bd74-4ca6-9501-\
44409eeb2dee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MSEresources", "=", "\"\<Speed\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.685459543240674*^9, 3.685459550126317*^9}, 
   3.685459835726068*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cinequalities", "[", 
  RowBox[{"f", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "3"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}]}], "\n", "]"}]], "Input",
 CellChangeTimes->{{3.685459513897789*^9, 3.685459537621779*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "1", ",", "3"}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "1", ",", "3"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "3", ",", "1"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "3", ",", "2"}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "3", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}]}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "2", ",", "2"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "3", ",", "1"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "3", ",", "2"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "1", ",", "3"}], "]"}]}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "2", ",", "3"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "1", ",", "1"}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "1", ",", "2"}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "3", ",", "1"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "3", ",", "2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "2", ",", "1"}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "2", ",", "2"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "2", ",", "3"}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "3", ",", "1"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "3", ",", "2"}], "]"}], "-", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "3", ",", "3"}], "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6854595386228933`*^9, 3.68545955500655*^9}, 
   3.685459839013728*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1190, 1043},
WindowMargins->{{275, Automatic}, {Automatic, 286}},
ShowSelection->True,
Magnification->1.5,
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info53711445560-4465173"->{
  Cell[14058, 307, 866, 14, 
  198, "Print", "ExpressionUUID" -> "bdf76057-d060-4a8f-bc67-5a187cc45420",
   CellTags->"Info53711445560-4465173"]},
 "Info143711445632-4465173"->{
  Cell[61261, 1481, 409, 8, 
  90, "Print", "ExpressionUUID" -> "ccfbbc13-54f2-4270-be3e-5b32778cc0cf",
   CellTags->"Info143711445632-4465173"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info53711445560-4465173", 68245, 1690},
 {"Info143711445632-4465173", 68423, 1694}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 359, 5, 97, "Section", "ExpressionUUID" -> \
"cea406a0-718f-4f97-8ebe-cd983e16ffda"],
Cell[CellGroupData[{
Cell[963, 31, 110, 1, 53, "Subsubsection", "ExpressionUUID" -> \
"ed20536b-52c6-4743-887f-aa7b9d2090c6"],
Cell[1076, 34, 272, 5, 77, "Text", "ExpressionUUID" -> \
"46c6aec6-f0b2-4c8d-b010-1ba749f394af"],
Cell[1351, 41, 179, 4, 49, "Input", "ExpressionUUID" -> \
"c3dfc503-420a-4189-be70-4123c2769ce4"],
Cell[1533, 47, 148, 3, 49, "Input", "ExpressionUUID" -> \
"31fc940a-bf34-4e7c-be9c-c2b8f78f4756"],
Cell[1684, 52, 132, 2, 49, "Input", "ExpressionUUID" -> \
"de1a7c3b-f092-40b8-af15-5c4958a85a6d"],
Cell[1819, 56, 591, 11, 107, "Input", "ExpressionUUID" -> \
"0d323699-fbda-469a-b177-8c75bf156a77"],
Cell[CellGroupData[{
Cell[2435, 71, 390, 8, 73, "Input", "ExpressionUUID" -> \
"616578b1-77c0-4f46-8c93-12683da7abda",
 InitializationCell->True],
Cell[2828, 81, 156, 3, 38, "Echo", "ExpressionUUID" -> \
"19425414-60a8-4d39-9313-019d65cb1c08"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3033, 90, 104, 1, 53, "Subsubsection", "ExpressionUUID" -> \
"86bdfb40-f1f1-4702-97eb-171d7d6d6140"],
Cell[3140, 93, 133, 2, 70, "Text", "ExpressionUUID" -> \
"fee81ceb-0811-4eeb-8b3c-0000bcf35319"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3310, 100, 206, 3, 67, "Subsection", "ExpressionUUID" -> \
"b414775d-2bff-4b9e-860f-cb66f8cc27d1"],
Cell[CellGroupData[{
Cell[3541, 107, 10514, 198, 1330, "Input", "ExpressionUUID" -> \
"ff4a83ec-ebf7-4b4c-af2d-a1f718d9db6e",
 InitializationCell->True],
Cell[14058, 307, 866, 14, 198, "Print", "ExpressionUUID" -> \
"bdf76057-d060-4a8f-bc67-5a187cc45420",
 CellTags->"Info53711445560-4465173"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14961, 326, 158, 3, 53, "Subsubsection", "ExpressionUUID" -> \
"bae3ae8a-1a78-4b56-9c50-33c311593670"],
Cell[15122, 331, 156, 3, 49, "Input", "ExpressionUUID" -> \
"991acbba-5feb-4055-93e3-54de904e1281"],
Cell[CellGroupData[{
Cell[15303, 338, 936, 30, 83, "Input", "ExpressionUUID" -> \
"4b1f1868-c43b-464f-bed5-1cf6a9c7e6bd"],
Cell[16242, 370, 3144, 95, 182, "Output", "ExpressionUUID" -> \
"05e6210a-7ba7-4e80-b3bc-ed7e403447b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19423, 470, 1055, 33, 83, "Input", "ExpressionUUID" -> \
"bacc0c1b-921f-4b69-89a9-5e79bbe94e70"],
Cell[20481, 505, 5372, 155, 347, "Output", "ExpressionUUID" -> \
"057e9107-c202-41d5-b0ff-1adf90a54a6b"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25914, 667, 411, 6, 67, "Subsection", "ExpressionUUID" -> \
"4dafed33-fbf8-4040-806f-340ccaad9d56"],
Cell[26328, 675, 1058, 19, 191, "Text", "ExpressionUUID" -> \
"2901dba7-439b-4869-96c9-bb925684419f"],
Cell[CellGroupData[{
Cell[27411, 698, 1940, 48, 248, "Input", "ExpressionUUID" -> \
"0a5e5402-a5eb-4668-abfa-86d577a63c24"],
Cell[29354, 748, 6160, 178, 347, "Output", "ExpressionUUID" -> \
"0e6e2d62-b948-4150-9aa6-1e6339056aed"]
}, Open  ]],
Cell[35529, 929, 5636, 134, 902, "Input", "ExpressionUUID" -> \
"d3d971e4-445d-4e92-a31e-1b3b59638a29",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[41202, 1068, 265, 5, 53, "Subsection", "ExpressionUUID" -> \
"e2a50972-6552-46fc-922c-bf8d7c682822"],
Cell[41470, 1075, 16324, 324, 1627, "Input", "ExpressionUUID" -> \
"460b5b3f-775a-44f0-a73e-2aa13cdf0575",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[57831, 1404, 292, 4, 53, "Subsection", "ExpressionUUID" -> \
"d3c4ad96-a84f-4c35-8722-ea444c59cd5b"],
Cell[CellGroupData[{
Cell[58148, 1412, 3110, 67, 570, "Input", "ExpressionUUID" -> \
"2745cfbc-8a5c-4b73-b216-930f5cbf23ae",
 InitializationCell->True],
Cell[61261, 1481, 409, 8, 90, "Print", "ExpressionUUID" -> \
"ccfbbc13-54f2-4270-be3e-5b32778cc0cf",
 CellTags->"Info143711445632-4465173"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61707, 1494, 159, 3, 53, "Subsubsection", "ExpressionUUID" -> \
"d98fb0c8-bd74-4ca6-9501-44409eeb2dee"],
Cell[61869, 1499, 182, 4, 49, "Input", "ExpressionUUID" -> \
"2ff02ed7-ca48-492a-a098-718d0b94e117"],
Cell[CellGroupData[{
Cell[62076, 1507, 3424, 97, 281, "Input", "ExpressionUUID" -> \
"4742bbd2-8b36-416a-af4f-c460827b2b5a"],
Cell[65503, 1606, 2312, 65, 182, "Output", "ExpressionUUID" -> \
"19fb1bea-3c4b-40ed-ba71-f6a9f1cf8106"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

